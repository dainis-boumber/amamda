Abstract. Model selection is an important ingredient of many machine learning algorithms, in particular when
the sample size in small, in order to strike the right trade-off between overtting and undertting. Previous
classical results for linear regression are based on an asymptotic analysis. We present a new penalization method
for performing model selection for regression that is appropriate even for small samples. Our penalization is based
on an accurate estimator of the ratio of the expected training error and the expected generalization error, in terms
of the expected eigenvalues of the input covariance matrix.

Keywords: model selection, parametric regression, uniform convergence bounds

1.

Introduction

Consider the problem of estimating a regression function in the set of functions

(cid:2)

f (x, ) =

(cid:3)

R() =

k k (x)

k=1

(1)

where {k} form a basis of L2(R p), e.g. a Fourier or wavelet basis.
Given a collection of data (x1, y1), . . . , (xn, yn), where yi = f (xi , 0)+ i and xi , i are
independently generated by unknown distributions P(x) and P( ), one wants to nd the
function f (x, ) that provides the smallest value of the expected loss

L(y, f (x, )) dP(x) dP( )

(2)

where L(y, f (x, )) is a given loss function, usually the quadratic loss L(y, f (x, )) =
(y f (x, ))2. To minimize the expected risk (2), one minimizes the empirical risk

O. CHAPELLE, V. VAPNIK, AND Y. BENGIO

10

functional

Remp() = 1
n

n(cid:2)

i=1

L(yi , f (xi , ))

However since the set (1) has an innite expansion, this idea does not work: for any nite
number of (different) examples there are functions which have zero empirical risk and a
large value of the expected loss.
To guarantee a small expected risk, one can minimize the empirical functional over only
the rst d = d(n) functions k (x). This is reasonable if the k are ordered in such way that
puts the smoother components rst, introducing a preference for smooth functions. The
problem of choosing an appropriate value d = d(n) is called model selection.

For the case of quadratic loss and a large number of observations, several penalty-based
methods were proposed in the mid-70s, and these are asymptotically optimal. All of these
solutions, described in more detail below, minimize functionals of the form


emp

R

( fd ) = Remp( fd )T (d, n)

(3)

where n is the sample size, Remp( fd ) is the minimum of the empirical risk when training
with a model of size d (achieved by the function fd), and T (d, n) is a correction factor for

performing model selection.

In particular Akaike (Akaike, 1970) dened in the context of autoregressive models the

Future Prediction Error (FPE) correction factor

T (d, n) = (1 + d/n)(1  d/n)1,

(4)
For small ratios d/n this multiplicative factor has a linear approximation (1 + 2 d
).
Generalized Cross-Validation (Wahba, Golub, & Heath, 1979) and Shibatas model selector
(Shibata, 1981) have the same linear approximation. Some other criteria which provide a
different asymptotic behavior have been proposed including RIC (Foster & George, 1994)
BIC (Schwartz, 1978) as well as criteria derived from the Minimum Description Length
(MDL) principle (Rissanen, 1986; Barron, Rissanen, & Yu, 1998).

n

During the same years, a general theory of minimizing the empirical risk (for any set of
functions, any loss functions, and any number of samples) has been constructed (Vapnik,
1982). In the framework of this theory, the method of Structural Risk Minimization for model
selection was proposed. In the case studied here, this yields the following multiplicative
factor (Cherkassky, Mulier, & Vapnik, 1997), derived from Uniform Convergence Bounds
(UCB):

(cid:4)

(cid:5)

T (d, n) =

1  c

(cid:6)1

d(ln n/d + 1)  ln 

n

+

where u+ = max(0, u) and c,  are some constants. In spite of the fact that in the asymptotic
case, this factor is less accurate than classical ones, simulation experiments showed that this
correction factor outperforms other classical ones (Cherkassky, Mulier, & Vapnik, 1997).

(5)

MODEL SELECTION FOR SMALL SAMPLE REGRESSION

11

This article is the development of an idea described in Vapnik (1998). We rst show that
the expectation of the loss of the function minimizing the empirical risk depends both on the
ratio d/n and the eigenvalues of a covariance matrix. It appears that by taking into account
those eigenvalues we obtain a correction factor T (d, n) which for small d/n coincides with
Akaikes factor, but which is signicantly different for larger d/n.

This analysis aims at characterizing the relation between empirical risk and bias (residual
of the approximation and noise) on one hand, and between bias and generalization error on
the other hand. For this purpose we made an independence assumption which might not be
satised in practice. However, in our experiments the obtained estimator has a very good
accuracy which suggests that this assumption is reasonable.

In the last section of the article, we compare the estimation accuracy of our method with

classical ones and show that one can use it to perform state-of-the-art model selection.

2. Risk of the mean square error estimator

We consider a linear model of dimension d,

(cid:8)

(cid:7)

x  d(cid:2)

i=1

Fd =

i i (x)

(6)

with i  R and the family{i (x)}iN is orthonormal with respect to the probability measure
(x), which means E  p(x)q (x) =  pq.1 We assume without any loss of generality that
this family is also a basis of L2(R p) (if it is not, it is always possible to extend it). Let fd be
the function minimizing the empirical mean square error over the set of functions Fd, i.e.

fd = arg min
f Fd

Remp( f ),

The following section gives an estimator of the risk of fd. This risk estimator will lead

directly to the choice of the correcting term in the model selection problem.

We suppose without loss of generality that the rst function 1 is the constant function

1 and then by orthonormality we have for all p > 1,

E  p(x) = 0

(7)

2.1. Derivation of the risk estimator
In the orthonormal basis {i (x)}iN, the desired regression function can be written as

(cid:2)

f (x) =

i i (x)

i=1

12

O. CHAPELLE, V. VAPNIK, AND Y. BENGIO

and the regression function minimizing the empirical risk is

Let the i.i.d. noise  have variance  2 and mean zero, then the risk of this function is

i i (x)

fd (x) = d(cid:2)
(cid:3)

i=1

R( fd ) =

=  2 +

( f (x) +   fd (x))2 d(x) dP( )
(cid:3)
=  2 + d(cid:2)

( f (x)  fd (x))2 d(x)
(i  i )2 +

(cid:2)

2
i

i=1

i=d+1

(8)

The last equality comes from the orthonormality of the family {i}iN.
The rst term  2 corresponds to the risk of the true regression function, R( f ). The second

term is the estimation error and the third term is the approximation error that we call rd,

2
i

(9)

To analyze Eq. (8), let us introduce the vector i = i  i of estimation errors and
express the empirical risk in function of ,

(cid:2)

i=d+1

rd =

(cid:6)2

(cid:4)

n(cid:2)
n(cid:2)

i=1

i=1

yi  d(cid:2)
( p +  p) p(xi )
d(cid:2)

n(cid:2)

p=1
2  2
n

yi

 p

i=1

p=1

yi  p(xi ) + d(cid:2)

p,q=1

Remp() = 1
n
= 1
n

n(cid:2)

i=1

1
n

 pq

 p(xi )q (xi ),

(10)

where

yi = i +

(cid:2)

p=d+1

 p p(xi ).

If we introduce the n  d matrix , with i, p =  p(xi ), then the empirical risk is
minimized for

 = (T )1T Y ,

(11)

MODEL SELECTION FOR SMALL SAMPLE REGRESSION

where Y = ( y1, . . . , yn)T and the minimum value of the empirical risk is

Remp( fd ) = 1

n

Y T (I  (T )1T ) Y .

13

(12)

The SVD decomposition of the matrix  writes  = USV T , where U and V are or-
thogonal matrices of size n  n and d  d respectively. S is a n  d diagonal matrix.
Then

(T )1T = UIdU T ,

with S(ST S)1ST = Id being a diagonal n  n matrix with its rst d diagonal elements
equal to 1 and the others zero. Thus Eq. (12) writes

Remp( fd ) = 1
n
= 1
n

(cid:4)

Y T U (In  Id )U T Y
(cid:6)2
n(cid:2)
yiUi p

n(cid:2)

p=d+1

i=1

(13)

Let us now make the assumption that Y and  are statistically independent. This as-
sumption will be discussed at the end of the section. Then Y and U are independent and
E yiUi p = E yi EUi p = 0 from (7). From Eq. (13), we conclude

ERemp( fd ) = 1
(cid:9)

n

=

E yi

2EU2
i p

n(cid:2)

n(cid:2)
(cid:10)

p=d+1
1  d
n

i=1
(rd +  2)

(14)

n

T ,

(15)

(cid:11)
The second equality is derived using the independence of i and xi , the orthonormality
of the bases (yielding E yi
2 = (rd +  2)), and orthogonality of the matrix U (yielding

(cid:11)

= 1).

n
i=1 EU 2
i p
In Eq. (8) we have to estimate
(cid:15)(cid:15)2 = Y T (T )2T Y .

( p   p)2 =(cid:11)

d
p=1

d
p=1

( p)2. To do this, let us write

and denote by (1, . . . , d ) the eigenvalues of the covariance matrix C = 1

n(cid:2)

C pq = 1
n

 p(xi )q (xi ).

i=1

14

O. CHAPELLE, V. VAPNIK, AND Y. BENGIO

Then one can show using the same technique as above that

(cid:11)

d(cid:2)

E

p=1

=

2
p

d
i=1 E (1/i )

(rd +  2)

n

Finally combining this last equality with Eqs. (8) and (14), we obtain

ER( fd ) = ERemp( fd )

(cid:9)

1  d
n

(cid:10)1

(cid:11)

(cid:4)
1 + E

d
i=1
n

(cid:6)

(1/i )

(16)

2.2. Remarks
1. We have made the assumption that Y and  are independent. Actually, the matrix 
depends only on the rst d functions in the basis and Y depends only on the functions
beyond d and on the noise. Thus  and Y are orthogonal but might not be statistically
independent. However in practice this assumption seems to be reasonable (see gure 1).
Also when the residual is small compared to the noise, yi  i , and the independence of
i and  motivates this assumption. Note that the assumption that there is no residual was
also made in the derivation of the Akaike Information Criterion (Akaike, 1973). Finally,

Figure 1. Comparison of the ratio (in log scale) of the median of the generalization error and training error (over
1000 trials) with the penalty term (17) and with Akaikes penalty. The latter is only accurate when d/n is small.
The number of training examples n is 50, the target function is the step function, the noise level is 0.05, the training
points are uniformly generated in [, ] and the empirical risk minimization has been carried out in the Fourier
basis.

MODEL SELECTION FOR SMALL SAMPLE REGRESSION

15

the assumption would also be valid if i (x) is independent of  j (x) (e.g. representing
independent components of the vector x).

2. We computed the ratio of the expected generalization error and the expected empirical
error. However, in practice, one would like to estimate the actual generalization error in
function of the actual empirical error.

To do this, in the previous derivation, one should replace equalities of the type

by statements of the following type: With high probability,

k(cid:2)

i=1

E

1
k

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) 1

k

k(cid:2)

i=1

yi

2 = rd +  2

(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)  c

k

yi

2  (rd +  2)

This kind of statement can be done if we have assumptions on the probability distribution
of yi and would lead to risk bounds for the model selection strategy, as shown in Bartlett,
Boucheron, and Lugosi (2000).

3. This derivation is based on the assumption that the set of basis functions is orthonormal
with respect to the probability measure (x). However in the learning problem this
probability distribution is usually unknown and therefore it is impossible to get an
explicit orthonormal basis. Nevertheless, for any given independent set of basis functions
{i (x)} and any probability distribution, using Gram-Schmidt orthonormalization, one
can theoretically get a unique orthonormal family {i (x)} that describes the same set of
functions Fd.
From the previous argument, one can still use (16) for a non orthonormal family,
keeping in mind however that the eigenvalues appearing in this estimator are the ones
corresponding to the covariance matrix constructed from the Gram-Schmidt orthonor-
malized basis.

In practice this orthogonalization can be made using unlabeled data (more details are

provided in the next section).

3. Application to model selection

As the goal in model selection is to choose the model with the smallest expected risk, the
previous analysis (see Eq. (16)) suggests to take the correcting term T (d, n) as

(cid:9)

(cid:4)

(cid:10)1

(cid:11)

(cid:6)

T (d, n) =

1  d
n

1 + E

d
i=1
n

(1/i )

(17)

where i is the i-th eigenvalue of the covariance matrix (15).
Note that in the asymptotic case, since the covariance matrix is almost the identity ma-
trix (from the orthonormality assumption), E (1/i ) 1 and we obtain Akaikes term (4).

16

O. CHAPELLE, V. VAPNIK, AND Y. BENGIO

However, in the non-asymptotic case the covariance matrix is not well-conditioned and it
can happen that E (1/i ) (cid:19) 1 (see gure 1).

Direct eigenvalue estimator method (DEE). In the case when along with training data,
unlabeled data are available (x without y), one can compute two covariance matrices:
one from unlabeled data C and another from the training data Cemp.

There is a unique matrix P (Horn & Johnson, 1985; Corollary 7.6.5) such that

P T CP = I and P T Cemp P = ,

where  is a diagonal matrix with diagonal elements 1, . . . , n. To perform model selec-
d
i=1 1/i with its empirical
tion, we used the correcting term (17) where we replace E
value,

(cid:11)

d(cid:2)

i=1

(cid:13)
(cid:13)

1/i = trace
= trace

(cid:14)

1C
1
emp
C
1
emp

.

P

C

(cid:14)

(P T )1 P T C P

C)
This enables us to deal with a non orthonormal family. As before the quantity trace(C
is an indicator of the discrepancy between the empirical covariance matrix Cemp and its ex-
pected value C.

1
emp

Smallest eigenvalue bound (SEB). To estimate E
use a lower bound on the smallest eigenvalue of the covariance matrix.
Lemma 1. With probability at least 1  

1/i appearing in Eq. (16), one can

(cid:11)

(cid:15)

Vd d (n),

min > 1 

where

(cid:6)2

i i (x)

(cid:4)

d(cid:2)

i=1

and d (n) = d

(cid:13)

ln 2n
d

(cid:14)  ln(/4)

+ 1
n

Vd = sup

x

sup
(cid:15)(cid:15)2=1

The proof is in appendix.
In practice, we take  = 0.1 and Vd = 12 and we get the following bound,

(cid:9)

(cid:10)1(cid:9)

(cid:10)

ER( fd )  ERemp( fd )

1  d
n

1 + d
nk

where

k =


1 

(cid:18)

(cid:13)

d

(cid:14) + 4




+

ln 2n
d

+ 1
n

(18)

(19)

(20)

(21)

MODEL SELECTION FOR SMALL SAMPLE REGRESSION

17

Remark: Expected risk minimization and model selection. In Section 2, we derived an
unbiased estimator of the risk of the function minimizing the mean square error on a linear
model of dimension d. The model selection procedure we proposed is to choose the model
minimizing this unbiased estimator.

However a more detailed analysis should be carried out. Indeed, if the variance of our
estimator is large and the number of models tested is also large, then some overtting
problems might occur. To avoid this, one needs to increase the penalty in order to capture
the variance of the risk estimator and the number of models. A related explanation can also
be found in Remark 2.

We do not consider here the case where of lot of models are available, but just the standard
case of nested regression (in which the number of models is less than the number of training
points) and choosing the model which minimizes an unbiased estimator of the test error
should give good results.

As explained before, the case of non-nested regression (choice of wavelet coefcients

for example) needs some additional analysis and is left for future work.

4. Experimental results

We performed toy experiments in order to compare model selection algorithms. The input
distribution is the uniform distribution on [, ] and the set of basis functions is the
Fourier basis,

1(x) = 1

2 p =

2 p+1 =

2 cos( px)

2 sin( px)

We compared our model selection methods, SEB (Smallest Empirical Bound), and DEE
(Direct Eigenvalue Estimator), to eight other methods. Six of them are penalty-based: FPE
(Akaike, Eq. (4)), Uniform Convergence Bound (UCB) (5), GCV (Wahba, Golub, & Heath,
1979), RIC (Foster & George, 1994), BIC (Schwartz, 1978), Mallows C p (CPM) (Mallows,
1973). For the UCB method, we took c = 1 and ln  = 3 in Eq. (5).

The two other model selection algorithms we considered are ADJ (a state-of-the-art

heuristic method (Schuurmans, 1997)), and CV5 (5-fold cross-validation).

Note that both ADJ and DEE need some information about the distribution of input data
(x) which can be provided by unlabeled data. In the experiments we used 1000 unlabeled
training points.

We rst compared the accuracy of some of these methods in the prediction of the gener-

alization error. For this purpose, we considered the regression function

a gaussian noise with standard deviation  = 0.05 and a training set of 40 examples. For each
d  23, we computed the empirical risk minimizer fd and tried to predict the generalization
error R( fd ). The results are shown in gure 2 and are averaged over 1000 trials.

(cid:9)

(cid:10)2

,

f (x) = 1
10

x + 3
2

18

O. CHAPELLE, V. VAPNIK, AND Y. BENGIO

Figure 2. Prediction of the generalization error for the following methods: DEE, CV5 (left), FPE, ADJ (right).

Both DEE and ADJ predict accurately the test error, ADJ being a little bit over pessimistic.
When the number of dimension becomes large, FPE underestimates the generalization error
while CV5 overestimates (this is explained by the fact that during cross-validation a smaller
training set is used).

For the model selection itself we are interested in the generalization error of the function
chosen by the model selection procedure. Indeed, as explained at the end of Section 3,
an unbiased estimator of the generalization error with a large variance might give a poor
criterion for model selection.

Different experiments have been carried out by changing the variance of the gaussian
noise, the number of training points or the target function. For each model selection proce-
dure, if the model d is chosen, we compute the log of the approximation ratio,

R( f d
mind R( fd )

)

.

log

(22)

The results are shown in boxplot style in gures 3 and 4, each one corresponding to a
different target function: sinc (sin(4x)/4x) and step (1x>0) functions. All the experiments
have been repeated 1000 times.

The plots for the sinc function (gure 3) show that the model selection procedures have
a similar performance when the function is easy to estimate (the Fourier coefcients of this
function decrease very rapidly). Only FPE is far from the optimal solution for 50 training
points.

The second example is the step function (gure 4), which is difcult to approximate in
the Fourier basis. In this case, traditional penalty based method (RIC, BIC, CPM, GCV,
FPE) fail whereas DEE, SEB, UCB, ADJ and CV5 are able to select a good model.

For each experiment, Tables 1 and 2 indicate the median and the mean (over 1000 trials)

of the approximation ratio (22).

Judging from these experiments, both proposed methods DEE and SEB perform as well
as the state-of-the-art methods, such as the ADJ heuristic or cross-validation and UCB,

MODEL SELECTION FOR SMALL SAMPLE REGRESSION

19

Figure 3. Approximation ratios for the sinc function. Numerical results can be found in Tables 1 and 2, each
letter corresponding to the same experiment.

20

O. CHAPELLE, V. VAPNIK, AND Y. BENGIO

Figure 4. Approximation ratios for the step function. Numerical results can be found in Tables 1 and 2, each
letter corresponding to the same experiment.

MODEL SELECTION FOR SMALL SAMPLE REGRESSION

21

Table 1. Median of the ratio of the test error to the best model for the 12 experiments reported in gures 3 and 4.
The last row is an average over the 12 experiments.

a
b
c
d
e
f

g
h
i
j
k
l

ADJ

SEB

1.11
1.05
1.42
1.11
1.17
1.08

1.37
1.28
1.44
1.41
1.18
1.10

1.23

1.01
1.05
1.91
1.14
1.18
1.00

1.45
1.33
1.50
1.49
1.20
1.12

1.28

CV5

1.12
1.05
1.75
1.18
1.21
1.02

1.49
1.36
1.52
1.49
1.21
1.11

1.29

DEE

UCB

GCV

RIC

BIC

FPE

CPM

1.09
1.05
1.48
1.13
1.15
1.01

1.55
1.36
1.63
1.72
1.24
1.11

1.29

1.02
1.05
1.91
1.15
1.90
1.07

1.64
1.45
1.67
2.12
1.15
1.23

1.45

1.16
1.05
1.94
1.21
1.21
1.01

2.60
2.34
3.19
18.11
1.37
1.16

3.03

1.01
1.04
1.70
1.22
1.25
1.15

4.00
2.03
6.94
36.01
1.22
1.18

4.90

1.04
1.05
1.70
1.15
1.15
1.00

4.60
5.45
7.06
36.05
1.31
1.11

5.22

1.48
1.10
2.32
1.74
1.50
1.13

4.21
12.33
4.52
30.22
1.98
1.84

5.36

1.13
1.05
1.97
1.16
1.17
1.01

5.77
13.14
7.14
42.93
1.61
1.20

6.61

Table 2. Mean of the ratio of the test error to the best model for the 12 experiments reported in gures 3 and 4.
The last row is an average over the 12 experiments.

ADJ

DEE

SEB

a
b
c
d
e
f

g
h
i
j
k
l

2.63
1.1
3.51
1.26
1.42
1.12

1.69
1.44
2.39
1.8
1.32
1.14

1.73

2.48
1.16
3.12
1.29
1.44
1.07

2.44
1.69
3.67
2.69
1.49
1.19

1.98

1.77
1.09
2.71
1.27
1.47
1.06

2.44
1.43
2.21
8.29
1.38
1.15

2.19

CV5

2.85
1.1
7.45
1.31
1.58
1.08

2.53
1.48
2.36
2.28
1.94
1.16

2.26

UCB

2.27
1.09
2.67
1.32
1.93
1.08

1.88
12.2
2.18
156
1.22
1.24

15.4

RIC

1.64
1.05
19.5
1.35
1.59
1.14

3.1e4
637
4e3
1.8e4
15.3
1.21

4.5e3

GCV

3.6e3
1.31
158
2.4e3
139
7.15

3.4e4
464
3.8e3
5.4e4
615
17.9

8.3e3

FPE

4.3e3

26

1.3e4
6.5e3
3.5e4
1e4

3.4e4
3.4e3
4e3
1e5
9.7e5
1.5e3

9.9e4

BIC

7

1.09
289
1.33
1.51
1.05

3.5e4
5.9e8
4e3
1.8e4
159
1.48

4.9e7

CPM

327
1.2
1.3e4
11.3
1.2e4
1.06

3.5e4
5.9e8
4e3
5.6e4
700
63.5

4.9e7

while classical penalty-based methods fail. It is worth noting that the ADJ heuristic seems
to be the best model selection procedure among all the ones we tested.

The comparison between Table 1 (median of the approximation ratio) and Table 2 (mean
of the approximation) gives a better insight of the behavior of some model selection algo-
rithms. For example, UCB has a median of 1.45, but a mean of 15.4. This is due to the fact

22

O. CHAPELLE, V. VAPNIK, AND Y. BENGIO

that sometimes it selects a very large model (i.e. it overts) incurring a catastrophic gen-
eralization error. The same explanation applies obviously to other penalty-based methods
(which have terrible approximation ratios in mean) and to a certain extent to CV5 (see row
c of Table 2) and SEB (see row j). Intuitively, cross-validation gives an almost unbiased
estimator of the generalization error, but because of its variance, it might select sometimes
a model which is far from the optimal one. This is also true for SEB and DEE, even though
we expect these methods to have a smaller variance. A discussion on this topic can be found
at the end of Section 3.

5. Conclusion

In this article we showed that to select models using small sample size the formulas obtained
for asymptotic classical models are insufcient. In our analysis, we pointed out that the
discrepancy between the empirical covariance matrix and its expectation is critical for small
sample size regression. Taking this discrepancy into account, we obtain a model selection
algorithm which behaves similarly to the state-of-the-art.

Further research includes improvement of the SEB method thanks to a deeper analysis
of the distribution of the eigenvalues of a covariance matrix. The DEE method is very
attractive since it provides an unbiased estimator of the generalization error of a given
model. Unfortunately it requires unlabeled data. If such data is not available, we believe this
method will still be efcient by generating unlabeled data from a Parzen window estimator
of the input density. New experiments will be carried out to assess this supposition.

From a theoretical point of view, we will focus on the remark at the end of Section 3 and
try to extend this method for non-nested regression. A typical application of this in machine
learning would be to determine the number of centers in a RBF network.

Appendix

Proof of Lemma 1: Consider the quantity

(cid:4)

d(cid:2)

(cid:6)2

Q(x, ) =

 p p(x)

p=1

For all  such that (cid:15)(cid:15) = 1, we have EQ(x, ) = 1. On the other hand,

where C = T /n is the covariance matrix and then

Q(xi , ) = T C

n(cid:2)

i=1

1
n

n(cid:2)

i=1

min(cid:15)(cid:15)=1

1
n

Q(xi , ) = min,

MODEL SELECTION FOR SMALL SAMPLE REGRESSION

23

where min is the smallest eigenvalue of C. In Vapnik (1982), it is shown that for any
family of functions Q satisfying 0  Q(x, )  B and of VC dimension d, the following
inequality holds

(cid:6)

(cid:9)

(cid:4)

n(cid:2)

i=1

P

EQ(x, )  1
n

sup


Q(xi , ) > 

 exp

d
n

(log(2n/d) + 1)  2
B2

Using this last inequality, we get that with probability 1  ,

(cid:15)

1  min <

Vd d (n)

(cid:10)

n



Acknowledgment

The authors would like to thank a anonymous referee for helpful and valuable comments.

Notes

1. Note that the choice of such a family requires knowledge about (x). See Remark 3 of Section 2.2 for more
2. Vd might be much larger than 1 for some basis , but in our experiments Vd = 1 seems to be a good choice.

details.

