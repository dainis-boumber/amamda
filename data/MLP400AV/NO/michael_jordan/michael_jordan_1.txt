Abstract

We describe latent Dirichlet allocation (LDA), a generative probabilistic model for collections of
discrete data such as text corpora. LDA is a three-level hierarchical Bayesian model, in which each
item of a collection is modeled as a nite mixture over an underlying set of topics. Each topic is, in
turn, modeled as an innite mixture over an underlying set of topic probabilities. In the context of
text modeling, the topic probabilities provide an explicit representation of a document. We present
efcient approximate inference techniques based on variational methods and an EM algorithm for
empirical Bayes parameter estimation. We report results in document modeling, text classication,
and collaborative ltering, comparing to a mixture of unigrams model and the probabilistic LSI
model.

1. Introduction

In this paper we consider the problem of modeling text corpora and other collections of discrete
data. The goal is to nd short descriptions of the members of a collection that enable efcient
processing of large collections while preserving the essential statistical relationships that are useful
for basic tasks such as classication, novelty detection, summarization, and similarity and relevance
judgments.

Signicant progress has been made on this problem by researchers in the eld of informa-
tion retrieval (IR) (Baeza-Yates and Ribeiro-Neto, 1999). The basic methodology proposed by
IR researchers for text corporaa methodology successfully deployed in modern Internet search
enginesreduces each document in the corpus to a vector of real numbers, each of which repre-
sents ratios of counts. In the popular tf-idf scheme (Salton and McGill, 1983), a basic vocabulary
of words or terms is chosen, and, for each document in the corpus, a count is formed of the
number of occurrences of each word. After suitable normalization, this term frequency count is
compared to an inverse document frequency count, which measures the number of occurrences of a

c(cid:13)2003 David M. Blei, Andrew Y. Ng and Michael I. Jordan.

BLEI, NG, AND JORDAN

word in the entire corpus (generally on a log scale, and again suitably normalized). The end result
is a term-by-document matrix X whose columns contain the tf-idf values for each of the documents
in the corpus. Thus the tf-idf scheme reduces documents of arbitrary length to xed-length lists of
numbers.

While the tf-idf reduction has some appealing featuresnotably in its basic identication of sets
of words that are discriminative for documents in the collectionthe approach also provides a rela-
tively small amount of reduction in description length and reveals little in the way of inter- or intra-
document statistical structure. To address these shortcomings, IR researchers have proposed several
other dimensionality reduction techniques, most notably latent semantic indexing (LSI) (Deerwester
et al., 1990). LSI uses a singular value decomposition of the X matrix to identify a linear subspace
in the space of tf-idf features that captures most of the variance in the collection. This approach can
achieve signicant compression in large collections. Furthermore, Deerwester et al. argue that the
derived features of LSI, which are linear combinations of the original tf-idf features, can capture
some aspects of basic linguistic notions such as synonymy and polysemy.

To substantiate the claims regarding LSI, and to study its relative strengths and weaknesses, it is
useful to develop a generative probabilistic model of text corpora and to study the ability of LSI to
recover aspects of the generative model from data (Papadimitriou et al., 1998). Given a generative
model of text, however, it is not clear why one should adopt the LSI methodologyone can attempt
to proceed more directly, tting the model to data using maximum likelihood or Bayesian methods.
A signicant step forward in this regard was made by Hofmann (1999), who presented the
probabilistic LSI (pLSI) model, also known as the aspect model, as an alternative to LSI. The pLSI
approach, which we describe in detail in Section 4.3, models each word in a document as a sample
from a mixture model, where the mixture components are multinomial random variables that can be
viewed as representations of topics. Thus each word is generated from a single topic, and different
words in a document may be generated from different topics. Each document is represented as
a list of mixing proportions for these mixture components and thereby reduced to a probability
distribution on a xed set of topics. This distribution is the reduced description associated with
the document.

While Hofmanns work is a useful step toward probabilistic modeling of text, it is incomplete
in that it provides no probabilistic model at the level of documents. In pLSI, each document is
represented as a list of numbers (the mixing proportions for topics), and there is no generative
probabilistic model for these numbers. This leads to several problems: (1) the number of parame-
ters in the model grows linearly with the size of the corpus, which leads to serious problems with
overtting, and (2) it is not clear how to assign probability to a document outside of the training set.
To see how to proceed beyond pLSI, let us consider the fundamental probabilistic assumptions
underlying the class of dimensionality reduction methods that includes LSI and pLSI. All of these
methods are based on the bag-of-words assumptionthat the order of words in a document can
be neglected. In the language of probability theory, this is an assumption of exchangeability for the
words in a document (Aldous, 1985). Moreover, although less often stated formally, these methods
also assume that documents are exchangeable; the specic ordering of the documents in a corpus
can also be neglected.

A classic representation theorem due to de Finetti (1990) establishes that any collection of ex-
changeable random variables has a representation as a mixture distributionin general an innite
mixture. Thus, if we wish to consider exchangeable representations for documents and words, we
need to consider mixture models that capture the exchangeability of both words and documents.

994

LATENT DIRICHLET ALLOCATION

This line of thinking leads to the latent Dirichlet allocation (LDA) model that we present in the
current paper.

It is important to emphasize that an assumption of exchangeability is not equivalent to an as-
sumption that the random variables are independent and identically distributed. Rather, exchange-
ability essentially can be interpreted as meaning conditionally independent and identically dis-
tributed, where the conditioning is with respect to an underlying latent parameter of a probability
distribution. Conditionally, the joint distribution of the random variables is simple and factored
while marginally over the latent parameter, the joint distribution can be quite complex. Thus, while
an assumption of exchangeability is clearly a major simplifying assumption in the domain of text
modeling, and its principal justication is that it leads to methods that are computationally efcient,
the exchangeability assumptions do not necessarily lead to methods that are restricted to simple
frequency counts or linear operations. We aim to demonstrate in the current paper that, by taking
the de Finetti theorem seriously, we can capture signicant intra-document statistical structure via
the mixing distribution.

It is also worth noting that there are a large number of generalizations of the basic notion of
exchangeability, including various forms of partial exchangeability, and that representation theo-
rems are available for these cases as well (Diaconis, 1988). Thus, while the work that we discuss in
the current paper focuses on simple bag-of-words models, which lead to mixture distributions for
single words (unigrams), our methods are also applicable to richer models that involve mixtures for
larger structural units such as n-grams or paragraphs.

The paper is organized as follows. In Section 2 we introduce basic notation and terminology.
The LDA model is presented in Section 3 and is compared to related latent variable models in
Section 4. We discuss inference and parameter estimation for LDA in Section 5. An illustrative
example of tting LDA to data is provided in Section 6. Empirical results in text modeling, text
classication and collaborative ltering are presented in Section 7. Finally, Section 8 presents our
conclusions.

2. Notation and terminology

We use the language of text collections throughout the paper, referring to entities such as words,
documents, and corpora. This is useful in that it helps to guide intuition, particularly when
we introduce latent variables which aim to capture abstract notions such as topics. It is important
to note, however, that the LDA model is not necessarily tied to text, and has applications to other
problems involving collections of data, including data from domains such as collaborative ltering,
content-based image retrieval and bioinformatics. Indeed, in Section 7.3, we present experimental
results in the collaborative ltering domain.
Formally, we dene the following terms:
(cid:15) A word is the basic unit of discrete data, dened to be an item from a vocabulary indexed by
f1, . . . ,Vg. We represent words using unit-basis vectors that have a single component equal to
one and all other components equal to zero. Thus, using superscripts to denote components,
the vth word in the vocabulary is represented by a V -vector w such that wv = 1 and wu = 0 for
u 6= v.
(cid:15) A document is a sequence of N words denoted by w = (w1, w2, . . . ,wN), where wn is the nth
word in the sequence.
(cid:15) A corpus is a collection of M documents denoted by D = fw1,w2, . . . ,wMg.

995

BLEI, NG, AND JORDAN

We wish to nd a probabilistic model of a corpus that not only assigns high probability to

members of the corpus, but also assigns high probability to other similar documents.

3. Latent Dirichlet allocation

Latent Dirichlet allocation (LDA) is a generative probabilistic model of a corpus. The basic idea is
that documents are represented as random mixtures over latent topics, where each topic is charac-
terized by a distribution over words.1

LDA assumes the following generative process for each document w in a corpus D:
1. Choose N (cid:24) Poisson(x ).
2. Choose q (cid:24) Dir(a ).
3. For each of the N words wn:

(a) Choose a topic zn (cid:24) Multinomial(q ).
(b) Choose a word wn from p(wnj zn,b ), a multinomial probability conditioned on the topic

zn.

Several simplifying assumptions are made in this basic model, some of which we remove in subse-
quent sections. First, the dimensionality k of the Dirichlet distribution (and thus the dimensionality
of the topic variable z) is assumed known and xed. Second, the word probabilities are parameter-
i j = p(w j = 1j zi = 1), which for now we treat as a xed quantity
ized by a k(cid:2)V matrix b where b
that is to be estimated. Finally, the Poisson assumption is not critical to anything that follows and
more realistic document length distributions can be used as needed. Furthermore, note that N is
independent of all the other data generating variables (q and z). It is thus an ancillary variable and
we will generally ignore its randomness in the subsequent development.
A k-dimensional Dirichlet random variable q can take values in the (k 1)-simplex (a k-vector
lies in the (k 1)-simplex if q
i = 1), and has the following probability density on this
(cid:0)
simplex:

i (cid:21) 0, (cid:229)

k
i=1

a 11
1

(cid:1)(cid:1)(cid:1)q

a k1
k

,

(1)

(cid:1)
i
i)
is a k-vector with components a

ja ) =

k
i=1
G (a

k
i=1

p(q

where the parameter a
i > 0, and where G (x) is the Gamma function.
The Dirichlet is a convenient distribution on the simplex  it is in the exponential family, has nite
dimensional sufcient statistics, and is conjugate to the multinomial distribution. In Section 5, these
properties will facilitate the development of inference and parameter estimation algorithms for LDA.
, a set of N topics z, and

, the joint distribution of a topic mixture q

Given the parameters a and b
a set of N words w is given by:

p(q ,z,wja

,b ) = p(q

ja )

N(cid:213)
n=1

p(znjq )p(wnj zn,b ),

(2)

1. We refer to the latent multinomial variables in the LDA model as topics, so as to exploit text-oriented intuitions, but
we make no epistemological claims regarding these latent variables beyond their utility in representing probability
distributions on sets of words.

996

q
q
G
(cid:229)
a
(cid:213)
q
LATENT DIRICHLET ALLOCATION

z

w

N

M

Figure 1: Graphical model representation of LDA. The boxes are plates representing replicates.
The outer plate represents documents, while the inner plate represents the repeated choice
of topics and words within a document.

where p(znjq ) is simply q
z, we obtain the marginal distribution of a document:

i for the unique i such that zi
n

= 1. Integrating over q and summing over

!
p(znjq )p(wnj zn,b )

dq .

(3)

p(wja

,b ) =

ja )

p(q

N(cid:213)
n=1

zn

Z

Z





p(D ja

,b ) =

M(cid:213)
d=1

p(q d ja )

Nd

n=1

zdn

Finally, taking the product of the marginal probabilities of single documents, we obtain the proba-
bility of a corpus:

!
p(zdnjq d)p(wdnj zdn,b )

dq d.

The LDA model is represented as a probabilistic graphical model in Figure 1. As the gure
makes clear, there are three levels to the LDA representation. The parameters a
and b are corpus-
level parameters, assumed to be sampled once in the process of generating a corpus. The variables
q d are document-level variables, sampled once per document. Finally, the variables zdn and wdn are
word-level variables and are sampled once for each word in each document.

It is important to distinguish LDA from a simple Dirichlet-multinomial clustering model. A
classical clustering model would involve a two-level model in which a Dirichlet is sampled once
for a corpus, a multinomial clustering variable is selected once for each document in the corpus,
and a set of words are selected for the document conditional on the cluster variable. As with many
clustering models, such a model restricts a document to being associated with a single topic. LDA,
on the other hand, involves three levels, and notably the topic node is sampled repeatedly within the
document. Under this model, documents can be associated with multiple topics.

Structures similar to that shown in Figure 1 are often studied in Bayesian statistical modeling,
where they are referred to as hierarchical models (Gelman et al., 1995), or more precisely as con-
ditionally independent hierarchical models (Kass and Steffey, 1989). Such models are also often
referred to as parametric empirical Bayes models, a term that refers not only to a particular model
structure, but also to the methods used for estimating parameters in the model (Morris, 1983). In-
deed, as we discuss in Section 5, we adopt the empirical Bayes approach to estimating parameters
such as a and b
in simple implementations of LDA, but we also consider fuller Bayesian approaches
as well.

997

a
q
b
(cid:229)
(cid:213)
(cid:229)
BLEI, NG, AND JORDAN

3.1 LDA and exchangeability
A nite set of random variables fz1, . . . ,zNg is said to be exchangeable if the joint distribution is
invariant to permutation. If p

is a permutation of the integers from 1 to N:

p(z1, . . . ,zN) = p(zp (1), . . . ,zp (N)).

An innite sequence of random variables is innitely exchangeable if every nite subsequence is
exchangeable.

De Finettis representation theorem states that the joint distribution of an innitely exchangeable
sequence of random variables is as if a random parameter were drawn from some distribution and
then the random variables in question were independent and identically distributed, conditioned on
that parameter.

In LDA, we assume that words are generated by topics (by xed conditional distributions) and
that those topics are innitely exchangeable within a document. By de Finettis theorem, the prob-
ability of a sequence of words and topics must therefore have the form:

Z



!
p(znjq )p(wnj zn)

dq ,

p(w,z) =

p(q )

N(cid:213)
n=1

where q
is the random parameter of a multinomial over topics. We obtain the LDA distribution
on documents in Eq. (3) by marginalizing out the topic variables and endowing q with a Dirichlet
distribution.

3.2 A continuous mixture of unigrams

The LDA model shown in Figure 1 is somewhat more elaborate than the two-level models often
studied in the classical hierarchical Bayesian literature. By marginalizing over the hidden topic
variable z, however, we can understand LDA as a two-level model.

In particular, let us form the word distribution p(wjq ,b ):

p(wjq ,b ) = (cid:229)

p(wj z,b )p(zjq ).

Note that this is a random quantity since it depends on q

.

z

We now dene the following generative process for a document w:
1. Choose q (cid:24) Dir(a ).
2. For each of the N words wn:

(a) Choose a word wn from p(wnjq ,b ).

Z

This process denes the marginal distribution of a document as a continuous mixture distribution:



!
p(wnjq ,b )
ja ) are the mixture weights.

dq ,

ja )

p(q

,b ) =

p(wja

N(cid:213)
n=1
where p(wnjq ,b ) are the mixture components and p(q
Figure 2 illustrates this interpretation of LDA. It depicts the distribution on p(wjq ,b ) which is
induced from a particular instance of an LDA model. Note that this distribution on the (V  1)-
simplex is attained with only k + kV parameters yet exhibits a very interesting multimodal structure.

998

LATENT DIRICHLET ALLOCATION
































Figure 2: An example density on unigram distributions p(wjq ,b ) under LDA for three words and
four topics. The triangle embedded in the x-y plane is the 2-D simplex representing all
possible multinomial distributions over three words. Each of the vertices of the trian-
gle corresponds to a deterministic distribution that assigns probability one to one of the
words; the midpoint of an edge gives probability 0.5 to two of the words; and the centroid
of the triangle is the uniform distribution over all three words. The four points marked
with an x are the locations of the multinomial distributions p(wj z) for each of the four
topics, and the surface shown on top of the simplex is an example of a density over the
(V  1)-simplex (multinomial distributions of words) given by LDA.

4. Relationship with other latent variable models

In this section we compare LDA to simpler latent variable models for textthe unigram model, a
mixture of unigrams, and the pLSI model. Furthermore, we present a unied geometric interpreta-
tion of these models which highlights their key differences and similarities.

4.1 Unigram model

Under the unigram model, the words of every document are drawn independently from a single
multinomial distribution:

p(w) =

N(cid:213)
n=1

p(wn).

This is illustrated in the graphical model in Figure 3a.

999

BLEI, NG, AND JORDAN

w

N

M

(a) unigram

z

w

N

M

(b) mixture of unigrams

d

z

w

N

M

(c) pLSI/aspect model

Figure 3: Graphical model representation of different models of discrete data.

4.2 Mixture of unigrams

If we augment the unigram model with a discrete random topic variable z (Figure 3b), we obtain a
mixture of unigrams model (Nigam et al., 2000). Under this mixture model, each document is gen-
erated by rst choosing a topic z and then generating N words independently from the conditional
multinomial p(wj z). The probability of a document is:

p(w) = (cid:229)

p(z)

N(cid:213)
n=1

z

p(wnj z).

When estimated from a corpus, the word distributions can be viewed as representations of topics
under the assumption that each document exhibits exactly one topic. As the empirical results in
Section 7 illustrate, this assumption is often too limiting to effectively model a large collection of
documents.
In contrast, the LDA model allows documents to exhibit multiple topics to different degrees.
This is achieved at a cost of just one additional parameter: there are k  1 parameters associated
with p(z) in the mixture of unigrams, versus the k parameters associated with p(q

ja ) in LDA.

4.3 Probabilistic latent semantic indexing

Probabilistic latent semantic indexing (pLSI) is another widely used document model (Hofmann,
1999). The pLSI model, illustrated in Figure 3c, posits that a document label d and a word wn are

1000

LATENT DIRICHLET ALLOCATION

conditionally independent given an unobserved topic z:

p(d, wn) = p(d)(cid:229)

p(wnj z)p(zj d).

z

The pLSI model attempts to relax the simplifying assumption made in the mixture of unigrams
model that each document is generated from only one topic. In a sense, it does capture the possibility
that a document may contain multiple topics since p(zj d) serves as the mixture weights of the topics
for a particular document d. However, it is important to note that d is a dummy index into the list
of documents in the training set. Thus, d is a multinomial random variable with as many possible
values as there are training documents and the model learns the topic mixtures p(zj d) only for those
documents on which it is trained. For this reason, pLSI is not a well-dened generative model of
documents; there is no natural way to use it to assign probability to a previously unseen document.
A further difculty with pLSI, which also stems from the use of a distribution indexed by train-
ing documents, is that the number of parameters which must be estimated grows linearly with the
number of training documents. The parameters for a k-topic pLSI model are k multinomial distri-
butions of size V and M mixtures over the k hidden topics. This gives kV + kM parameters and
therefore linear growth in M. The linear growth in parameters suggests that the model is prone
to overtting and, empirically, overtting is indeed a serious problem (see Section 7.1). In prac-
tice, a tempering heuristic is used to smooth the parameters of the model for acceptable predic-
tive performance. It has been shown, however, that overtting can occur even when tempering is
used (Popescul et al., 2001).

LDA overcomes both of these problems by treating the topic mixture weights as a k-parameter
hidden random variable rather than a large set of individual parameters which are explicitly linked to
the training set. As described in Section 3, LDA is a well-dened generative model and generalizes
easily to new documents. Furthermore, the k + kV parameters in a k-topic LDA model do not grow
with the size of the training corpus. We will see in Section 7.1 that LDA does not suffer from the
same overtting issues as pLSI.

4.4 A geometric interpretation

A good way of illustrating the differences between LDA and the other latent topic models is by
considering the geometry of the latent space, and seeing how a document is represented in that
geometry under each model.

All four of the models described aboveunigram, mixture of unigrams, pLSI, and LDA
operate in the space of distributions over words. Each such distribution can be viewed as a point on
the (V  1)-simplex, which we call the word simplex.

The unigram model nds a single point on the word simplex and posits that all words in the
corpus come from the corresponding distribution. The latent variable models consider k points on
the word simplex and form a sub-simplex based on those points, which we call the topic simplex.
Note that any point on the topic simplex is also a point on the word simplex. The different latent
variable models use the topic simplex in different ways to generate a document.

(cid:15) The mixture of unigrams model posits that for each document, one of the k points on the word
simplex (that is, one of the corners of the topic simplex) is chosen randomly and all the words
of the document are drawn from the distribution corresponding to that point.

1001

BLEI, NG, AND JORDAN

topic simplex








x

x

topic 1







































x




























x






























x











x

x

x

x

x

x

x

x

word simplex

x

x

x

x

x

x

x

x

x

x

x

topic 2

x

x

x

































topic 3

Figure 4: The topic simplex for three topics embedded in the word simplex for three words. The
corners of the word simplex correspond to the three distributions where each word (re-
spectively) has probability one. The three points of the topic simplex correspond to three
different distributions over words. The mixture of unigrams places each document at one
of the corners of the topic simplex. The pLSI model induces an empirical distribution on
the topic simplex denoted by x. LDA places a smooth distribution on the topic simplex
denoted by the contour lines.

(cid:15) The pLSI model posits that each word of a training document comes from a randomly chosen
topic. The topics are themselves drawn from a document-specic distribution over topics,
i.e., a point on the topic simplex. There is one such distribution for each document; the set of
training documents thus denes an empirical distribution on the topic simplex.

(cid:15) LDA posits that each word of both the observed and unseen documents is generated by a
randomly chosen topic which is drawn from a distribution with a randomly chosen parameter.
This parameter is sampled once per document from a smooth distribution on the topic simplex.

These differences are highlighted in Figure 4.

5. Inference and Parameter Estimation

We have described the motivation behind LDA and illustrated its conceptual advantages over other
latent topic models. In this section, we turn our attention to procedures for inference and parameter
estimation under LDA.

1002

LATENT DIRICHLET ALLOCATION

z

w

N

M

z

N

M

Figure 5: (Left) Graphical model representation of LDA. (Right) Graphical model representation

of the variational distribution used to approximate the posterior in LDA.

5.1 Inference

The key inferential problem that we need to solve in order to use LDA is that of computing the
posterior distribution of the hidden variables given a document:

,b )

.

,b ) = p(q ,z,wja
p(wja
,b )
!

!

p(q ,zjw,a

Z
k(cid:213)
i=1

i a
G ((cid:229)
i G (a

i)
i)

Unfortunately, this distribution is intractable to compute in general. Indeed, to normalize the distri-
bution we marginalize over the hidden variables and write Eq. (3) in terms of the model parameters:

i1

i

,b ) =

p(wja

V(cid:213)
(q
j=1
a function which is intractable due to the coupling between q and b
in the summation over latent
topics (Dickey, 1983). Dickey shows that this function is an expectation under a particular extension
to the Dirichlet distribution which can be represented with special hypergeometric functions. It has
been used in a Bayesian context for censored discrete data to represent the posterior on q which, in
that setting, is a random parameter (Dickey et al., 1987).

N(cid:213)
n=1

k(cid:229)
i=1

ib

i j)w j

n

dq ,

Although the posterior distribution is intractable for exact inference, a wide variety of approxi-
mate inference algorithms can be considered for LDA, including Laplace approximation, variational
approximation, and Markov chain Monte Carlo (Jordan, 1999). In this section we describe a simple
convexity-based variational algorithm for inference in LDA, and discuss some of the alternatives in
Section 8.

5.2 Variational inference

The basic idea of convexity-based variational inference is to make use of Jensens inequality to ob-
tain an adjustable lower bound on the log likelihood (Jordan et al., 1999). Essentially, one considers
a family of lower bounds, indexed by a set of variational parameters. The variational parameters
are chosen by an optimization procedure that attempts to nd the tightest possible lower bound.

A simple way to obtain a tractable family of lower bounds is to consider simple modications
of the original graphical model in which some of the edges and nodes are removed. Consider in
particular the LDA model shown in Figure 5 (left). The problematic coupling between q and b

1003

b
a
q
q
f
g
(cid:213)
q
a
BLEI, NG, AND JORDAN

arises due to the edges between q
, z, and w. By dropping these edges and the w nodes, and endow-
ing the resulting simplied graphical model with free variational parameters, we obtain a family
of distributions on the latent variables. This family is characterized by the following variational
distribution:

q(q ,zjg ,f ) = q(q

jg )

q(znjf n),

N(cid:213)
n=1

(4)

where the Dirichlet parameter g and the multinomial parameters (f 1, . . . ,f N) are the free variational
parameters.

Having specied a simplied family of probability distributions, the next step is to set up an
optimization problem that determines the values of the variational parameters g and f
. As we show
in Appendix A, the desideratum of nding a tight lower bound on the log likelihood translates
directly into the following optimization problem:

(g (cid:3),f (cid:3)) = argmin
(g ,f )

D(q(q ,zjg ,f ) k p(q ,zjw,a

,b )).

(5)

Thus the optimizing values of the variational parameters are found by minimizing the Kullback-
Leibler (KL) divergence between the variational distribution and the true posterior p(q ,zjw,a
,b ).
This minimization can be achieved via an iterative xed-point method. In particular, we show in
Appendix A.3 that by computing the derivatives of the KL divergence and setting them equal to
zero, we obtain the following pair of update equations:

f ni

i = a

iwn expfEq[log(q
i + (cid:229) N

f ni.

n=1

i)jg ]g

(6)
(7)

As we show in Appendix A.1, the expectation in the multinomial update can be computed as follows:

Eq[log(q

i)jg ] = Y

(g

i) Y

k
j=1

j

,

(8)

(cid:0)

(cid:1)

is the rst derivative of the logG

function which is computable via Taylor approxima-

where Y
tions (Abramowitz and Stegun, 1970).
Eqs. (6) and (7) have an appealing intuitive interpretation. The Dirichlet update is a poste-
rior Dirichlet given expected observations taken under the variational distribution, E[znjf n]. The
multinomial update is akin to using Bayes theorem, p(znj wn) (cid:181)
p(wnj zn)p(zn), where p(zn) is
approximated by the exponential of the expected value of its logarithm under the variational distri-
bution.

It is important to note that the variational distribution is actually a conditional distribution,
varying as a function of w. This occurs because the optimization problem in Eq. (5) is conducted
for xed w, and thus yields optimizing parameters (g (cid:3),f (cid:3)) that are a function of w. We can write
the resulting variational distribution as q(q ,zjg (cid:3)(w),f (cid:3)(w)), where we have made the dependence
on w explicit. Thus the variational distribution can be viewed as an approximation to the posterior
distribution p(q ,zjw,a
In the language of text, the optimizing parameters (g (cid:3)(w),f (cid:3)(w)) are document-specic. In
particular, we view the Dirichlet parameters g (cid:3)(w) as providing a representation of a document in
the topic simplex.

,b ).

1004

(cid:181)
b
g
(cid:229)
g
LATENT DIRICHLET ALLOCATION

(1)
(2)
(3)
(4)
(5)
(6)
(7)
(8)
(9)

initialize f 0
initialize g
repeat

ni := 1/k for all i and n
i := a
i + N/k for all i

for n = 1 to N

t+1
ni

for i = 1 to k
:= b
normalize f
g t+1 := a + (cid:229) N
until convergence

(g t
i

iwn exp(Y
t+1
n
n=1

))
to sum to 1.
t+1
n

Figure 6: A variational inference algorithm for LDA.

We summarize the variational inference procedure in Figure 6, with appropriate starting points
for g and f n. From the pseudocode it is clear that each iteration of variational inference for LDA
requires O((N + 1)k) operations. Empirically, we nd that the number of iterations required for a
single document is on the order of the number of words in the document. This yields a total number
of operations roughly on the order of N2k.

5.3 Parameter estimation

In this section we present an empirical Bayes method for parameter estimation in the LDA model
(see Section 5.4 for a fuller Bayesian approach). In particular, given a corpus of documents D =
fw1,w2, . . . ,wMg, we wish to nd parameters a
that maximize the (marginal) log likelihood
of the data:

and b

(cid:96)(a

,b ) =

log p(wd ja

,b ).

M(cid:229)
d=1

As we have described above, the quantity p(wja

,b ) cannot be computed tractably. However,
variational inference provides us with a tractable lower bound on the log likelihood, a bound which
we can maximize with respect to a and b
. We can thus nd approximate empirical Bayes estimates
for the LDA model via an alternating variational EM procedure that maximizes a lower bound with
respect to the variational parameters g and f
, and then, for xed values of the variational parameters,
maximizes the lower bound with respect to the model parameters a and b

.

We provide a detailed derivation of the variational EM algorithm for LDA in Appendix A.4.

The derivation yields the following iterative algorithm:

1. (E-step) For each document, nd the optimizing values of the variational parameters fg (cid:3)

d 2 Dg. This is done as described in the previous section.

,f (cid:3)
d :

d

2. (M-step) Maximize the resulting lower bound on the log likelihood with respect to the model
parameters a and b
. This corresponds to nding maximum likelihood estimates with expected
sufcient statistics for each document under the approximate posterior which is computed in
the E-step.

1005

f
f
BLEI, NG, AND JORDAN

k

z

w

N

M

Figure 7: Graphical model representation of the smoothed LDA model.

These two steps are repeated until the lower bound on the log likelihood converges.

In Appendix A.4, we show that the M-step update for the conditional multinomial parameter b

can be written out analytically:

i j (cid:181)

M(cid:229)
d=1

Nd

n=1

f (cid:3)
dniw j
dn

.

(9)

We further show that the M-step update for Dirichlet parameter a
efcient Newton-Raphson method in which the Hessian is inverted in linear time.

can be implemented using an

5.4 Smoothing

The large vocabulary size that is characteristic of many document corpora creates serious problems
of sparsity. A new document is very likely to contain words that did not appear in any of the
documents in a training corpus. Maximum likelihood estimates of the multinomial parameters
assign zero probability to such words, and thus zero probability to new documents. The standard
approach to coping with this problem is to smooth the multinomial parameters, assigning positive
probability to all vocabulary items whether or not they are observed in the training set (Jelinek,
1997). Laplace smoothing is commonly used; this essentially yields the mean of the posterior
distribution under a uniform Dirichlet prior on the multinomial parameters.

Unfortunately, in the mixture model setting, simple Laplace smoothing is no longer justied as a
maximum a posteriori method (although it is often implemented in practice; cf. Nigam et al., 1999).
In fact, by placing a Dirichlet prior on the multinomial parameter we obtain an intractable posterior
in the mixture model setting, for much the same reason that one obtains an intractable posterior in
the basic LDA model. Our proposed solution to this problem is to simply apply variational inference
methods to the extended model that includes Dirichlet smoothing on the multinomial parameter.
In the LDA setting, we obtain the extended graphical model shown in Figure 7. We treat b as
a k (cid:2) V random matrix (one row for each mixture component), where we assume that each row
is independently drawn from an exchangeable Dirichlet distribution.2 We now extend our infer-
ence procedures to treat the b
i as random variables that are endowed with a posterior distribution,
2. An exchangeable Dirichlet is simply a Dirichlet distribution with a single scalar parameter h

. The density is the same

as a Dirichlet (Eq. 1) where a

i = h

for each component.

1006

a
q
b
h
b
(cid:229)
LATENT DIRICHLET ALLOCATION

conditioned on the data. Thus we move beyond the empirical Bayes procedure of Section 5.3 and
consider a fuller Bayesian approach to LDA.

We consider a variational approach to Bayesian inference that places a separable distribution on

the random variables b

, q

, and z (Attias, 2000):
q(b 1:k,z1:M,q 1:M jl ,f ,g ) =

k(cid:213)
i=1

Dir(b

ijl

i)

M(cid:213)
d=1

qd(q d,zd jf d,g d),

where qd(q ,zjf ,g ) is the variational distribution dened for LDA in Eq. (4). As is easily veried,
the resulting variational inference procedure again yields Eqs. (6) and (7) as the update equations
for the variational parameters f
and g , respectively, as well as an additional update for the new
variational parameter l :

i j = h +

M(cid:229)
d=1

Nd

n=1

f (cid:3)
dniw j
dn

.

Iterating these equations to convergence yields an approximate posterior distribution on b

, and z.
We are now left with the hyperparameter h on the exchangeable Dirichlet, as well as the hy-
perparameter a
from before. Our approach to setting these hyperparameters is again (approximate)
empirical Bayeswe use variational EM to nd maximum likelihood estimates of these parameters
based on the marginal likelihood. These procedures are described in Appendix A.4.

, q

6. Example

In this section, we provide an illustrative example of the use of an LDA model on real data. Our
data are 16,000 documents from a subset of the TREC AP corpus (Harman, 1992). After removing
a standard list of stop words, we used the EM algorithm described in Section 5.3 to nd the Dirichlet
and conditional multinomial parameters for a 100-topic LDA model. The top words from some of
the resulting multinomial distributions p(wj z) are illustrated in Figure 8 (top). As we have hoped,
these distributions seem to capture some of the underlying topics in the corpus (and we have named
them according to these topics).

As we emphasized in Section 4, one of the advantages of LDA over related latent variable mod-
els is that it provides well-dened inference procedures for previously unseen documents. Indeed,
we can illustrate how LDA works by performing inference on a held-out document and examining
the resulting variational posterior parameters.

Figure 8 (bottom) is a document from the TREC AP corpus which was not used for parameter
estimation. Using the algorithm in Section 5.1, we computed the variational posterior Dirichlet
parameters g for the article and variational posterior multinomial parameters f n for each word in the
article.

Recall that the ith posterior Dirichlet parameter g

i is approximately the ith prior Dirichlet pa-
rameter a
i plus the expected number of words which were generated by the ith topic (see Eq. 7).
Therefore, the prior Dirichlet parameters subtracted from the posterior Dirichlet parameters indicate
the expected number of words which were allocated to each topic for a particular document. For
the example article in Figure 8 (bottom), most of the g
i. Four topics, however, are
i (cid:21) 1). Looking at the corresponding distributions over
signicantly larger (by this, we mean g
words identies the topics which mixed to form this document (Figure 8, top).

i are close to a

i  a

1007

l
(cid:229)
BLEI, NG, AND JORDAN

Further insight comes from examining the f n parameters. These distributions approximate
p(znjw) and tend to peak towards one of the k possible topic values. In the article text in Figure 8,
the words are color coded according to these values (i.e., the ith color is used if qn(zi
= 1) > 0.9).
n
With this illustration, one can identify how the different topics mixed in the document text.

While demonstrating the power of LDA, the posterior analysis also highlights some of its lim-
itations. In particular, the bag-of-words assumption allows words that should be generated by the
same topic (e.g., William Randolph Hearst Foundation) to be allocated to several different top-
ics. Overcoming this limitation would require some form of extension of the basic LDA model;
in particular, we might relax the bag-of-words assumption by assuming partial exchangeability or
Markovianity of word sequences.

7. Applications and Empirical Results

In this section, we discuss our empirical evaluation of LDA in several problem domainsdocument
modeling, document classication, and collaborative ltering.

In all of the mixture models, the expected complete log likelihood of the data has local max-
ima at the points where all or some of the mixture components are equal to each other. To avoid
these local maxima, it is important to initialize the EM algorithm appropriately. In our experiments,
we initialize EM by seeding each conditional multinomial distribution with ve documents, reduc-
ing their effective total length to two words, and smoothing across the whole vocabulary. This is
essentially an approximation to the scheme described in Heckerman and Meila (2001).

7.1 Document modeling

We trained a number of latent variable models, including LDA, on two text corpora to compare the
generalization performance of these models. The documents in the corpora are treated as unlabeled;
thus, our goal is density estimationwe wish to achieve high likelihood on a held-out test set. In
particular, we computed the perplexity of a held-out test set to evaluate the models. The perplexity,
used by convention in language modeling, is monotonically decreasing in the likelihood of the test
data, and is algebraicly equivalent to the inverse of the geometric mean per-word likelihood. A
lower perplexity score indicates better generalization performance.3 More formally, for a test set of
M documents, the perplexity is:

perplexity(Dtest) = exp

(cid:26)
(cid:229) M

d=1 log p(wd)
(cid:229) M

d=1 Nd

(cid:27)

.

In our experiments, we used a corpus of scientic abstracts from the C. Elegans community (Av-
ery, 2002) containing 5,225 abstracts with 28,414 unique terms, and a subset of the TREC AP corpus
containing 16,333 newswire articles with 23,075 unique terms. In both cases, we held out 10% of
the data for test purposes and trained the models on the remaining 90%. In preprocessing the data,

3. Note that we simply use perplexity as a gure of merit for comparing models. The models that we compare are all
unigram (bag-of-words) models, whichas we have discussed in the Introductionare of interest in the informa-
tion retrieval context. We are not attempting to do language modeling in this paperan enterprise that would require
us to examine trigram or other higher-order models. We note in passing, however, that extensions of LDA could be
considered that involve Dirichlet-multinomial over trigrams instead of unigrams. We leave the exploration of such
extensions to language modeling to future work.

1008

LATENT DIRICHLET ALLOCATION

\A"

\B	dge"

\Chide" \Ed	cai"

EW

F

SW

USC

VE

AY



CDRE

SC

TAX

RGRA

BUDGET

B

WE

EE

CD

YEARS

STUDETS

SCS

EDUCAT

TEACERS

FEDERA

FAES

G

USCA YEAR

WR

UBC

BEST

SEDG

ARETS

TEACER

ACTR

EW

FRST

YR

STATE

A

SAYS

FAY

BEETT

AGAT

WEFARE

AY

ERA

EY

E

STATE

TEATER RGRAS

ERCET

RESDET

ACTRESS GVERET CARE

EEETARY

VE

CGRESS

FE

AT

The William Randolph Hearst Foundation will give $1.25 million to Lincoln Center, Metropoli-
tan Opera Co., New York Philharmonic and Juilliard School. Our board felt
that we had a
real opportunity to make a mark on the future of the performing arts with these grants an act
every bit as important as our traditional areas of support in health, medical research, education
and the social services, Hearst Foundation President Randolph A. Hearst said Monday in
announcing the grants. Lincoln Centers share will be $200,000 for its new building, which
will house young artists and provide new public facilities. The Metropolitan Opera Co. and
New York Philharmonic will receive $400,000 each. The Juilliard School, where music and
the performing arts are taught, will get $250,000. The Hearst Foundation, a leading supporter
of the Lincoln Center Consolidated Corporate Fund, will make its usual annual $100,000
donation, too.

Figure 8: An example article from the AP corpus. Each color codes a different factor from which

the word is putatively generated.

1009

BLEI, NG, AND JORDAN

Smoothed Unigram
Smoothed Mixt. Unigrams
LDA
Fold in pLSI

10

20

30

40

50

60

70

80

90

100

Number of Topics

Smoothed Unigram
Smoothed Mixt. Unigrams
LDA
Fold in pLSI

20

40

60

80

100

120

140

160

180

200

Number of Topics

l

y
t
i
x
e
p
r
e
P

l

y
t
i
x
e
p
r
e
P

3400

3200

3000

2800

2600

2400

2200

2000

1800

1600

1400
0

7000

6500

6000

5500

5000

4500

4000

3500

3000

2500
0

Figure 9: Perplexity results on the nematode (Top) and AP (Bottom) corpora for LDA, the unigram

model, mixture of unigrams, and pLSI.

1010

LATENT DIRICHLET ALLOCATION

Num. topics (k) Perplexity (Mult. Mixt.) Perplexity (pLSI)
2
5
10
20
50
100
200

22,266
2.20(cid:2) 108
1.93(cid:2) 1017
1.20(cid:2) 1022
4.19(cid:2) 10106
2.39(cid:2) 10150
3.51(cid:2) 10264

7,052
17,588
63,800
2.52(cid:2) 105
5.04(cid:2) 106
1.72(cid:2) 107
1.31(cid:2) 107

Table 1: Overtting in the mixture of unigrams and pLSI models for the AP corpus. Similar behav-

ior is observed in the nematode corpus (not reported).

we removed a standard list of 50 stop words from each corpus. From the AP data, we further
removed words that occurred only once.

We compared LDA with the unigram, mixture of unigrams, and pLSI models described in Sec-
tion 4. We trained all the hidden variable models using EM with exactly the same stopping criteria,
that the average change in expected log likelihood is less than 0.001%.

Both the pLSI model and the mixture of unigrams suffer from serious overtting issues, though
for different reasons. This phenomenon is illustrated in Table 1. In the mixture of unigrams model,
overtting is a result of peaked posteriors in the training set; a phenomenon familiar in the super-
vised setting, where this model is known as the naive Bayes model (Rennie, 2001). This leads to a
nearly deterministic clustering of the training documents (in the E-step) which is used to determine
the word probabilities in each mixture component (in the M-step). A previously unseen document
may best t one of the resulting mixture components, but will probably contain at least one word
which did not occur in the training documents that were assigned to that component. Such words
will have a very small probability, which causes the perplexity of the new document to explode.
As k increases, the documents of the training corpus are partitioned into ner collections and thus
induce more words with small probabilities.

In the mixture of unigrams, we can alleviate overtting through the variational Bayesian smooth-
ing scheme presented in Section 5.4. This ensures that all words will have some probability under
every mixture component.

In the pLSI case, the hard clustering problem is alleviated by the fact that each document is
allowed to exhibit a different proportion of topics. However, pLSI only refers to the training doc-
uments and a different overtting problem arises that is due to the dimensionality of the p(zjd)
parameter. One reasonable approach to assigning probability to a previously unseen document is by
marginalizing over d:

p(w) = (cid:229)

N(cid:213)
n=1

z

d

p(wnj z)p(zj d)p(d).

Essentially, we are integrating over the empirical distribution on the topic simplex (see Figure 4).

This method of inference, though theoretically sound, causes the model to overt. The document-
specic topic distribution has some components which are close to zero for those topics that do not
appear in the document. Thus, certain words will have very small probability in the estimates of

1011

(cid:229)
BLEI, NG, AND JORDAN

each mixture component. When determining the probability of a new document through marginal-
ization, only those training documents which exhibit a similar proportion of topics will contribute
to the likelihood. For a given training documents topic proportions, any word which has small
probability in all the constituent topics will cause the perplexity to explode. As k gets larger, the
chance that a training document will exhibit topics that cover all the words in the new document
decreases and thus the perplexity grows. Note that pLSI does not overt as quickly (with respect to
k) as the mixture of unigrams.

This overtting problem essentially stems from the restriction that each future document exhibit
the same topic proportions as were seen in one or more of the training documents. Given this
constraint, we are not free to choose the most likely proportions of topics for the new document. An
alternative approach is the folding-in heuristic suggested by Hofmann (1999), where one ignores
the p(zjd) parameters and rets p(zjdnew). Note that this gives the pLSI model an unfair advantage
by allowing it to ret k 1 parameters to the test data.

LDA suffers from neither of these problems. As in pLSI, each document can exhibit a different
proportion of underlying topics. However, LDA can easily assign probability to a new document;
no heuristics are needed for a new document to be endowed with a different set of topic proportions
than were associated with documents in the training corpus.

Figure 9 presents the perplexity for each model on both corpora for different values of k. The
pLSI model and mixture of unigrams are suitably corrected for overtting. The latent variable
models perform better than the simple unigram model. LDA consistently performs better than the
other models.

7.2 Document classication

In the text classication problem, we wish to classify a document into two or more mutually ex-
clusive classes. As in any classication problem, we may wish to consider generative approaches
or discriminative approaches. In particular, by using one LDA module for each class, we obtain a
generative model for classication. It is also of interest to use LDA in the discriminative framework,
and this is our focus in this section.

A challenging aspect of the document classication problem is the choice of features. Treating
individual words as features yields a rich but very large feature set (Joachims, 1999). One way to
reduce this feature set is to use an LDA model for dimensionality reduction. In particular, LDA
reduces any document to a xed set of real-valued featuresthe posterior Dirichlet parameters
g (cid:3)(w) associated with the document. It is of interest to see how much discriminatory information
we lose in reducing the document description to these parameters.

We conducted two binary classication experiments using the Reuters-21578 dataset. The

dataset contains 8000 documents and 15,818 words.

In these experiments, we estimated the parameters of an LDA model on all the documents,
without reference to their true class label. We then trained a support vector machine (SVM) on the
low-dimensional representations provided by LDA and compared this SVM to an SVM trained on
all the word features.

Using the SVMLight software package (Joachims, 1999), we compared an SVM trained on all
the word features with those trained on features induced by a 50-topic LDA model. Note that we
reduce the feature space by 99.6 percent in this case.

1012

LATENT DIRICHLET ALLOCATION

95

y
c
a
r
u
c
c
A

90

85
0

98

97

96

95

94

y
c
a
r
u
c
c
A

0.25

93
0

LDA Features
Word Features

0.05
0.2
Proportion of data used for training

0.15

0.1

0.25

LDA Features
Word Features

0.05

0.2
Proportion of data used for training

0.15

0.1

(a)

(b)

Figure 10: Classication results on two binary classication problems from the Reuters-21578
dataset for different proportions of training data. Graph (a) is EARN vs. NOT EARN.
Graph (b) is GRAIN vs. NOT GRAIN.

LDA
Fold in pLSI
Smoothed Mixt. Unigrams

600

550

500

450

400

350

300

250

l

i

y
t
i
x
e
p
r
e
P
e
v
i
t
c
d
e
r
P



200
0

10

20
Number of Topics

30

40

50

Figure 11: Results for collaborative ltering on the EachMovie data.

Figure 10 shows our results. We see that there is little reduction in classication performance
in using the LDA-based features; indeed, in almost all cases the performance is improved with the
LDA features. Although these results need further substantiation, they suggest that the topic-based
representation provided by LDA may be useful as a fast ltering algorithm for feature selection in
text classication.

1013

BLEI, NG, AND JORDAN

7.3 Collaborative ltering

Our nal experiment uses the EachMovie collaborative ltering data. In this data set, a collection
of users indicates their preferred movie choices. A user and the movies chosen are analogous to a
document and the words in the document (respectively).

The collaborative ltering task is as follows. We train a model on a fully observed set of users.
Then, for each unobserved user, we are shown all but one of the movies preferred by that user and
are asked to predict what the held-out movie is. The different algorithms are evaluated according to
the likelihood they assign to the held-out movie. More precisely, dene the predictive perplexity on
M test users to be:

predictive-perplexity(Dtest) = exp

(cid:26)

(cid:229) M

d=1 log p(wd,Nd
M

jwd,1:Nd1)

(cid:27)

)

.

We restricted the EachMovie dataset to users that positively rated at least 100 movies (a positive
rating is at least four out of ve stars). We divided this set of users into 3300 training users and 390
testing users.

Under the mixture of unigrams model, the probability of a movie given a set of observed movies

is obtained from the posterior distribution over topics:

p(wjwobs) = (cid:229)

p(wjz)p(zjwobs).

z

In the pLSI model, the probability of a held-out movie is given by the same equation except that
p(zjwobs) is computed by folding in the previously seen movies. Finally, in the LDA model, the
probability of a held-out movie is given by integrating over the posterior Dirichlet:

Z

p(wjwobs) =

p(wjz)p(zjq )p(q jwobs)dq ,

z

where p(q jwobs) is given by the variational inference method described in Section 5.2. Note that
this quantity is efcient to compute. We can interchange the sum and integral sign, and compute a
linear combination of k Dirichlet expectations.

With a vocabulary of 1600 movies, we nd the predictive perplexities illustrated in Figure 11.
Again, the mixture of unigrams model and pLSI are corrected for overtting, but the best predictive
perplexities are obtained by the LDA model.

8. Discussion

We have described latent Dirichlet allocation, a exible generative probabilistic model for collec-
tions of discrete data. LDA is based on a simple exchangeability assumption for the words and
topics in a document; it is therefore realized by a straightforward application of de Finettis repre-
sentation theorem. We can view LDA as a dimensionality reduction technique, in the spirit of LSI,
but with proper underlying generative probabilistic semantics that make sense for the type of data
that it models.

Exact inference is intractable for LDA, but any of a large suite of approximate inference algo-
rithms can be used for inference and parameter estimation within the LDA framework. We have
presented a simple convexity-based variational approach for inference, showing that it yields a fast

1014

(cid:229)
LATENT DIRICHLET ALLOCATION

algorithm resulting in reasonable comparative performance in terms of test set likelihood. Other
approaches that might be considered include Laplace approximation, higher-order variational tech-
niques, and Monte Carlo methods.
In particular, Leisink and Kappen (2002) have presented a
general methodology for converting low-order variational lower bounds into higher-order varia-
tional bounds. It is also possible to achieve higher accuracy by dispensing with the requirement of
maintaining a bound, and indeed Minka and Lafferty (2002) have shown that improved inferential
accuracy can be obtained for the LDA model via a higher-order variational technique known as ex-
pectation propagation. Finally, Grifths and Steyvers (2002) have presented a Markov chain Monte
Carlo algorithm for LDA.

LDA is a simple model, and although we view it as a competitor to methods such as LSI and
pLSI in the setting of dimensionality reduction for document collections and other discrete cor-
pora, it is also intended to be illustrative of the way in which probabilistic models can be scaled
up to provide useful inferential machinery in domains involving multiple levels of structure. In-
deed, the principal advantages of generative models such as LDA include their modularity and their
extensibility. As a probabilistic module, LDA can be readily embedded in a more complex model
a property that is not possessed by LSI. In recent work we have used pairs of LDA modules to
model relationships between images and their corresponding descriptive captions (Blei and Jordan,
2002). Moreover, there are numerous possible extensions of LDA. For example, LDA is readily
extended to continuous data or other non-multinomial data. As is the case for other mixture models,
including nite mixture models and hidden Markov models, the emission probability p(wnj zn)
contributes only a likelihood value to the inference procedures for LDA, and other likelihoods are
readily substituted in its place. In particular, it is straightforward to develop a continuous variant of
LDA in which Gaussian observables are used in place of multinomials. Another simple extension
of LDA comes from allowing mixtures of Dirichlet distributions in the place of the single Dirichlet
of LDA. This allows a richer structure in the latent topic space and in particular allows a form of
document clustering that is different from the clustering that is achieved via shared topics. Finally,
a variety of extensions of LDA can be considered in which the distributions on the topic variables
are elaborated. For example, we could arrange the topics in a time series, essentially relaxing the
full exchangeability assumption to one of partial exchangeability. We could also consider partially
exchangeable models in which we condition on exogenous variables; thus, for example, the topic
distribution could be conditioned on features such as paragraph or sentence, providing a more
powerful text model that makes use of information obtained from a parser.

Acknowledgements

This work was supported by the National Science Foundation (NSF grant IIS-9988642) and the
Multidisciplinary Research Program of the Department of Defense (MURI N00014-00-1-0637).
Andrew Y. Ng and David M. Blei were additionally supported by fellowships from the Microsoft
Corporation.

