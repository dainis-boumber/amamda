Summary. We propose the elastic net, a new regularization and variable selection method. Real
world data and a simulation study show that the elastic net often outperforms the lasso, while
enjoying a similar sparsity of representation. In addition, the elastic net encourages a grouping
effect, where strongly correlated predictors tend to be in or out of the model together.The elastic
net is particularly useful when the number of predictors (p) is much bigger than the number of
observations (n). By contrast, the lasso is not a very satisfactory variable selection method in the
p(cid:1) n case. An algorithm called LARS-EN is proposed for computing elastic net regularization
paths efciently, much like algorithm LARS does for the lasso.
Keywords: Grouping effect; LARS algorithm; Lasso; Penalization; p(cid:1) n problem; Variable
selection

Introduction and motivation

1.
We consider the usual linear regression model: given p predictors x1, . . . , xp, the response y is
predicted by

y= 0 + x1 1 + . . . + xp p:

.1/
A model tting procedure produces the vector of coefcients = . 0, . . . , p/. For example, the
ordinary least squares (OLS) estimates are obtained by minimizing the residual sum of squares.
The criteria for evaluating the quality of a model will differ according to the circumstances.
Typically the following two aspects are important:

(a) accuracy of prediction on future datait is difcult to defend a model that predicts

poorly;

(b) interpretation of the modelscientists prefer a simpler model because it puts more light
on the relationship between the response and covariates. Parsimony is especially an impor-
tant issue when the number of predictors is large.

It is well known that OLS often does poorly in both prediction and interpretation. Penaliza-
tion techniques have been proposed to improve OLS. For example, ridge regression (Hoerl and
Kennard, 1988) minimizes the residual sum of squares subject to a bound on the L2-norm of the
coefcients. As a continuous shrinkage method, ridge regression achieves its better prediction
performance through a biasvariance trade-off. However, ridge regression cannot produce a
parsimonious model, for it always keeps all the predictors in the model. Best subset selection in

Address for correspondence: Trevor Hastie, Department of Statistics, Stanford University, Stanford, CA 94305,

USA.
E-mail: hastie@stanford.edu
 2005 Royal Statistical Society

13697412/05/67301

302

H. Zou and T. Hastie

contrast produces a sparse model, but it is extremely variable because of its inherent discreteness,
as addressed by Breiman (1996).

A promising technique called the lasso was proposed by Tibshirani (1996). The lasso is a
penalized least squares method imposing an L1-penalty on the regression coefcients. Owing
to the nature of the L1-penalty, the lasso does both continuous shrinkage and automatic vari-
able selection simultaneously. Tibshirani (1996) and Fu (1998) compared the prediction per-
formance of the lasso, ridge and bridge regression (Frank and Friedman, 1993) and found
that none of them uniformly dominates the other two. However, as variable selection becomes
increasingly important in modern data analysis, the lasso is much more appealing owing to its
sparse representation.

Although the lasso has shown success in many situations, it has some limitations. Consider

the following three scenarios.

(a) In the p > n case, the lasso selects at most n variables before it saturates, because of the
nature of the convex optimization problem. This seems to be a limiting feature for a
variable selection method. Moreover, the lasso is not well dened unless the bound on
the L1-norm of the coefcients is smaller than a certain value.

(b) If there is a group of variables among which the pairwise correlations are very high, then
the lasso tends to select only one variable from the group and does not care which one is
selected. See Section 2.3.

(c) For usual n > p situations, if there are high correlations between predictors, it has been
empirically observed that the prediction performance of the lasso is dominated by ridge
regression (Tibshirani, 1996).

Scenarios (a) and (b) make the lasso an inappropriate variable selection method in some sit-
uations. We illustrate our points by considering the gene selection problem in microarray data
analysis. A typical microarray data set has many thousands of predictors (genes) and often
fewer than 100 samples. For those genes sharing the same biological pathway, the correlations
between them can be high (Segal and Conklin, 2003). We think of those genes as forming a
group. The ideal gene selection method should be able to do two things: eliminate the trivial
genes and automatically include whole groups into the model once one gene among them is
selected (grouped selection). For this kind of p(cid:1) n and grouped variables situation, the lasso
is not the ideal method, because it can only select at most n variables out of p candidates (Efron
et al., 2004), and it lacks the ability to reveal the grouping information. As for prediction per-
formance, scenario (c) is not rare in regression problems. So it is possible to strengthen further
the prediction power of the lasso.

Our goal is to nd a new method that works as well as the lasso whenever the lasso does the
best, and can x the problems that were highlighted above, i.e. it should mimic the ideal variable
selection method in scenarios (a) and (b), especially with microarray data, and it should deliver
better prediction performance than the lasso in scenario (c).

In this paper we propose a new regularization technique which we call the elastic net. Similar
to the lasso, the elastic net simultaneously does automatic variable selection and continuous
shrinkage, and it can select groups of correlated variables. It is like a stretchable shing net that
retains all the big sh. Simulation studies and real data examples show that the elastic net often
outperforms the lasso in terms of prediction accuracy.

In Section 2 we dene the nave elastic net, which is a penalized least squares method using a
novel elastic net penalty. We discuss the grouping effect that is caused by the elastic net penalty.
In Section 3, we show that this nave procedure tends to overshrink in regression problems. We
then introduce the elastic net, which corrects this problem. An efcient algorithm LARS-EN is

proposed for computing the entire elastic net regularization paths with the computational effort
of a single OLS t. Prostate cancer data are used to illustrate our methodology in Section 4,
and simulation results comparing the lasso and the elastic net are presented in Section 5.
Section 6 shows an application of the elastic net to classication and gene selection in a leukae-
mia microarray problem.

Elastic Net

303

2. Nave elastic net

2.1. Denition
Suppose that the data set has n observations with p predictors. Let y = .y1, . . . , yn/T be the
response and X= .x1|. . .|xp/ be the model matrix, where xj = .x1j, . . . , xnj/T, j = 1, . . . , p, are
the predictors. After a location and scale transformation, we can assume that the response is
centred and the predictors are standardized,

xij = 0

and

ij = 1,
x2

for j = 1, 2, . . . , p:

n(cid:1)
i=1

yi = 0,

n(cid:1)
i=1

n(cid:1)
i=1

.2/

.3/

For any xed non-negative 1 and 2, we dene the nave elastic net criterion

L.1, 2, /=|y X|2 + 2||2 + 1||1,

where

||2 = p(cid:1)
||1 = p(cid:1)

j=1

j=1

2
j ,

|j|:

The nave elastic net estimator  is the minimizer of equation (3):

.4/
This procedure can be viewed as a penalized least squares method. Let = 2=.1 + 2/; then
solving  in equation (3) is equivalent to the optimization problem



= arg min

{L.1, 2, /}:



|y X|2,

= arg min

subject to .1 /||1 + ||2 (cid:1) t for some t:

.5/
We call the function .1 /||1 + ||2 the elastic net penalty, which is a convex combination
of the lasso and ridge penalty. When = 1, the nave elastic net becomes simple ridge regression.
In this paper, we consider only  < 1. For all  [0, 1/, the elastic net penalty function is singular
(without rst derivative) at 0 and it is strictly convex for all  > 0, thus having the characteristics
of both the lasso and ridge regression. Note that the lasso penalty (= 0) is convex but not
strictly convex. These arguments can be seen clearly from Fig. 1.

2.2. Solution
We now develop a method to solve the nave elastic net problem efciently. It turns out that
minimizing equation (3) is equivalent to a lasso-type optimization problem. This fact implies
that the nave elastic net also enjoys the computational advantage of the lasso.

304

H. Zou and T. Hastie

2

1

Fig. 1. Two-dimensional contour plots (level 1) ((cid:2) - (cid:2) - (cid:2) -, shape of the ridge penalty; -------, contour of the
, contour of the elastic net penalty with D 0:5): we see that singularities at the vertices
lasso penalty;
and the edges are strictly convex; the strength of convexity varies with 

Lemma 1. Given data set .y, X/ and .1, 2/, dene an articial data set .y, X/ by

X

.n+p/p

= .1+ 2/1=2

.n+p/ =
y

(cid:2)

(cid:3)

,

X
2I

.1+ 2/ and  =

.1+ 2/. Then the nave elastic net criterion can be written

L., /= L., /=(cid:4)(cid:4)y  X(cid:4)(cid:4)2 + 

(cid:4)(cid:4)(cid:4)(cid:4)

(cid:3)

:

y
0

(cid:2)

:

1



Let  = 1=
as

Let

then



 = arg min

 

L{., /};

=

1
.1+ 2/



:



The proof is just simple algebra, which we omit. Lemma 1 says that we can transform the nave
elastic net problem into an equivalent lasso problem on augmented data. Note that the sample
size in the augmented problem is n+ p and X has rank p, which means that the nave elastic
net can potentially select all p predictors in all situations. This important property overcomes
the limitations of the lasso that were described in scenario (a). Lemma 1 also shows that the
nave elastic net can perform an automatic variable selection in a fashion similar to the lasso. In
the next section we show that the nave elastic net has the ability of selecting grouped variables,
a property that is not shared by the lasso.

Elastic Net

305

^



Fig. 2. Exact solutions for the lasso (------- ), ridge regression ((cid:2) - (cid:2) - (cid:2) -) and the nave elastic net (
in an orthogonal design (. . . . . . ., OLS): the shrinkage parameters are 1 D 2 and 2 D 1

)

In the case of an orthogonal design, it is straightforward to show that with parameters .1, 2/

the nave elastic net solution is

i.nave elastic net/= .| i.OLS/| 1=2/+

sgn{ i.OLS/},

.6/
where .OLS/= XTy and z+ denotes the positive part, which is z if z > 0 and 0 otherwise. The
solution of ridge regression with parameter 2 is given by .ridge/= .OLS/=.1+ 2/, and the
lasso solution with parameter 1 is

1+ 2

i.lasso/= .| i.OLS/| 1=2/+ sgn{ i.OLS/}:

Fig. 2 shows the operational characteristics of the three penalization methods in an orthogonal
design, where the nave elastic net can be viewed as a two-stage procedure: a ridge-type direct
shrinkage followed by a lasso-type thresholding.

2.3. The grouping effect
In the large p, small n problem (West et al., 2001), the grouped variables situation is a partic-
ularly important concern, which has been addressed many times in the literature. For example,
principal component analysis has been used to construct methods for nding a set of highly
correlated genes in Hastie et al. (2000) and Daz-Uriarte (2003). Tree harvesting (Hastie et al.,
2003) uses supervised learning methods to select groups of predictive genes found by hierar-
chical clustering. Using an algorithmic approach, Dettling and Buhlmann (2004) performed
the clustering and supervised learning together. A careful study by Segal and Conklin (2003)
strongly motivates the use of a regularized regression procedure to nd the grouped genes. We
consider the generic penalization method

306

H. Zou and T. Hastie

where J./ is positive valued for (cid:4)= 0.

= arg min

|y X|2 +  J./

.7/



Qualitatively speaking, a regression method exhibits the grouping effect if the regression
coefcients of a group of highly correlated variables tend to be equal (up to a change of sign if
negatively correlated). In particular, in the extreme situation where some variables are exactly
identical, the regression method should assign identical coefcients to the identical variables.
Lemma 2. Assume that xi = xj, i, j {1, . . . , p}.
(a) If J./ is strictly convex, then i = j,  > 0.
(b) If J./=||1, then i j (cid:2) 0 and 

is another minimizer of equation (7), where




 k
. i + j/ .s/
. i + j/ .1 s/

if k(cid:4)= i and k(cid:4)= j,
if k= i,
if k= j,



k =



for any s [0, 1].

Lemma 2 shows a clear distinction between strictly convex penalty functions and the lasso
penalty. Strict convexity guarantees the grouping effect in the extreme situation with identical
predictors. In contrast the lasso does not even have a unique solution. The elastic net penalty
with 2 > 0 is strictly convex, thus enjoying the property in assertion (1).

Theorem 1. Given data .y, X/ and parameters .1, 2/, the response y is centred and the
predictors X are standardized. Let .1, 2/ be the nave elastic net estimate. Suppose that
i.1, 2/ j.1, 2/ > 0. Dene

D1,2

.i, j/= 1
|y|1

| i.1, 2/ j.1, 2/|;

then

D1,2

.i, j/(cid:1) 1
2

{2.1 /},

where = xT
The unitless quantity D1,2

i xj, the sample correlation.

.i, j/ describes the difference between the coefcient paths of
:=1 then consider xj),
predictors i and j. If xi and xj are highly correlated, i.e. 
theorem 1 says that the difference between the coefcient paths of predictor i and predictor j is
almost 0. The upper bound in the above inequality provides a quantitative description for the
grouping effect of the nave elastic net.

:= 1 (if 

The lasso does not have the grouping effect. Scenario (b) in Section 1 occurs frequently in
practice. A theoretical explanation is given in Efron et al. (2004). For a simpler illustration,
let us consider the linear model with p= 2. Tibshirani (1996) gave the explicit expression for
. 1, 2/, from which we easily obtain that | 1  2|=| cos./|, where  is the angle between y
and x1  x2. It is easy to construct examples such that = corr.x1, x2/ 1 but cos./ does not
vanish.

2.4. Bayesian connections and the Lq-penalty
|j|q in equa-
Bridge regression (Frank and Friedman, 1993; Fu, 1998) has J./=||q
tion (7), which is a generalization of both the lasso (q = 1) and ridge regression (q = 2). The

q = p
j=1

Elastic Net

307

bridge estimator can be viewed as the Bayes posterior mode under the prior

.8/
Ridge regression (q= 2) corresponds to a Gaussian prior and the lasso (q= 1) a Laplacian (or
double-exponential) prior. The elastic net penalty corresponds to a new prior given by

p,q./= C., q/ exp.||q
q/:

p,./= C., / exp[{||2 + .1 /||1}],

.9/

a compromise between the Gaussian and Laplacian priors. Although bridge regression with
1 < q < 2 will have many similarities with the elastic net, there is a fundamental difference
between them. The elastic net produces sparse solutions, whereas bridge regression does not.
Fan and Li (2001) proved that, in the Lq (q (cid:2) 1) penalty family, only the lasso penalty (q= 1)
can produce a sparse solution. Bridge regression (1 < q < 2) always keeps all predictors in the
model, as does ridge regression. Since automatic variable selection via penalization is a primary
objective of this paper, Lq (1 < q < 2) penalization is not a candidate.

3. Elastic net

3.1. Deciency of the nave elastic net
As an automatic variable selection method, the nave elastic net overcomes the limitations of
the lasso in scenarios (a) and (b). However, empirical evidence (see Sections 4 and 5) shows
that the nave elastic net does not perform satisfactorily unless it is very close to either ridge
regression or the lasso. This is why we call it nave.

In the regression prediction setting, an accurate penalization method achieves good pre-
diction performance through the biasvariance trade-off. The nave elastic net estimator is a
two-stage procedure: for each xed 2 we rst nd the ridge regression coefcients, and then
we do the lasso-type shrinkage along the lasso coefcient solution paths. It appears to incur
a double amount of shrinkage. Double shrinkage does not help to reduce the variances much
and introduces unnecessary extra bias, compared with pure lasso or ridge shrinkage. In the next
section we improve the prediction performance of the nave elastic net by correcting this double
shrinkage.

3.2. The elastic net estimate
We follow the notation in Section 2.2. Given data .y, X/, penalty parameter .1, 2/ and aug-
mented data .y, X/, the nave elastic net solves a lasso-type problem
||1:

|y  X|2 +

 = arg min

.10/



1
.1+ 2/

 

The elastic net (corrected) estimates  are dened by
.elastic net/=
.1+ 2/} 

Recall that .nave elastic net/={1=





.1+ 2/ 
; thus



:

.elastic net/= .1+ 2/ .nave elastic net/:

.11/

.12/

Hence the elastic net coefcient is a rescaled nave elastic net coefcient.

Such a scaling transformation preserves the variable selection property of the nave elastic
net and is the simplest way to undo shrinkage. Hence all the good properties of the nave elastic

308

H. Zou and T. Hastie

net that were described in Section 2 hold for the elastic net. Empirically we have found that the
elastic net performs very well when compared with the lasso and ridge regression.
We have another justication for choosing 1+ 2 as the scaling factor. Consider the exact
solution of the nave elastic net when the predictors are orthogonal. The lasso is known to be
minimax optimal (Donoho et al., 1995) in this case, which implies that the nave elastic net is
not optimal. After scaling by 1+ 2, the elastic net automatically achieves minimax optimality.
A strong motivation for the .1 + 2/-rescaling comes from a decomposition of the ridge
operator. Since the predictors X are standardized, we have


 1 12

1

XTX=




1p




1 p1, p

,

1

pp

where i,j is sample correlation. Ridge estimates with parameter 2 are given by .ridge/= Ry,
with

R= .XTX+ 2I/1XT:

We can rewrite R as

R= 1
1+ 2

R = 1
1+ 2

1




12
1+ 2
1



1

1




XT:

.13/

1p
1+ 2

p1, p
1+ 2
1

R is like the usual OLS operator except that the correlations are shrunk by the factor 1=.1+ 2/,
which we call decorrelation. Hence from equation (13) we can interpret the ridge operator as
decorrelation followed by direct scaling shrinkage.

This decomposition suggests that the grouping effect of ridge regression is caused by the
decorrelation step. When we combine the grouping effect of ridge regression with the lasso,
the direct 1=.1+ 2/ shrinkage step is not needed and is removed by rescaling. Although ridge
regression requires 1=.1+ 2/ shrinkage to control the estimation variance effectively, in our
new method, we can rely on the lasso shrinkage to control the variance and to obtain sparsity.
From now on, let  stand for .elastic net/. The next theorem gives another presentation of

the elastic net, in which the decorrelation argument is more explicit.

Theorem 2. Given data .y, X/ and .1, 2/, then the elastic net estimates  are given by

(cid:2)

(cid:3)

= arg min



T

XTX+ 2I
1+ 2

 2yTX+ 1 ||1:

.14/

It is easy to see that

.lasso/= arg min

T.XTX/ 2yTX+ 1 ||1:

.15/
Hence theorem 2 interprets the elastic net as a stabilized version of the lasso. Note that = XTX
is a sample version of the correlation matrix  and



XTX+ 2I
1+ 2

= .1 / + I

309
with  = 2=.1+ 2/ shrinks  towards the identity matrix. Together equations (14) and (15)
say that rescaling after the elastic net penalization is mathematically equivalent to replacing 
with its shrunken version in the lasso. In linear discriminant analysis, the prediction accuracy
can often be improved by replacing  by a shrunken estimate (Friedman, 1989; Hastie et al.,
2001). Likewise we improve the lasso by regularizing  in equation (15).

Elastic Net

3.3. Connections with univariate soft thresholding
The lasso is a special case of the elastic net with 2 = 0. The other interesting special case of the
elastic net emerges when 2 . By theorem 2,  ./ as 2 , where

T 2yTX+ 1 ||1:

./= arg min
(cid:3)
(cid:2)
./ has a simple closed form



./i =

|yTxi| 1
2

i= 1, 2, . . . , p:

.16/
Observe that yTxi is the univariate regression coefcient of the ith predictor and ./ are the
estimates by applying soft thresholding on univariate regression coefcients; thus equation (16)
is called univariate soft thresholding (UST).

+

sgn.yTxi/,

UST totally ignores the dependence between predictors and treats them as independent vari-
ables. Although this may be considered illegitimate, UST and its variants are used in other meth-
ods such as signicance analysis of microarrays (Tusher et al., 2001) and the nearest shrunken
centroids classier (Tibshirani et al., 2002), and have shown good empirical performance. The
elastic net naturally bridges the lasso and UST.

3.4. Computation: the algorithm LARS-EN
We propose an efcient algorithm called LARS-EN to solve the elastic net efciently, which is
based on the recently proposed algorithm LARS of Efron et al. (2004). They proved that, starting
from zero, the lasso solution paths grow piecewise linearly in a predictable way. They proposed
a new algorithm called LARS to solve the entire lasso solution path efciently by using the same
order of computations as a single OLS t. By lemma 1, for each xed 2 the elastic net problem
is equivalent to a lasso problem on the augmented data set. So algorithm LARS can be directly
used to create the entire elastic net solution path efciently with the computational efforts of a
single OLS t. Note, however, that for p(cid:1) n the augmented data set has p+ n observations
and p variables, which can slow the computation considerably.
We further facilitate the computation by taking advantage of the sparse structure of X,
which is crucial in the p(cid:1) n case. In detail, as outlined in Efron et al. (2004), at the kth step
we need to invert the matrix GAk
Ak , where Ak is the active variable set. This is done
efciently by updating or downdating the Cholesky factorization of GAk1 that is found at the
previous step. Note that

= XT

X

Ak

GA = 1
1+ 2

.XT

AXA + 2I/

Ak1

XAk1

for any index set A, so it amounts to updating or downdating the Cholesky factorization of
+ 2I. It turns out that we can use a simple formula to update the Cholesky fac-
XT
+ 2I, which is very similar to the formula that is used for updat-
torization of XT
XAk1 (Golub and Van Loan, 1983). The exact same
ing the Cholesky factorization of XT

XAk1

Ak1

Ak1

H. Zou and T. Hastie

310
+
downdating function can be used for downdating the Cholesky factorization of XT
2I. In addition, when calculating the equiangular vector and the inner products of the non-
active predictors with the current residuals, we can save computations by using the simple fact
j has p  1 zero elements. In a word, we do not explicitly use X to compute all the
that X
quantities in algorithm LARS. It is also economical to record only the non-zero coefcients and
the active variables set at each LARS-EN step.
Algorithm LARS-EN sequentially updates the elastic net ts. In the p (cid:1) n case, such as
with microarray data, it is not necessary to run the algorithm to the end (early stopping). Real
data and simulated computational experiments show that the optimal results are achieved at
an early stage of algorithm LARS-EN. If we stop the algorithm after m steps, then it requires
O.m3 + pm2/ operations.

XAk1

Ak1



3.5. Choice of tuning parameters
We now discuss how to choose the type and value of the tuning parameter in the elastic
net. Although we dened the elastic net by using .1, 2/, it is not the only choice as the
tuning parameter. In the lasso, the conventional tuning parameter is the L1-norm of the
coefcients (t) or the fraction of the L1-norm (s). By the proportional relationship between
 and 
, we can also use .2, s/ or .2, t/ to parameterize the elastic net. The advantage
of using .2, s/ is that s is always valued within [0, 1]. In algorithm LARS the lasso is des-
cribed as a forward stagewise additive tting procedure and shown to be (almost) identical to
"-L2 boosting (Efron et al., 2004). This new view adopts the number of steps k of algorithm
LARS as a tuning parameter for the lasso. For each xed 2, the elastic net is solved by our
algorithm LARS-EN; hence similarly we can use the number of the LARS-EN steps .k/ as
the second tuning parameter besides 2. The above three types of tuning parameter corres-
pond to three ways to interpret the piecewise elastic net or lasso solution paths as shown in
Fig. 3.

There are well-established methods for choosing such tuning parameters (Hastie et al. (2001),
chapter 7). If only training data are available, tenfold cross-validation (CV) is a popular method
for estimating the prediction error and comparing different models, and we use it here. Note
that there are two tuning parameters in the elastic net, so we need to cross-validate on a
two-dimensional surface. Typically we rst pick a (relatively small) grid of values for 2, say
.0, 0:01, 0:1, 1, 10, 100/. Then, for each 2, algorithm LARS-EN produces the entire solution
path of the elastic net. The other tuning parameter (1, s or k) is selected by tenfold CV. The
chosen 2 is the one giving the smallest CV error.
For each 2, the computational cost of tenfold CV is the same as 10 OLS ts. Thus two-
dimensional CV is computationally thrifty in the usual n > p setting. In the p(cid:1) n case, the
cost grows linearly with p and is still manageable. Practically, early stopping is used to ease the
computational burden. For example, suppose that n= 30 and p= 5000; if we do not want more
than 200 variables in the nal model, we may stop algorithm LARS-EN after 500 steps and
consider only the best k within 500.

From now on we drop the subscript of 2 if s or k is the other parameter.

4. Prostate cancer example

The data in this example come from a study of prostate cancer (Stamey et al., 1989). The predic-
tors are eight clinical measures: log(cancer volume) (lcavol), log(prostate weight) (lweight), age,
the logarithm of the amount of benign prostatic hyperplasia (lbph), seminal vesicle invasion

Elastic Net

311

lcavol

svi

lcp

lweight
pgg45

gleason

lbph
age

8

6

s
t

i

n
e
c
i
f
f

4

i



e
o
C
d
e
z
d
r
a
d
n
a
S

t

2

0

2


0.0

0.2

8

6

s
t

i

n
e
c
i
f
f

4

i



e
o
C
d
e
z
d
r
a
d
n
a
S

t

2

0

2


lcavol

svi

lweight
pgg45

lbph

gleason

age

lcp

0.8

1.0

0.0

0.2

0.4
|
|
s =  beta /max beta

0.6
|

|
(a)

0.6

0.4
|
s =  beta /max beta

|

|

|
(b)

0.8

1.0

(a) Lasso estimates as a function of s and (b) elastic net estimates (D 1000) as a function of s:
Fig. 3.
both estimates are piecewise linear, which is a key property of our efcient algorithm; the solution paths also

show that the elastic net is identical to univariate soft thresholding in this example (
, nal model selected)

(svi), log(capsular penetration) (lcp), Gleason score (gleason) and percentage Gleason score 4
or 5 (pgg45). The response is the logarithm of prostate-specic antigen (lpsa).

OLS, ridge regression, the lasso, the nave elastic net and the elastic net were all applied to
these data. The prostate cancer data were divided into two parts: a training set with 67 obser-
vations and a test set with 30 observations. Model tting and tuning parameter selection by
tenfold CV were carried out on the training data. We then compared the performance of those
methods by computing their prediction mean-squared error on the test data.

Table 1 clearly shows that the elastic net is the winner among all the competitors in terms
of both prediction accuracy and sparsity. OLS is the worst method. The nave elastic net per-
forms identically to ridge regression in this example and fails to do variable selection. The lasso
includes lcavol, lweight lbph, svi and pgg45 in the nal model, whereas the elastic net selects

Table 1. Prostate cancer data: comparing different methods

Method

Parameter(s)

Test mean-squared error

Variables selected

OLS
Ridge regression
Lasso
Nave elastic net
Elastic net

= 1
s= 0:39
= 1, s= 1
= 1000, s= 0:26

0.586 (0.184)
0.566 (0.188)
0.499 (0.161)
0.566 (0.188)
0.381 (0.105)

All
All

All

(1,2,4,5,8)

(1,2,5,6,8)

312

H. Zou and T. Hastie

lcavol, lweight, svi, lcp and pgg45. The prediction error of the elastic net is about 24% lower
than that of the lasso. We also see in this case that the elastic net is actually UST, because the 
selected is very big (1000). This can be considered as a piece of empirical evidence supporting
UST. Fig. 3 displays the lasso and the elastic net solution paths.

If we check the correlation matrix of these eight predictors, we see that there are some medium
correlations, although the highest is 0.76 (between pgg45 and gleason). We have seen that the
elastic net dominates the lasso by a good margin. In other words, the lasso is hurt by the high
correlation. We conjecture that, whenever ridge regression improves on OLS, the elastic net will
improve the lasso. We demonstrate this point by simulations in the next section.

5. A simulation study

The purpose of this simulation is to show that the elastic net not only dominates the lasso in
terms of prediction accuracy but also is a better variable selection procedure than the lasso. We
simulate data from the true model

y= X+ ",

" N.0, 1/:

Four examples are presented here. The rst three examples were used in the original lasso paper
(Tibshirani, 1996), to compare the prediction performance of the lasso and ridge regression
systematically. The fourth example creates a grouped variable situation.

Within each example, our simulated data consist of a training set, an independent validation
set and an independent test set. Models were tted on training data only, and the validation
data were used to select the tuning parameters. We computed the test error (the mean-squared
error) on the test data set. We use the notation = = to describe the number of observations in
the training, validation and test set respectively, e.g. 20/20/200. Here are the details of the four
scenarios.

(a) In example 1, we simulated 50 data sets consisting of 20/20/200 observations and eight
predictors. We let  = .3, 1:5, 0, 0, 2, 0, 0, 0/ and  = 3. The pairwise correlation between
xi and xj was set to be corr.i, j/= 0:5|ij|.

(b) Example 2 is the same as example 1, except that j = 0:85 for all j.
(c) In example 3, we simulated 50 data sets consisting of 100/100/400 observations and 40

predictors. We set

(cid:14) (cid:15)(cid:16) (cid:17)
and  = 15; corr.i, j/= 0:5 for all i and j.

(cid:14) (cid:15)(cid:16) (cid:17)
= .0, . . . , 0

, 2, . . . , 2

10

10

(cid:14) (cid:15)(cid:16) (cid:17)

, 0, . . . , 0

(cid:14) (cid:15)(cid:16) (cid:17)

, 2, . . . , 2

/

10

10

(d) In example 4 we simulated 50 data sets consisting of 50/50/400 observations and 40 pre-

dictors. We chose

(cid:14) (cid:15)(cid:16) (cid:17)
= .3, . . . , 3

(cid:14) (cid:15)(cid:16) (cid:17)

, 0, . . . , 0

/

and  = 15. The predictors X were generated as follows:

15

25

xi = Z1 + "x
xi = Z2 + "x
xi = Z3 + "x
xi independent identically distributed,

i , Z1  N.0, 1/,
i , Z2  N.0, 1/,
i , Z3  N.0, 1/,

i= 1, . . . , 5,
i= 6, . . . , 10,
i= 11, . . . , 15,

i= 16, : : : , 40,

xi  N.0, 1/,

Elastic Net

313

Table 2. Median mean-squared errors for the simulated examples and
four methods based on 50 replications

Method

Results for the following examples:

Example 1

Example 2

Example 3

Example 4

Lasso
Elastic net
Ridge regression
Nave elastic net

3.06 (0.31)
2.51 (0.29)
4.49 (0.46)
5.70 (0.41)

3.87 (0.38)
3.16 (0.27)
2.84 (0.27)
2.73 (0.23)

65.0 (2.82)
56.6 (1.75)
39.5 (1.80)
41.0 (2.13)

46.6 (3.96)
34.5 (1.64)
64.5 (4.78)
45.9 (3.72)

The numbers in parentheses are the corresponding standard errors (of the
medians) estimated by using the bootstrap with B= 500 resamplings on the
50 mean-squared errors.
i are independent identically distributed N.0, 0:01/, i= 1, : : : , 15: In this model,
where "x
we have three equally important groups, and within each group there are ve members.
There are also 25 pure noise features. An ideal method would select only the 15 true
features and set the coefcients of the 25 noise features to 0.

Table 2 and Fig. 4 (box plots) summarize the prediction results. First we see that the nave
elastic net either has a very poor performance (in example 1) or behaves almost identically to
either ridge regression (in examples 2 and 3) or the lasso (in example 4). In all the examples, the
elastic net is signicantly more accurate than the lasso, even when the lasso is doing much better
than ridge regression. The reductions in the prediction error in examples 1, 2, 3 and 4 are 18%,
18%, 13% and 27% respectively. The simulation results indicate that the elastic net dominates
the lasso under collinearity.

Table 3 shows that the elastic net produces sparse solutions. The elastic net tends to select
more variables than the lasso does, owing to the grouping effect. In example 4 where grouped
selection is required, the elastic net behaves like the oracle. The additional grouped selection
ability makes the elastic net a better variable selection method than the lasso.

Here is an idealized example showing the important differences between the elastic net and
the lasso. Let Z1 and Z2 be two independent U.0, 20/ variables. The response y is generated as
N.Z1 + 0:1Z2, 1/. Suppose that we observe only

x1 = Z1 + "1,
x4 = Z2 + "4,

x2 =Z1 + "2,
x5 =Z2 + "5,

x3 = Z1 + "3,
x6 = Z2 + "6,

where "i are independent identically distributed N.0, 1=16/. 100 observations were generated
from this model. The variables x1, x2 and x3 form a group whose underlying factor is Z1, and
x4, x5 and x6 form a second group whose underlying factor is Z2. The within-group correla-
tions are almost 1 and the between-group correlations are almost 0. An oracle would identify
the Z1-group as the important variates. Fig. 5 compares the solution paths of the lasso and the
elastic net.

6. Microarray classication and gene selection

A typical microarray data set has thousands of genes and fewer than 100 samples. Because of
the unique structure of the microarray data, we feel that a good classication method should
have the following properties.

314

H. Zou and T. Hastie

E
S
M

E
S
M

5
1

0
1

5

0

0
4
1

0
2
1

0
0
1

0
8

0
6

0
4

0
2

5
1

0
1

E
S
M

5

Lasso Enet

Ridge NEnet

Lasso Enet Ridge NEnet

(a)

(b)

0
5
1

0
0
1

E
S
M

0
5

0

Lasso Enet Ridge NEnet

Lasso Enet Ridge NEnet

(c)

(d)

Fig. 4. Comparing the accuracy of prediction of the lasso, the elasic net (Enet), ridge regression and
the nave elastic net (NEnet) (the elastic net outperforms the lasso in all four examples): (a) example 1;
(b) example 2; (c) example 3; (d) example 4

(a) Gene selection should be built into the procedure.
(b) It should not be limited by the fact that p(cid:1) n.
(c) For those genes sharing the same biological pathway, it should be able to include whole

groups into the model automatically once one gene among them is selected.

From published results in this domain, it appears that many classiers achieve similar low
classication error rates. But many of these methods do not select genes in a satisfactory way.
Most of the popular classiers fail with respect to at least one of the above properties. The
lasso is good at (a) but fails both (b) and (c). The support vector machine (Guyon et al., 2002)
and penalized logistic regression (Zhu and Hastie, 2004) are very successful classiers, but they
cannot do gene selection automatically and both use either univariate ranking (Golub et al.,

Elastic Net

315

Table 3. Median number of non-zero coefcients

Method

Results for the following examples:

Example 1

Example 2

Example 3

Example 4

Lasso
Elastic net

5
6

6
7

24
27

11
16

i

s
t
n
e
c
i
f
f
e
o
C

d
e
z
d
r
a
d
n
a
t
S

i

0
4

0
2

0

0
2


0.0

0.2

3

6
5

1

4

2

i

s
t
n
e
c
i
f
f
e
o
C

d
e
z
d
r
a
d
n
a
t
S

i

0
4

0
2

0

0
2


0.8

1.0

0.0

0.2

3
1

4
6

5

2

0.8

1.0

0.4
|
|
s =  beta /max beta

0.6
|

|
(a)

0.4
|

|
s =  beta /max beta

0.6
|

|
(b)

(a) Lasso and (b) elastic net (2 D 0:5) solution paths: the lasso paths are unstable and (a) does
Fig. 5.
not reveal any correction information by itself; in contrast, the elastic net has much smoother solution paths,
while clearly showing the grouped selectionx1, x2 and x3 are in one signicant group and x4, x5 and x6
are in the other trivial group; the decorrelation yields the grouping effect and stabilizes the lasso solution

1999) or recursive feature elimination (Guyon et al., 2002) to reduce the number of genes in the
nal model.
As an automatic variable selection method, the elastic net naturally overcomes the difculty
of p(cid:1) n and has the ability to do grouped selection. We use the leukaemia data to illustrate the
elastic net classier.

The leukaemia data consist of 7129 genes and 72 samples (Golub et al., 1999). In the training
data set, there are 38 samples, among which 27 are type 1 leukaemia (acute lymphoblastic leu-
kaemia) and 11 are type 2 leukaemia (acute myeloid leukaemia). The goal is to construct a
diagnostic rule based on the expression level of those 7219 genes to predict the type of leukae-
mia. The remaining 34 samples are used to test the prediction accuracy of the diagnostic rule. To
apply the elastic net, we rst coded the type of leukaemia as a 01 response y. The classication

H. Zou and T. Hastie

316
function is I.tted value > 0:5/, where I./ is the indicator function. We used tenfold CV to
select the tuning parameters.

We used prescreening to make the computation more manageable. Each time that a model
is tted, we rst select the 1000 most signicant genes as the predictors, according to their
t-statistic scores (Tibshirani et al., 2002). Note that this screening is done separately in each
training fold in the CV. In practice, this screening does not affect the results, because we stop

r
o
r
r



E
n
o

i
t

a
c
i
f
i
s
s
a
c
s
M

i

l

r
o
r
r



E
n
o

i
t

a
c
i
f
i
s
s
a
c
s
M

i

l

4
1

2
1

0
1

8

6

4

2

0

4
1

2
1

0
1

8

6

4

2

0

0

50

150

200

100
steps
(a)

s(steps=200)

= 0.50

0.0

0.2

0.4

0.6

0.8

1.0

s
(b)

Fig. 6. Leukaemia classication and gene selection by the elastic net (D 0:01): (a) the early stopping
strategy at 200 steps nds the optimal classier with much less computational cost than (b) the whole elastic
net paths; with early stopping, the number of steps is much more convenient than s, the fraction of L1-norm,
since computing s depends on the t at the last step of algorithm LARS-EN; the actual values of s are not
available in tenfold CV (+) if the algorithm is stopped early; on the training set, 200 steps are equivalent to
s D 0:50 (


)

Table 4. Summary of the leukaemia classication results

Method

Tenfold CV

error

Test error Number of

genes

Golub
Support vector machingrecursive

feature elimination

Penalized logistic regressionrecursive

feature elimination

Nearest shrunken centroids
Elastic net

3/38
2/38

2/38

2/38
3/38

4/34
1/34

1/34

2/34
0/34

50
31

26

21
45

0

5 10 14 18 22 24 25 30 31 34 37 37 41 41 43 45 45 47 47 52

Elastic Net

317

8

.

0

6
0

.

4

.

0

2

.

0

0

.

0

.

2
0


.

4
0


i

i

s
t
n
e
c
i
f
f
e
o
C

d
e
z
d
r
a
d
n
a
S

t

0

20

40

60

80

100

Fig. 7. Leukaemia dataelastic net coefcients paths (up to kD 100): the numbers on the top indicate the
number of non-zero coefcients (selected genes) at each step; the optimal elastic net model is given by the

t at step 82 (
) with 45 selected genes; note that the size of the training set is 38, so the lasso can at most
select 38 genes; in contrast, the elastic net selected more than 38 genes, not limited by the sample size;
D 0:01 is chosen by tenfold CV; if a bigger  is used, the grouping effect will be stronger

Steps

the elastic net path relatively early, at a stage when the screened variables are unlikely to be in
the model.

All the prescreening, tting and tuning were done using only the training set and the classi-

cation error is evaluated on the test data.
We stopped algorithm LARS-EN after 200 steps. As can be seen from Fig. 6, using the num-
ber of steps k in the algorithm as the tuning parameter, the elastic net classier (= 0:01 and
k = 82) gives a tenfold CV error of 3/38 and a test error of 0/34 with 45 genes selected. Fig. 7
displays the elastic net solution paths and the gene selection results. Table 4 compares the elastic
net with several competitors including Golubs method, the support vector machine, penalized
logistic regression and the nearest shrunken centroid (Tibshirani et al., 2002). The elastic net
gives the best classication, and it has an internal gene selection facility.

7. Discussion

We have proposed the elastic net, a novel shrinkage and selection method. The elastic net pro-
duces a sparse model with good prediction accuracy, while encouraging a grouping effect. The
empirical results and simulations demonstrate the good performance of the elastic net and its
superiority over the lasso. When used as a (two-class) classication method, the elastic net
appears to perform well on microarray data in terms of the misclassication error, and it does
automatic gene selection.

318

H. Zou and T. Hastie

Although our methodology is motivated by regression problems, the elastic net penalty can
be used in classication problems with any consistent (Zhang, 2004) loss functions, including
the L2-loss which we have considered here and binomial deviance. Some nice properties of the
elastic net are better understood in the classication paradigm. For example, Fig. 6 is a familiar
picture in boosting: the test error keeps decreasing and reaches a long at region and then slightly
increases (Hastie et al., 2001). This is no coincidence. In fact we have discovered that the elastic
net penalty has a close connection with the maximum margin explanation (Rosset et al., 2004)
to the success of the support vector machine and boosting. Thus Fig. 6 has a nice margin-based
explanation. We have made some progress in using the elastic net penalty in classication, which
will be reported in a future paper.

We view the elastic net as a generalization of the lasso, which has been shown to be a valuable
tool for model tting and feature extraction. Recently the lasso was used to explain the success of
boosting: boosting performs a high dimensional lasso without explicitly using the lasso penalty
(Hastie et al., 2001; Friedman et al., 2004). Our results offer other insights into the lasso, and
ways to improve it.

Acknowledgements

We thank Rob Tibshirani and Ji Zhu for helpful comments, and an Associate Editor and ref-
