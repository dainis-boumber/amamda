SUMMARY

We propose a new method for estimation in linear models. The 'lasso' minimizes the
residual sum of squares subject to the sum of the absolute value of the coefficients being less
than a  constant. Because of the nature of this constraint it tends to produce some
coefficients that are exactly 0 and hence gives interpretable models. Our simulation studies
suggest that the lasso enjoys some of the favourable properties of both subset selection and
ridge regression. It produces interpretable models like subset selection and exhibits the
stability of ridge regression. There is also an interesting relationship with recent work in
adaptive function estimation by Donoho and Johnstone. The lasso idea is quite general and
can be applied in a variety of statistical models: extensions to generalized regression models
and tree-based models are briefly described.

Keywords: QUADRATIC PROGRAMMING; REGRESSION; SHRINKAGE; SUBSET SELECTION

1.  INTRODUCTION

(x,..

Consider the usual regression situation: we have data (xi, yi), i =  1, 2, . . ., N, where
., xP)T and yi are the regressors and response for the ith observation.
x=
The ordinary least squares (OLS) estimates are obtained by minimizing the residual
squared error. There are two reasons why the data analyst is often not satisfied with
the OLS estimates. The first is prediction accuracy: the OLS estimates often have low
bias but large variance; prediction accuracy can sometimes be improved by shrinking
or setting to 0 some coefficients. By doing so we sacrifice a little bias to reduce the
variance of the predicted values and hence may improve the overall prediction
accuracy. The second reason is interpretation. With a large number of predictors, we
often would like to determine a smaller subset that exhibits the strongest effects.
The two standard techniques for improving the OLS estimates, subset selection
and ridge regression, both have drawbacks. Subset selection provides interpretable
models but can be extremely variable because it is a discrete process -  regressors are
either retained or dropped from the model. Small changes in the data can result in
very different models being selected and this can reduce its prediction accuracy.
Ridge regression is a continuous process that shrinks coefficients and hence is more
stable: however, it does not set any coefficients to 0 and hence does not give an easily
interpretable model.
We propose a new technique, called the lasso, for 'least absolute shrinkage and
selection operator'. It shrinks some coefficients and sets others to 0, and hence tries to
retain the good features of both subset selection and ridge regression.

tAddress for correspondence: Department of Preventive Medicine and Biostatistics, and Department of Statistics,

University of Toronto, 12 Queen's Park Crescent West, Toronto, Ontario, M5S 1A8, Canada.
E-mail: tibs@utstat.toronto.edu
? 1996 Royal Statistical Society

0035-9246/96/58267

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

268

TIBSHIRANI

[No.  1,
In Section 2 we define the lasso and look at some special cases. A real data example is
given in Section 3, while in Section 4 we discuss methods for estimation of prediction error
and the lasso shrinkage parameter. A Bayes model for the lasso is briefly mentioned in
Section 5. We describe the lasso algorithm in Section 6. Simulation studies are described in
Section 7. Sections 8 and 9 discuss extensions to generalized regression models and other
problems. Some results on soft thresholding and their relationship to the lasso are
discussed in Section 10, while Section 11 contains a summary and some discussion.

2.  THE LASSO
2.1.  Definition

Suppose that we have data (xi, yi), i =  1, 2, . . ., N, where xi =  (xi,  ..  . X,  )T are
the predictor variables and yi are the responses. As in the usual regression set-up, we
assume either that the observations are independent or that the yis are conditionally
independent given the xys. We assume that the xy are standardized so that 2ixyl/N

?,  Eix2/N
Letting ,3 =  (PI, . . .,  pp)T, the lasso estimate (&, /3) is defined by

=1.

(&3)=argminf

(Yi-a-L  5  1X)2)}  subject toZlfBll  t.

(1)

Here t > 0 is a tuning parameter. Now, for all t, the solution for a is &  y. We can
assume without loss of generality that j  0 0 and hence omit a.
Computation of the solution to equation (1) is a quadratic programming problem
with linear inequality constraints. We describe some efficient and stable algorithms
for this problem in Section 6.
The parameter t >  0 controls the amount of shrinkage that is a,pplied to the
estimates. Let fl be the full least squares estimates and let to  SIfl.  Values of
t < to will cause shrinkage of the solutions towards 0, and some coefficients may be
exactly equal to 0. For example, if t =  to/2, the effect will be roughly similar to
finding the best subset of size p/2. Note also that the design matrix need not be of full
rank. In Section 4 we give some data-based methods for estimation of t.

The motivation for the lasso came from an interesting proposal of Breiman (1993).

Breiman's non-negative garotte minimizes

N
E

(Yi-  -E

2

x)

subject to Cj >  0,  E  Cj s  t.

(2)

The garotte starts with the OLS estimates and shrinks them by non-negative factors
whose sum is constrained. In extensive simulation studies, Breiman showed that the
garotte has consistently lower prediction error than subset selection and is
competitive with ridge regression except when the true model has many small non-
zero coefficients.

A drawback of the garotte is that its solution depends on both the sign and the
magnitude of the OLS estimates. In overfit or highly correlated settings where the
OLS estimates behave poorly, the garotte may suffer as a result. In contrast, the lasso
avoids the explicit use of the OLS estimates.

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

1996]

REGRESSION SHRINKAGE AND SELECTION

269
Frank and Friedman (1993) proposed using a bound on the Lq-norm of the
parameters, where q is some number greater than or equal to 0; the lasso corresponds
to q = 1. We discuss this briefly in Section 10.

2.2.  Orthonormal Design Case

Insight about the nature of the shrinkage can be gleaned from the orthonormal
design case. Let X be the n x p design matrix with iUth entry xij, and suppose that
XTX = I, the identity matrix.

The solutions to equation (1) are easily shown to be

pf =  sign (1 ) (I6j -j y)I

(3)
where y is determined by the condition 2filjl =  t. Interestingly, this has exactly the
same form as the soft shrinkage proposals of Donoho and Johnstone (1994) and
Donoho et al. (1995), applied to wavelet coefficients in the context of function
estimation. The connection between soft shrinkage and a minimum LI-norm penalty
was also pointed out by Donoho et al. (1992) for non-negative parameters in the
context of signal or image recovery. We elaborate more on this connection in Section
10.
In the orthonormal design case, best subset selection of size k reduces to choosing
in absolute value and setting the rest to 0. For some choice
l  if 1,871 >  X and to 0 otherwise. Ridge

the k largest coefficients
of X this is equivalent to setting fi,
regression minimizes

N

E  Yi -

2

flxyj  +A

2
P,2

or, equivalently, minimizes

?E (Yi-4jx,)

subject to  fi)  <  t

(4)

The ridge solutions are

1  ^

where y depends on X or t. The garotte estimates are

t

P A2  )

t

Fig. 1 shows the fonn of these functions. Ridge regression scales the coefficients by
a constant factor, whereas the lasso translates by a constant factor, truncating at 0.
The garotte function is very similar to the lasso, with less shrinkage for larger
coefficients. As our simulations will show, the differences between the lasso and
garotte can be large when the design is not orthogonal.

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

270

TIBSHIRANI

[No. 1,

2.3.  Geometry of Lasso

It is clear from Fig. 1 why the lasso will often produce coefficients that are exactly
0. Why does this happen in the general (non-orthogonal) setting? And why does it
not occur with ridge regression, which uses the constraint ? fl2 K t rather than
Elpl <  t? Fig. 2 provides some insight for the case p =  2.

6jXij)2 equals the quadratic function

The criterion E1

(y,-

(,3-p

0)  X

( X-

0)

(plus a constant). The elliptical contours of this function are shown by the full curves
in Fig. 2(a); they are centred at the OLS estimates; the constraint region is the rotated
square. The lasso solution is the first place that the contours touch the square, and
this will sometimes occur at a corner, corresponding to a zero coefficient. The picture
for ridge regression is shown in Fig. 2(b): there are no corners for the contours to hit
and hence zero solutions will rarely result.
An interesting question emerges from this picture: can the signs of the lasso
estimates be different from those of the least squares estimates ,j?? Since the variables
are standardized, when p = 2 the principal axes of the contours are at + 450 to the
co-ordinate axes, and we can show that the contours must contact the square in the
same quadrant that contains fi. However, when p > 2 and there is at least moderate
correlation in the data, this need not be true. Fig. 3 shows an example in three
dimensions. The view in Fig. 3(b) confirms that the ellipse touches the constraint
region in an octant different from the octant in which its centre lies.

N

N

LN

o

1

2

3

4

5

0

1

2

3

4

5

beta
(a)

beta
(b)

N

0

1

2

3

4

5

0

1

2

3

4

5

beta
(c)

beta
(d)

Fig. 1.  (a) Subset regression, (b) ridge regression, (c) the lasso and (d) the garotte:
coefficient shrinkage in the orthonormal design case; ..........., 45?-line for reference

, form of

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

1996]

REGRESSION SHRINKAGE AND SELECTION

271

(a)

(b)

Fig. 2.  Estimation picture for (a) the lasso and (b) ridge regression

(a)

lb)

Fig. 3.  (a) Example in which the lasso estimate falls in an octant different from the overall least
squares estimate; (b) overhead view

Whereas the garotte retains the sign of each &, the lasso can change signs. Even in cases
where the lasso estimate has the same sign vector as the garotte, the presence of the OLS
estimates in the garotte can make it behave differently. The modjel E cj,fixy with con-
straint E Cj ^S t can be written as E fi1xy with constraint I fij/j
t. it for example
p =  2 and fil >  2 > 0 then the effect would be to stretch the square in Fig. 2(a)
horizontally. As a result, larger values of PI and smaller values of P2 will be favoured
by the garotte.

0

SupposeX that p = 2, and assume without loss of generality that the least squares

estimates P7 are both positive. Then we can show that the lasso estimates are

2.4.  More on Two-predictor Case

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

272

TIBSHIRANI

[No. 1,

C%J)

2

3

4

5

6

betal

Fig. 4.  Lasso (
) and ridge regression ----)  for the two-predictor example: the curves show the
(P1,  P2)  pairs as the bound on the lasso or ridge parameters is varied; starting with the bottom broken
curve and moving upwards, the correlation p is 0, 0.23, 0.45, 0.68 and 0.90

(5)
where y is chosen so that ,81 + ,82 =  t. This formula holds for t  M l + 820 and is valid
even if the predictors are correlated. Solving for y yields

=  (fO  -  Y)

(2

2

(6)

In contrast, the form of ridge regression shrinkage depends on the correlation of
the predictors. Fig. 4 shows an example. We generated 100 data points from the
model y = 6x1 + 3x2 with no noise. Here xl and x2 are standard normal variates with
correlation p. The curves in Fig. 4 show the ridge and lasso estimates as the bounds
on 216 +  ,22 and 1fl1 I +  1f821 are varied. For all values of p the lasso estimates follow the
full curve. The ridge estimates (broken curves) depend on p. When p = 0 ridge
regression does proportional shrinkage. However, for larger values of p the ridge
and can even increase a little as the bound is
estimates are shrunken differentially
decreased. As pointed out by Jerome Friedman, this is due to the tendency of ridge
regression to try to make the coefficients equal to minimize their squared norm.

2.5.  Standard Errors

Since the lasso estimate is a non-linear and non-differentiable

function of the
response values even for a fixed value of t, it is difficult to obtain an accurate estimate
of its standard error. One approach is via the bootstrap: either t can be fixed or we
may optimize over t for each bootstrap sample. Fixing t is analogous to selecting a
best subset, and then using the least squares standard error for that subset.
An approximate closed form estimate may be derived by writing the penalty Elfilj
as E ,6/lflfI. Hence, at the lasso estimate /, we may approximate the solution by a

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

REGRESSION SHRINKAGE AND SELECTION

1996]
ridge regression of the form /* = (XTX +  W-)-lXTy where W is a diagonal matrix
with diagonal elements lfiil, W- denotes the generalized inverse of W and X is chosen
so that E lI*  -  t. The covariance matrix of the estimates may then be approximated
by

273

(XTX +  XWT)  lXTX(XTX  +  xX-)-152,

(7)
where a2 is an estimate of the error variance. A difficulty with this formula is that it
gives an estimated variance of 0 for predictors with f31 = 0.
This approximation also suggests an iterated ridge regression algorithm for
computing the lasso estimate itself, but this turns out to be quite inefficient. However,
it is useful for selection of the lasso parameter t (Section 4).

3.  EXAMPLE -PROSTATE  CANCER DATA

The prostate cancer data come from a study by Stamey et al. (1989) that examined
the correlation between the level of prostate specific antigen and a number of clinical
measures, in men who were about to receive a radical prostatectomy. The factors
were log(cancer volume) (lcavol), log(prostate weight) (lweight), age, log(benign
prostatic hyperplasia amount) (lbph), seminal vesicle invasion (svi), log(capsular
penetration) (lcp), Gleason score (gleason) and percentage Gleason scores 4 or 5
(pgg45). We fit a linear model to log(prostate specific antigen) (lpsa) after first
standardizing the predictors.

C;

0

e

7

3~~~~~~~~

0.0

0.2

0.4

0.6

0.8

1.0

1.2

Fig. 5.  Lasso shrinkage of coefficients
in the prostate cancer example: each curve represents a
coefficient
(labelled on the right) as a function of the (scaled) lasso parameter s = tIE I &j (the intercept
is not plotted); the broken line represents the model for s^ = 0.44, selected by generalized cross-validation

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

274

TIBSHIRANI

[No.  1,
Fig. 5 shows the lasso estimates as a function of standardized bound s = t/lEl ?I.
Notice that the absolute value of each coefficient tends to 0 as s goes to 0. In t1is
example, the curves decrease in a monotone fashion to 0, but this does not always
happen in general. This lack of monotonicity
is shared by ridge regression and subset
regression, where for example the best subset of size 5 may not contain the best
subset of size 4. The vertical broken line represents the model for s = 0.44, the
optimal value selected by generalized cross-validation. Roughly, this corresponds to
keeping just under half of the predictors.

Table 1 shows the results for the full least squares, best subset and lasso
procedures. Section 7.1 gives the details of the best subset procedure that was used.
The lasso gave non-zero coefficients to lcavol, lweight and svi; subset selection chose
the same three predictors. Notice that the coefficients and Z-scores for the selected
predictors from subset selection tend to be larger than the full model values: this is
common with positively correlated predictors. However, the lasso shows the opposite
effect, as it shrinks the coefficients and Z-scores from their full model values.

The standard errors in the penultimate column were estimated by bootstrap
resampling of residuals from the full least squares fit. The standard errors were
computed by fixing s at its optimal value 0.44 for the original data set. Table 2

Results for the prostate cancer example

TABLE  1

Predictor

Least squares results

Subset selection results

Lasso results

Coefficient Standard  Z-score  Coefficient Standard  Z-score  Coefficient Standard  Z-score

error

error

error

1 intcpt
2 Icavol
3 Iweight
4 age
5 lbph
6 svi
7 lcp
8 gleason
9 pgg45

2.48
0.69
0.23
-0.15
0.16
0.32
-0.15
0.03
0.13

0.07
0.10
0.08
0.08
0.08
0.10
0.13
0.11
0.12

34.46
6.68
2.67
-1.76
1.83
3.14
-1.16
0.29
1.02

2.48
0.65
0.25
0.00
0.00
0.28
0.00
0.00
0.00

0.07
0.09
0.07
0.00
0.00
0.09
0.00
0.00
0.00

34.05
7.39
3.39

3.18

2.48
0.56
0.10
0.00
0.00
0.16
0.00
0.00
0.00

0.07
0.09
0.07
0.01
0.04
0.09
0.03
0.02
0.03

35.43
6.22
1.43
0.00
0.00
1.78
0.00
0.00
0.00

Standard error estimates for the prostate cancer example

TABLE  2

Predictor

Coefficient

Bootstrap standard error

Fixed t

Varying t

Standard error
approxination (7)

1 intcpt
2 Icavol
3 Iweight
4 age
5 lbph
6 svi
7 lcp
8 gleason
9 pgg45

2.48
0.56
0.10
0.00
0.00
0.16
0.00
0.00
0.00

0.07
0.08
0.06
0.04
0.04
0.09
0.03
0.02
0.03

0.07
0.10
0.08
0.05
0.07
0.09
0.07
0.05
0.06

0.07
0.09
0.06
0.00
0.00
0.07
0.00
0.00
0.00

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

19961

REGRESSION  SHRINKAGE  AN)  SELECTION

275

0

-

Icavol lweight age

Ibph  svl

Icp  gleason pgg45

Fig. 6.  Box plots of 200 bootstrap values of the lasso coefficient estimates for the eight predictors in
the prostate cancer example

compares the ridge approximation formula (7) with the fixed t bootstrap, and the
bootstrap in which t was re-estimated for each sample. The ridge formula gives a
fairly good approximation to the fixed t bootstrap, except for the zero coefficients.
Allowing t to vary incorporates an additional source of variation and hence gives
larger standard error estimates. Fig. 6 shows box plots of 200 bootstrap replications
of the lasso estimates, with s fixed at the estimated value 0.44. The predictors whose
estimated coefficient is 0 exhibit skewed bootstrap distributions. The central 90%
percentile intervals (fifth and 95th percentiles of the bootstrap distributions) all
contained the value 0, with the exceptions of those for Icavol and svi.

4.  PREDICTION ERROR AND ESTIMATION OF t

In this section we describe three methods for the estimation of the lasso parameter
t: cross-validation, generalized cross-validation and an analytical unbiased estimate
of risk. Strictly speaking the first two methods are applicable in the 'X-random' case,
where it is assumed that the observations (X, Y) are drawn from some unknown
distribution, and the third method applies to the X-fixed case. However, in real
problems there is often no clear distinction between the two scenarios and we might
simply choose the most convenient method.

Suppose that

where E(e) = 0 and var(E) = a2.  The mean-squared error of an estimate '(X)  is
defined by

Y=

1(X)  +e

ME  =  E{l,(X)  -_X)2

the expected value taken over the joint distribution of X and Y, with '(X) fixed. A
similar measure is the prediction error of '(X) given by

PE=E{Y-

-(X)}2=ME+2.

(8)
We estimate the prediction error for the lasso procedure by fivefold cross-
validation as described (for example) in chapter 17 of Efron and Tibshirani (1993).
The lasso is indexed in terms of the normalized parameter s = t/l P,8, and the
prediction error is estimated over a grid of values of s from 0 to 1 inclusive. The value
s yielding the lowest estimated PE is selected.

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

276

[No.  1,
Simulation results are reported in terms of ME rather than PE. For the linear
models i(X) = X/3 considered in this paper, the mean-squared error has the simple
form

TIBSHIRANI

ME-= (3/3)TV(,3

/3)

where V is the population covariance matrix of X.
A second method for estimating t may be derived from a linear approximation to
the lasso estimate. We write the constraint Elpjl <  t as I f8/lIlj8 <  t. This constraint
is equivalent to adding a Lagrangian penalty X E fl/l,ij to the residual sum of
squares, with X depending on t. Thus we may write the constrained solution ,3 as the
ridge regression estimator

/3=  (XTX  +  XW-)-lXTy

where W = diag(jf31I) and W- denotes a generalized inverse. Therefore the number of
effective parameters in the constrained fit ,3 may be approximated by

p(t) = tr{X(XTX +  XW-)-lXT}.

Letting rss(t) be the residual sum of squares for the constrained fit with constraint

t, we construct the generalized cross-validation style statistic

GCV(t)  N1

rss(t)

(10)

Finally, we outline a third method based on Stein's unbiased estimate of risk.
Suppose that z is a multivariate normal random vector with mean it and variance the
identity matrix. Let a be an estimator of ,i,  and write f = z + g(z) where g is an
almost differential function from RP to RP (see definition 1 of Stein (1981)). Then
Stein (1981) showed that

A
Ipp1

p+E

/
lg(Z)  1 12 + 2 Edgildz,)(1
I

~~~p

ts

We may apply this result to the lasso estimator (3). Denote the estimated standard
error of f by T =  a/VN, where &2 =  E (yi - yi)2/(N -  p). Then the f7/Ti are (condi-
tionally on X) approximately independent standard normal variates, and from
equation (11) we may derive the formula

R{f(y)}

p -  2 #(j; I7/TI <Y)  +  E  max(I8/TI, Y)2}

as an approximately unbiased estimate of the risk or mean-square error E{,3(y) -
3}2,  where P8(y) = sign(p,8)(fi/I- y)+  Donoho and Johnstone (1994) gave a
similar formula in the function estimation setting. Hence an estimate of y can be
obtained as the minimizer of R{/3(y)}:

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

19961

REGRESSION SHRINKAGE AND SELECTION

277

From this we obtain an estimate of the lasso parameter t:

y=  arg miny>O[R {I6(y))].

t

-

Although the derivation of t^ assumes an orthogonal design, we may still try to use

it in the usual non-orthogonal setting. Since the predictors have been standardized,
the optimal value of t is roughly a function of the overall signal-to-noise ratio in the
data, and it should be relatively insensitive to the covariance of X. (In contrast, the
form of the lasso estimator is sensitive to the covariance and we need to account for it
properly.)

The simulated examples in Section 7.2 suggest that this method gives a useful
estimate of t. But we can offer only a heuristic argument in favour of it. Suppose that
XTX = V and let Z =  XV-1/2, 0 =  3V-1/2. Since the columns of X are standardized,
the region ElfjI <  t differs from the region E2f3jl <, t in shape but has roughly the
same-sized marginal projections. Therefore the optimal value of t should be about
the same in each instance.
Finally, note that the Stein method enjoys a significant computational advantage

over the cross-validation-based
estimate of t. In our experiments we optimized over a
grid of 15 values of the lasso parameter t and used fivefold cross-validation. As a
result, the cross-validation approach required 75 applications of the model optim-
ization procedure of Section 6 whereas the Stein method required only one. The
requirements of the generalized cross-validation approach are intermediate between
the two, requiring one application of the optimization procedure per grid point.

5.  LASSO AS BAYES ESTIMATE

The lasso constraint EI6il <  t is equivalent to the addition of a penalty term X Ib,I4
to the residual sum of squares (see Murray et al. (1981), chapter 5). Now lfjl is
proportional to the (minus) log-density of the double-exponential distribution. As a
result we can derive the lasso estimate as the Bayes posterior mode under inde-
pendent double-exponential priors for the f,js,

f(,Bj)-

exp

-)

with r=  1/X.

Fig. 7 shows the double-exponential density (full curve) and the normal density
(broken curve); the latter is the implicit prior used by ridge regression. Notice how
the double-exponential density puts more mass near 0 and in the tails. This reflects
the greater tendency of the lasso to produce estimates that are either large or 0.

6.  ALGORITHMS FOR FINDING LASSO SOLUTIONS

We fix t >  0. Problem (1) can be expressed as a least squares problem with 2P
inequality constraints, corresponding to the 2P different possible signs for the P,s.

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

278

TIBSHIRANI

[No.  1,

-4

-2

0

2

4

beta

Fig. 7.  Double-exponential density (
prior used by the lasso; the latter by ridge regression

~) and normnal density (-----:the

fonmer is the iInplicit

001~~~~~~~A

1

Lawson and Hansen (1974) provided the ingredients for a procedure which solves the
linear least squares problem subject to a general linear inequality constraint G'3 <, h.
Here G is an m x p matrix, corresponding to m linear inequality constraints on the p-
vector ,3. For our problem, however, m = 2P may be very large so that direct
application of this procedure is not practical. However, the problem can be solved by
introducing the inequality constraints sequentially, seeking a  feasible solution
satisfying the so-called Kuhn-Tucker conditions (Lawson and Hansen, 1974). We
outline the procedure below.
Let g(,3) =  v jN  Y-ytl)2,
and let 6s, i-=1, 2, . . ., 2P be the p-tuples of the
I 1, ... ., ? 1). Then the condition Elpjl <  t iS equivalent to  jT,3 <, t
form (  1,
for all i. For a given /3, let E ={iL 6iT,l =  t} and 5 =i  5I T,X3 <  t}. The set E iS the
equality set, corresponding to those constraints which are exactly met, whereas S is
the slack set, corresponding to those constraints for which equality does not hold.
Denote by GE the matrix whose rows are 6i for i E E. Let 1 be a vector of Is of length
equal to the number of rows of GE.^
T'he following algorithm starts with E = {io} where 6i,,  sign('3, ,l being the
overall least squares estimate. It solves the least squares problem subject to 15,O,B <'  t
and then checks whether sIl8il  <, t. If so, the computation is complete; if not, the
violated constraint is added to E and the process is continued until Elpjl <, t.

Here is an outline of the algorithm.
(a) Start with E=  {io} where 6i=  sign(W), T  being the overall least squares
(b) Find ,3 to minimize g(3) subject to GE/3 <,  tl.
(c) While {Elpjl  >  t},9
(d) add i to the set E where bi = sign(,3. Find ,B to minimize g(,3 subject to

estimate.

GE/3 <  t 1

T'his procedure must always converge in a finite number of steps since one element
is added to the set E at each step, and there is a total of 2P elements. The final iterate

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

19961

REGRESSION  SHRINKAGE  AND  SELECTION

279

TABLE  3

Results for example It

Method

Median mean-squared  Average no. of
0 coefficients

error

Average s

Least squares
Lasso (cross-validation)
Lasso (Stein)
Lasso (generalized cross-validation)
Garotte
Best subset selection
Ridge regression

2.79 (0.12)
2.43 (0.14)
2.07 (0.10)
1.93 (0.09)
2.29 (0.16)
2.44 (0.16)
3.21 (0.12)

tStandard errors are given in parentheses.

0.63 (0.01)
0.69 (0.02)
0.73 (0.01)

0.0
3.3
2.6
2.4
3.9
4.8
0.0

is a solution to the original problem since the Kuhn-Tucker conditions are satisfied
for the sets E and S at convergence.

A modification of this procedure removes elements from E in step (d) for which the
equality constraint is not satisfied. This is more efficient but it is not clear how to
establish its convergence.

The fact that the algorithm must stop after at most 2P iterations is of little comfort
if p is large. In practice we have found that the average number of iterations required
is in the range (0.5p, 0.75p) and is therefore quite acceptable for practical purposes.
A completely different algorithm for this problem was suggested by David Gay.
We write each Pj as fit -  P-, where fit and P- are non-negative. Then we solve the
least squares problem with the constraints fij >  0, P-8 >  0 and X P8+ + Ej  fi<t. In
this way we transform the original problem (p variables, 2P constraints) to a new
problem with more variables (2p) but fewer constraints (2p + 1). One can show that
this new problem has the same solution as the original problem.
assured in 2p + 1 steps. We have not extensively compared these two algorithms but
in examples have found that the second algorithm is usually (but not always) a little
faster than the first.

Standard quadratic programming techniques can be applied, with the convergence

7.  SIMULATIONS

7.1.  Outline

In the following examples, we compare the full least squares estimates with the
lasso, the non-negative garotte, best subset selection and ridge regression. We used
fivefold cross-validation to estimate the regularization parameter in each case. For
best subset selection, we used the 'leaps' procedure in the S language, with fivefold
cross-validation to estimate the best subset size. This procedure is described and
studied in Breiman and Spector (1992) who recommended fivefold or tenfold cross-
validation for use in practice.

For completeness, here are the details of the cross-validation procedure. The best
subsets of each size are first found for the original data set: call these So, S1, . . ., Sp
(S0 represents the null nodel; since - = 0 the fitted values are 0 for this model.)
Denote the full training set by T, and the cross-validation training and test sets by
T -  T' and TI, for v = 1, 2, . . ., 5. For each cross-validation fold v, we find the best

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

280

TIBSHIRANI

[No.  1,

TABLE  4

Most frequent models selected by the lasso
(generalized cross-validation) in example I

Model

Proportion

1245678
123456
1258
1245
13 others
125 (and 5 others)

0.055
0.050
0.045
0.045

0.025

subsets of each size for the data T-  Tv: call these So, S,.  .  ., Sp. Let PEv(J) be the
prediction error when Sv is applied to the test data TV, and form the estimate

PE(J)

PE(J).

v=1

(12)

We find the J that minimizes PE(J) and our selected model is SJ. This is not the same
as estimating the prediction error of the fixed models So, Si, . . ., SP and then
choosing the one with the smallest prediction error. This latter procedure is described
in Zhang (1993) and Shao (1992), and can lead to inconsistent model selection unless
the cross-validation test set Tv grows at an appropriate asymptotic rate.

In this example we simulated 50 data sets consisting of 20 observations from the

7.2.  Example 1

model

y =  3TX +  as,

where ,3 = (3, 1.5, 0, 0, 2, 0, 0, o)T and e  is standard normal. The correlation
between xi and xj was plisl with p = 0.5. We set a =  3, and this gave a signal-to-noise
ratio of approximately 5.7. Table 3 shows the mean-squared errors over 200
simulations from this model. The lasso performs the best, followed by the garotte
and ridge regression.

Estimation of the lasso parameter by generalized cross-validation seems to per-
form best, a trend that we find is consistent through all our examples. Subset

TABLE  5

Most frequent models selected by all-subsets

regression in example I

Model

125
15
1
1257

Proportion

0.240
0.200
0.095
0.040

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

19961

REGRESSION SHRINKAGE AND SELECTION

281

IV

-  -

_  r

__  -

r

-

o

--

-
I

_

?  _ _  _  - :1

-

-

7n

-

rW  1-

full Is

0
4-

lasso

0

gavotte

best subset

ridge

0
full Is
0

?.... . . ..... - . .... .....

lasso

C)

~~~~~~~

v

~

ful Is
___L__
_9_0
full Is

lasso

lasso
0

garotte

best subset

0~~~~~~~
uidge

...........

....... -t--

o~~~~~~~~~~~~~

--- i . .. . ... =  - ---- - -q ....
garotte

best subset

garotte
o~~~

best subset

ridge
__ __-7-
ridge

O.

. . . ..........

I-------

&  c=  .......I.......

.........

0~~~~~~~

........

.....

...
,I

.......
*--1I  *wlsr  W -L

...............

?

0

full Is

00

lasso

garotte

best subset

0

ridge

__

__

--L

-__

11F.  . .

o

N

.

0~~~~~~~~~~~~~

...........

full Is
full Is

lasso
lasso

garotte
garotte

best subset
best subset

rdge
ridge

Fig.8.........

Estiate

full Is

f

the

egtcfiins

lasso

.

.in

e

garofte

p

1

c

i

best subset

h

r

e

ridge

true

,

.

.

coefficie

..

.  .

..

.

.

....

........

I

.

.

.  .

...

.  .

.

..  .  .  .

..  ..  .

....o.-.11.u...,.

full Is

lasso

garotte

best subset

ridgs

Fig. 8.  Estimates for the eight coefficients in example 1, excluding the intercept: ......

true coefficients

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

282

Method

TIBSHIRANI

TABLE 6

Results for example 2t

[No.  1,

Median mean-squared  Average no. of  Average s

error

0 coefficients

0.0
3.0
2.7
2.3
4.3
5.2
0.0

0.50 (0.03)
0.55 (0.03)
0.69 (0.23)

Least squares
Lasso (cross-validation)
Lasso (Stein)
Lasso (generalized cross-validation)
Garotte
Subset selection
Ridge regression

6.50 (0.64)
5.30 (0.45)
5.85 (0.36)
4.87 (0.35)
7.40 (0.48)
9.05 (0.78)
2.30 (0.22)

tStandard errors are given in parentheses.

selection picks approximately the correct number of zero coefficients
from too much variability as shown in the box plots of Fig. 8.

Table 4 shows the five most frequent models (non-zero coefficients) selected by the
lasso (with generalized cross-validation): although the correct model (1, 2, 5) was
chosen only 2.5% of the time, the selected model contained (1, 2, 5) 95.5% of the
time. The most frequent models selected by subset regression are shown in Table 5.
The correct model is chosen more often (24% of the time), but subset selection can
also underfit: the selected model contained (1, 2, 5) only 53.5% of the time.

(5), but suffers

7.3.  Example 2

The second example is the same as example 1, but with Pj =  0.85, Vj and a =  3; the
signal-to-noise ratio was approximately 1.8. The results in Table 6 show that ridge
regression does the best by a good margin, with the lasso being the only other
method to outperform the full least squares estimate.

7.4.  Example 3

For example 3 we chose a set-up that should be well suited for subset selection.

The model is the same as example 1, but with 3 =(5, 0, 0, 0, 0, 0, 0, 0) and a =  2 so
that the signal-to-noise ratio was about 7.
The results in Table 7 show that the garotte and subset selection perform the best,

TABLE 7

Results for example 3t

Method

Median mean-squared  Average no. of  Average s

error

0 coefficients

Least squares
Lasso (cross-validation)
Lasso (Stein)
Lasso (generalized cross-validation)
Garotte
Subset selection
Ridge regression

2.89 (0.04)
0.89 (0.01)
1.26 (0.02)
1.02 (0.02)
0.52 (0.01)
0.64 (0.02)
3.53 (0.05)

tStandard errors are given in parentheses.

0.50 (0.03)
0.70 (0.01)
0.63 (0.04)

0.0
3.0
2.6
3.9
5.5
6.3
0.0

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

1996]

REGRESSION  SHRINKAGE  AND  SELECTION

283

TABLE  8

Results for example 4t

Method

Median mean-squared  Average no. of
0 coefficients

error

Average s

Least squares
Lasso (Stein)
Lasso (generalized cross-validation)
Garotte
Ridge regression

137.3 (7.3)
80.2 (4.9)
64.9 (2.3)
94.8 (3.2)
57.4 (1.4)

tStandard errors are given in parentheses.

0.0
14.4
13.6
22.9
0.0

0.55 (0.02)
0.60 (0.88)

followed closely by the lasso. Ridge regression does poorly and has a higher mean-
squared error than do the full least squares estimates.

7.5.  Example 4

In this example we examine the performance of the lasso in a bigger model. We
simulated 50 data sets each having 100 observations and 40 variables (note that best
subsets regression is generally considered impractical for p > 30). We defined
predictors xy =  zy + zi where zy and zi are independent standard normal variates.
This induced a pairwise correlation of 0.5 among the predictors. The coefficient
vector was /3  (0, 0, ..  . ,0, 2,2  ..  ., 2, 0, 0, ... ., 0, 2,2  ..  ., 2), there being 10
repeats in each block. Finally we defined y =  l3Tx +  15E where E  was standard
normal. This produced a signal-to-noise ratio of roughly 9. The results in Table 8
show that the ridge regression performs the best, with the lasso (generalized cross-
validation) a close second.
in each of the four blocks of 10 were
0.50 (0.06), 0.92 (0.07), 1.56 (0.08) and 2.33 (0.09). Although the lasso only produced
14.4 zero coefficients on average, the average value of s (0.55) was close to the true
proportion of Os (0.5).

The average value of the lasso coefficients

8.  APPLICATION TO GENERALIZED REGRESSION MODELS

The lasso can be applied to many other models: for example Tibshirani (1994)
described an application to the proportional hazards model. Here we briefly explore
the application to generalized regression models.
Consider any model indexed by a vector parameter /3, for which estimation is
carried out by maximization of a function l(J3); this may be a log-likelihood function
or some other measure of fit. To apply the lasso, we maximize 1(,3) under the
constraint ZIIj Ij <  t. It might be possible to carry out this maximization by a general
(non-quadratic) programming procedure. Instead, we consider here models for which
a quadratic approximation to 1(a3) leads to an iteratively reweighted least squares
(IRLS)  procedure for computation of ,3.  Such a procedure is equivalent to a
Newton-Raphson algorithm. Using this approach, we can solve the constrained
problem by iterative application of the lasso algorithm, within an IRLS  loop.
Convergence of this procedure is not ensured in general, but in our limited experience
it has behaved quite well.

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

284

TIBSHIRANI

[No.  1,

8.1.  Logistic Regression

For illustration we applied the lasso to the logistic regression model for binary
data. We used the kyphosis data, analysed in Hastie and Tibshirani (1990), chapter
10. The response is kyphosis (0 _ absent, 1 _ present); the predictors xl = age, x2
number of vertebrae levels and X3  starting vertebrae level. There are 83 obser-
vations. Since the predictor effects are known to be non-linear, we included squared
terms in the model after centring each of the variables. Finally, the columns of the
data matrix were standardized.

The linear logistic fitted model is

-2.64 + 0.83x, + 0.77x2 -  2.28x3 -  1.55x2l + 0.03x22 -  1.17x2.

Backward stepwise deletion, based on Akaike's information criterion, dropped the

x2-term and produced the model

-2.64 + 0.84x1 + 0.80x2 -  2.28x3 -  1.54x2 -  1.16x23.

The lasso chose s=  0.33, giving the model

-1.42 + 0.03x, + 0.31x2 -  0.48x3 - 0.28x2.

Convergence, defined as the I 13new8 )30d1 2 <  10-6, was obtained in five iterations.

9.  SOME FURTHER EXTENSIONS

We are currently exploring two quite different applications of the lasso idea. One
application is to tree-based models, as reported in LeBlanc and Tibshirani (1994).
Rather than prune a large tree as in the classification and regression tree approach of
Breiman et al. (1984), we use the lasso idea to shrink it. This involves a constrained
least squares operation much like that in this paper, with the parameters being the
mean contrasts at each node. A further set of constraints is needed to ensure that the
shrunken model is a tree. Results reported in LeBlanc and Tibshirani (1994) suggest
that the shrinkage procedure gives more accurate trees than pruning, while still
producing interpretable subtrees.
A different application is to the multivariate adaptive regression splines (MARS)
proposal of Friedman (1991). The MARS approach is an adaptive procedure that
builds a regression surface by sum of products of piecewise linear basis functions of
the individual regressors. The MARS algorithm builds a  model that typically
includes basis functions representing main effects and interactions of high order.
Give the adaptively chosen bases, the MARS fit is simply a linear regression onto
these bases. A backward stepwise procedure is then applied to eliminate less
important terms.
In on-going work with Trevor Hastie, we are developing a special lasso-type
algorithm to grow and prune a MARS model dynamically. Hopefully this will
produce more accurate MARS models which also are interpretable.
The lasso idea can also be applied to ill-posed problems, in which the predictor
matrix is not full rank. Chen and Donoho (1994) reported some encouraging results
for the use of lasso-style constraints in the context of function estimation via
wavelets.

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

19961

REGRESSION SHRINKAGE AND SELECTION

10. RESULTS ON SOFT THRESHOLDING

285

Consider the special case of an orthonormal design XTX =  I. Then the lasso

estimate has the form

,B = sign(f)(I6  Y-)

(13)
This is called a 'soft threshold' estimator by Donoho and Johnstone (1994); they
applied this estimator to the coefficients of a wavelet transform of a function
measured with noise. They then backtransformed
to obtain a smooth estimate of the
function. Donoho and Johnstone proved many optimality results for the soft
threshold estimator and then translated these results into optimality results for
function estimation.

Our interest here is not in function estimation but in the coefficients themselves.
We give one of Donoho and Johnstone's results here. It shows that asymptotically
the soft threshold estimator (lasso) comes as close as subset selection to the
performance of an ideal subset selector -  one that uses information about the actual
parameters.

Suppose that

where Ei -  N(0, a 2) and the design matrix is orthonormal. Then we can write

Yi =  ix' + Ei

p>?  pj + azj

(14)

where zj -  N(0, cr2).

We consider estimation of ,B under squared error loss, with risk

Consider the family of diagonal linear projections

R(3 1 3) =EEl 1_- -32

)y 1

fO, 1}.

3) =

TDP(0,

(15)
This estimator either keeps or kills a parameter fl, i.e. it does subset selection. Now
we incur a risk of a2 if we use flO, and f(j  if we use an estimate of 0 instead. Hence the
ideal choice of 3, is I(1flj1 > aT), i.e. we keep only those predictors whose true
coefficient
is larger than the noise level. Call the risk of this estimator RDP:  of course
this estimator cannot be constructed since the P,i are unknown. Hence RDP is a lower
bound on the risk that we can hope to attain.
Donoho and Johnstone (1994) proved that the hard threshold (subset selection)
estimator f,B =  I(,7(1?I > y) has risk

R(/3, /3) s< (2 logp + 1) (a.2 + RDP).

(16)
Here y is chosen as a(2 log n)112, the choice giving smallest asymptotic risk. They also
showed that the soft threshold estimator (13) with y = o(2 log n)112 achieves the same
asymptotic rate.

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

286

[No.  1,
These results lend some support to the potential utility of the lasso in linear
models. However, the important differences between the various approaches tend to
occur for correlated predictors, and theoretical results such as those given here seem
to be more difficult to obtain in that case.

TIBSHIRANI

1 1.  DISCUSSION

In this paper we have proposed a new method (the lasso) for shrinkage and
selection for regression and generalized regression problems. The lasso does not
focus on subsets but rather defines a continuous shrinking operation that can
produce coefficients that are exactly 0. We have presented some evidence in this
paper that suggests that the lasso is a worthy competitor to subset selection and ridge
regression. We examined the relative merits of the methods in three different
scenarios:

(a) small number of large effects subset selection does best here, the lasso not

quite as well and ridge regression does quite poorly;

(b) small to moderate number of moderate-sized effects -  the lasso does best,

followed by ridge regression and then subset selection;

(c) large number of small effects ridge regression does best by a good margin,

followed by the lasso and then subset selection.

Breiman's garotte does a little better than the lasso in the first scenario, and a little
worse in the second two scenarios. These results refer to prediction accuracy. Subset
selection, the lasso and the garotte have the further advantage (compared with ridge
regression) of producing interpretable submodels.

There are many other ways to carry out subset selection or regularization in least
squares regression. The literature is increasing far too fast to attempt to summarize it
in this short space so we mention only a few recent developments. Computational
advances have led to some interesting proposals, such as the Gibbs sampling
approach of George and McCulloch (1993). They set up a hierarchical Bayes model
and then used the Gibbs sampler to simulate a large collection of subset models from
the posterior distribution. This allows the data analyst to examine the subset models
with highest posterior probability and can be carried out in large problems.
Frank and Friedman (1993) discuss a generalization of ridge regression and subset
selection, through the addition of a penalty of the form X YiflIq to the residual sum
of squares. This is equivalent to a constraint of the form S2jl1q <, t; they called this
the 'bridge'. The lasso corresponds to q = 1. They suggested that joint estimation of
the Pjs and q might be an effective strategy but do not report any results.
Fig. 9 depicts the situation in two dimensions. Subset selection corresponds to
q -O 0. The value q =  1 has the advantage of being closer to subset selection than is
ridge regression (q =  2) and is also the smallest value of q giving a convex region.
Furthermore, the linear boundaries for q = 1 are convenient for optimization.

The encouraging results reported here suggest that absolute value constraints
might prove to be useful in a wide variety of statistical estimation problems. Further
study is needed to investigate these possibilities.

This content downloaded  on Tue, 12 Mar 2013 11:11:11 AM

All use subject to JSTOR Terms and Conditions

1996]

REGRESSION SHRINKAGE AND SELECTION

287

(a)

(b)

(c)

(d)

(e)

Fig. 9.  Contours of constant value of jl2fi1q for given values of q: (a) q = 4; (b) q = 2; (c) q =  1;
(d) q = 0.5; (e) q = 0.1

12.  SOFTWARE

Public domain and S-PLUS language functions for the lasso are available at the
Statlib archive at Carnegie Mellon University. There are functions for linear models,
generalized linear models and the proportional hazards model. To obtain them, use
file transfer protocol to lib.stat.cmu.edu
and retrieve the file S/lasso, or send an
electronic mail message to statlib@lib.stat.cmu.edu
with the message send lasso from S.

ACKNOWLEDGEMENTS

I would like to thank Leo Breiman for sharing his garotte paper with me before
publication, Michael Carter for assistance with the algorithm of Section 6 and David
Andrews for producing Fig. 3 in MATHEMATICA. I would also like to ack-
nowledge enjoyable and fruitful discussions with David Andrews, Shaobeng Chen,
Jerome Friedman, David Gay, Trevor Hastie, Geoff Hinton, lain Johnstone,
Stephanie Land, Michael Leblanc, Brenda MacGibbon, Stephen Stigler and
Margaret Wright. Comments by the Editor and a  referee led to substantial
improvements in the manuscript. This work was supported by a grant from the
Natural Sciences and Engineering Research Council of Canada.

