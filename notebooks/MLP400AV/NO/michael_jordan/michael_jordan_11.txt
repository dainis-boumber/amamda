Abstract

Motivated by navigation and tracking applications within sensor networks, we consider the prob-

lem of performing Kalman ltering with intermittent observations. When data travel along unreliable

communication channels in a large, wireless, multi-hop sensor network, the effect of communication

delays and loss of information in the control loop cannot be neglected. We address this problem starting

from the discrete Kalman ltering formulation, and modelling the arrival of the observation as a random

process. We study the statistical convergence properties of the estimation error covariance, showing the

existence of a critical value for the arrival rate of the observations, beyond which a transition to an

unbounded state error covariance occurs. We also give upper and lower bounds on this expected state

error covariance.

This research is partially supported by DARPA under grant F33615-01-C-1895.

DRAFT

2

I. INTRODUCTION

Advances in VLSI and MEMS technology have boosted the development of micro sensor

integrated systems. Such systems combine computing, storage, radio technology, and energy

source on a single chip [1] [2]. When distributed over a wide area, networks of sensors can

perform a variety of tasks that range from environmental monitoring and military surveillance,

to navigation and control of a moving vehicle [3] [4] [5]. A common feature of these systems

is the presence of signicant communication delays and data loss across the network. From the

point of view of control theory, signicant delay is equivalent to loss, as data needs to arrive

to its destination in time to be used for control. In short, communication and control become

tightly coupled such that the two issues cannot be addressed independently.

Consider, for example, the problem of navigating a vehicle based on the estimate from a sensor

web of its current position and velocity. The measurements underlying this estimate can be lost

or delayed due to the unreliability of the wireless links. What is the amount of data loss that the

control loop can tolerate to reliably perform the navigation task? Can communication protocols

be designed to satisfy this constraint? At Berkeley, we have faced these kind of questions in

building sensor networks for pursuit evasion games as part of the Network of Embedded Systems

Technology (NEST) project [2]. Practical advances in the design of these systems are described

in [6]. The goal of this paper is to examine some control-theoretic implications of using sensor

networks for control. These require a generalization of classical control techniques that explicitly

take into account the stochastic nature of the communication channel.

In our setting, the sensor network provides observed data that are used to estimate the state of a

controlled system, and this estimate is then used for control. We study the effect of data losses due

to the unreliability of the network links. We generalize the most ubiquitous recursive estimation

technique in controlthe discrete Kalman lter [7]modelling the arrival of an observation

as a random process whose parameters are related to the characteristics of the communication

channel, see Figure 1. We characterize the statistical convergence of the expected estimation

error covariance in this setting.

The classical theory relies on several assumptions that guarantee convergence of the Kalman

DRAFT

3

Fig. 1. Overview of the system. We study the statistical convergence of the expected estimation error covariance of the discrete

Kalman lter, where the observation, travelling over an unreliable communication channel, can be lost at each time step with
probability 1  .

lter. Consider the following discrete time linear dynamical system:

xt+1 = Axt + wt

yt = Cxt + vt,

(1)
where xt  (cid:60)n is the state vector, yt  (cid:60)m the output vector, wt  (cid:60)p and vt  (cid:60)m are Gaussian
random vectors with zero mean and covariance matrices Q  0 and R > 0, respectively. wt
is independent of ws for s < t. Assume that the initial state, x0, is also a Gaussian vector of
zero mean and covariance 0. Under the hypothesis of stabilizability of the pair (A, Q) and
detectability of the pair (A, C), the estimation error covariance of the Kalman lter converges

to a unique value from any initial condition [8].

These assumptions have been relaxed in various ways [8]. Extended Kalman ltering attempts

to cope with nonlinearities in the model; particle ltering is also appropriate for nonlinear

DRAFT

SystemKalman FilterMz-1Mz-1+++-4

models and additionally does not require the noise model to be Gaussian. Recently, more

general observation processes have been studied. In particular, in [9], [10] the case in which

observations are randomly spaced in time according to a Poisson process has been studied, where

the underlying dynamics evolve in continuous time. These authors showed the existence of a

lower bound on the arrival rate of the observations below which it is possible to maintain the

estimation error covariance below a xed value, with high probability. The results were restricted

to scalar SISO systems.

We approach a similar problem within the framework of discrete time, and provide results

for general n-dimensional MIMO systems. In particular, we consider a discrete-time system in

which the arrival of an observation is a Bernoulli process with parameter 0 <  < 1, and,

rather than asking for the estimation error covariance to be bounded with high probability, we

study the asymptotic behavior (in time) of its average. Our main contribution is to show that,

depending on the eigenvalues of the matrix A, and on the structure of the matrix C, there exists

a critical value c, such that if the probability of arrival of an observation at time t is  > c,
then the expectation of the estimation error covariance is always nite (provided that the usual
stabilizability and detectability hypotheses are satised). If   c, then the expectation of the
estimation error covariance tends to innity. We give explicit upper and lower bounds on c,
and show that they are tight in some special cases.

Philosophically this result can be seen as another manifestation of the well known uncertainty

threshold principle [11], [12]. This principle states that optimum long-range control of a dy-

namical system with uncertainty parameters is possible if and only if the uncertainty does not

exceed a given threshold. The uncertainty is modelled as white noise scalar sequences acting

on the system and control matrices. In our case, the result is for optimal estimation, rather than

optimal control, and the uncertainty is due to the random arrival of the observation, with the

randomness arising from losses in the network.

Studies on ltering with intermittent observations can be tracked back to Nahi [13] and Hadidi

[14]. More recently, this problem has been studied using jump linear systems (JLS) [15]. JLS

are stochastic hybrid systems characterized by linear dynamics and discrete regime transitions

modelled as Markov chains. In the work of Costa et al. [16] and Nilsson et al. [17], [18], the

Kalman lter with missing observations is modelled as a JLS switching between two discrete

regimes: an open loop conguration and a closed loop one. Following this approach, these authors

DRAFT

5

obtain convergence criteria for the expected estimation error covariance. However, they restrict

their formulation to the steady state case, where the Kalman gain is constant, and they do not

assume to know the switching sequence. The resulting process is wide sense stationary [19], and

this makes the exact computation of the transition probability and state error covariance possible.

Other work on optimal, constant gain ltering was done by Wang et al. [20], who included the

presence of system parameters uncertainty besides missing observations, and Smith et al. [21],

who considered multiple lters fusion. Instead, we consider the general case of time varying

Kalman gain. In presence of missing observations, this lter has a smaller linear minimum mean

square error (LMMSE) than its static counterpart, as it is detailed in Section II.

The general case of time-varying Kalman lter with intermittent observations was also studied

by Fortmann et al. [22], who derived stochastic equations for the state covariance error. However,

they do not statistically characterize its convergence and provide only numerical evidence of the

transition to instability, leaving a formal characterization of this as an open problem, which is

addressed in this paper. A somewhat different formulation was considered in [23], where the

observations arrival have a bounded delay.

Finally, we point out that our analysis can also be viewed as an instance of Expectation-

Maximization (EM) theory. EM is a general framework for doing Maximum Likelihood esti-

mation in missing-data models [24]. Lauritzen [25] shows how EM can be used for general

graphical models. In our case, however, the graph structure is a function of the missing data, as

there is one graph for each pattern of missing data.

The paper is organized as follows. In section II we formalize the problem of Kalman ltering

with intermittent observations. In section III we provide upper and lower bounds on the expected

estimation error covariance of the Kalman lter, and nd the conditions on the observation arrival

probability  for which the upper bound converges to a xed point, and for which the lower

bound diverges. Section IV describes some special cases and gives an intuitive understanding of

the results. In section V we compare our approach to previous ones [17] based on jump linear

systems. Finally, in section VI, we state our conclusions and give directions for future work.

II. PROBLEM FORMULATION

Consider the canonical state estimation problem. We dene the arrival of the observation at

time t as a binary random variable t, with probability distribution pt(1) = t, and with t

DRAFT

independent of s if t (cid:54)= s. The output noise vt is dened in the following way:

 N (0, R)

N (0, 2I)

p(vt|t) =

: t = 1

: t = 0,

for some 2 . Therefore, the variance of the observation at time t is R if t is 1, and 2I
otherwise. In reality the absence of observation corresponds to the limiting case of   . Our
approach is to re-derive the Kalman lter equations using a dummy observation with a given
variance when the real observation does not arrive, and then take the limit as   .

First let us dene:

xt|t

Pt|t

xt+1|t

Pt+1|t

yt+1|t

= E[xt|yt, t]
= E[(xt  x)(xt  x)(cid:48)|yt, t]
= E[xt+1|yt, t+1]
= E[(xt+1  xt+1)(xt+1  xt+1)(cid:48)|yt, t+1]
= E[yt+1|yt, t+1],

= [y0, . . . , yt](cid:48) and t

(6)
= [0, . . . , t](cid:48). Using the Dirac delta

where we have dened the vectors yt
() we have:

E[(yt+1  yt+1|t)(xt+1  xt+1|t)(cid:48)|yt, t+1] = CPt+1|t

E[(yt+1  yt+1|t)(yt+1  yt+1|t)(cid:48)|yt, t+1] = CPt+1|tC(cid:48) + (t+1  1)R + (t+1)2I,

and it follows that the random variables xt+1 and yt+1, conditioned on the output yt and on the
arrivals t+1, are jointly gaussian with mean

E[xt+1, yt+1|yt, t+1] =

and covariance

COV (xt+1, yt+1|yt, t+1) =

 Pt+1|t

 xt+1|t

C xt+1|t

 ,

Pt+1|tC(cid:48)

CPt+1|t CPt+1|tC(cid:48) + (t+1  1)R + (t+1)2I

6

(2)

(3)

(4)

(5)

(7)

(8)

 .

(9)

DRAFT

Hence, the Kalman lter equations are modied as follows:

xt+1|t = Axt|t
Pt+1|t = APt|tA(cid:48) + Q

xt+1|t+1 = xt+1|t + Pt+1|tC(cid:48)(CPt+1|tC(cid:48) + (t+1  1)R + (t+1)2I)1(yt+1  C xt+1|t)
Pt+1|t+1 = Pt+1|t  Pt+1|tC(cid:48)(CPt+1|tC(cid:48) + (t+1  1)R + (t+1)2I)1CPt+1|t.

7

(10)

(11)

(12)

(13)

Taking the limit as   , the update equations (12) and (13) can be rewritten as follows:

xt+1|t+1 = xt+1|t + t+1Pt+1|tC(cid:48)(CPt+1|tC(cid:48) + R)1(yt+1  C xt+1|t)
Pt+1|t+1 = Pt+1|t  t+1Pt+1|tC(cid:48)(CPt+1|tC(cid:48) + R)1CPt+1|t.

(14)

(15)

Note that performing this limit corresponds exactly to propagating the previous state when

there is no observation update available at time t. We also point out the main difference from

the standard Kalman lter formulation: Both xt+1|t+1 and Pt+1|t+1 are now random variables,
being a function of t+1, which is itself random.

It is important to stress that Equations (14)-(15) give the minimum state error variance lter

given the observations {yt} and their arrival sequence{t}, i.e.
t = E[xt|yn, . . . , y1; n, . . . , 1]. As a consequence, the lter proposed in this paper is neces-
xtm
sarily time-varying and stochastic since it depends on the arrival sequence. The lters that have

been proposed so far using JLS theory [16][18] give the minimum state error variance lters
assuming that only the observations {yt} are available, i.e. xJLS
t = E[xt|yn, . . . , y1]. Therefore,
the lter given by Equations (14)-(15) gives a better performance than its JLS counterparts, since

it exploits additional information regarding the arrival sequence.

Given the new formulation, we now study the Riccati equation of the state error covariance

matrix in the specic case when the arrival process of the observation is time-independent, i.e.

t =  for all time. This will allow us to provide deterministic upper and lower bounds on
its expectation. We then characterize the convergence of these upper and lower bounds, as a

function of the arrival probability  of the observation.

DRAFT

III. CONVERGENCE CONDITIONS AND TRANSITION TO INSTABILITY

It is easy to verify that the modied Kalman lter formulation in Equations (11) and (15) can

be rewritten as follows:

Pt+1 = APtA(cid:48) + Q  t APtC(cid:48)(CPtC(cid:48) + R)1CPtA(cid:48),

(16)

8

where we use the simplied notation Pt = Pt|t1. Since the sequence {t}
modied Kalman lter iteration is stochastic and cannot be determined off-line. Therefore, only

is random, the

0

statistical properties can be deduced. In this section we show the existence of a critical value

c for the arrival probability of the observation update, such that for  > c the mean state
covariance E[Pt] is bounded for all initial conditions, and for   c the mean state covariance
diverges for some initial condition. We also nd a lower bound , and upper bound , for the
critical probability c, i.e.,   c  . The lower bound is expressed in closed form; the upper
bound is the solution of a linear matrix inequality (LMI). In some special cases the two bounds

coincide, giving a tight estimate. Finally, we present numerical algorithms to compute a lower
bound S, and upper bound V , for limt E[Pt], when it is bounded.

First, we dene the modied algebraic Riccati equation (MARE) for the Kalman lter with

intermittent observations as follows,

g(X) = AXA(cid:48) + Q   AXC(cid:48)(CXC(cid:48) + R)1CXA(cid:48).

(17)

Our results derive from two principal facts: the rst is that concavity of the modied algebraic

Riccati equation for our lter with intermittent observations allows use of Jensens inequality to

nd an upper bound on the mean state covariance; the second is that all the operators we use to

estimate upper and lower bounds are monotonically increasing, therefore if a xed point exists,

it is also stable.

We formally state all main results in form of theorems. Omitted proofs appear in the Appendix.

The rst theorem expresses convergence properties of the MARE.
Theorem 1. Consider the operator (K, X) = (1  )(AXA(cid:48) + Q) + (F XF (cid:48) + V ), where
F = A + KC, V = Q + KRK(cid:48). Suppose there exists a matrix K and a positive denite matrix
P such that

P > 0 and

P > ( K, P )

DRAFT

Then,

(a) for any initial condition P0  0, the MARE converges, and the limit is independent of
the initial condition:

9

lim
t Pt = lim

t gt

(P0) = P

(b) P is the unique positive semidenite xed point of the MARE.

The next theorem states the existence of a sharp transition.

Theorem 2. If (A, Q 1
a c  [0, 1) such that

2 ) is controllable, (A, C) is detectable, and A is unstable, then there exists

t E[Pt] = + for 0    c and some initial condition P0  0
lim
E[Pt]  MP0 t
for c <   1 and any initial condition P0  0

(18)

(19)

where MP0 > 0 depends on the initial condition P0  01.

The next theorem gives upper and lower bounds for the critical probability c.

Theorem 3. Let

 = arginf[ S | S = (1  )A SA(cid:48) + Q] = 1  1
2
 = arginf[( K, X) | X > ( K, X)]
where  = maxi |i| and i are the eigenvalues of A. Then

  c  .

(20)

(21)

(22)

Finally, the following theorem gives an estimate of the limit of the mean covariance matrix

E[Pt], when this is bounded.

Theorem 4. Assume that (A, Q 1

2 ) is controllable, (A, C) is detectable and  > , where  is

dened in Theorem 4. Then

0  St  E[Pt]  Vt

 E[P0]  0

(23)

1We use the notation limt At = + when the sequence At  0 is not bounded; i.e., there is no matrix M  0 such

that At  M,t.

DRAFT

10

where limt St = S and limt Vt = V , where S and V are solution of the respective
algebraic equations S = (1  )A SA(cid:48) + Q and V = g( V )

The previous theorems give lower and upper bounds for both the critical probability c and
for the mean error covariance E[Pt]. The lower bound  is expressed in closed form. We now
resort to numerical algorithms for the computation of the remaining bounds , S and V .

The computation of the upper bound  can be reformulated as the iteration of an LMI feasibility

problem. To establish this we need the following theorem:

Theorem 5. If (A, Q 1

2 ) is controllable and (A, C) is detectable, then the following statements

are equivalent:

(a)  X such that
(b)  K, X > 0
(c)  Z and 0 < Y  I such that

X > g( X)

such that

X > ( K, X)

(Y, Z) =



Y

(A(cid:48)Y + C(cid:48)Z(cid:48))


1  A(cid:48)Y





(Y A + ZC)



1  Y A

Y

0

0

Y

 > 0.

Proof:

(a)=(b) If X > g( X) exists, then X > 0 by Lemma 1(g). Let K = K X. Then
X > g( X) = ( K, X) which proves the statement. (b)=(a) Clearly X > ( K, X)  g( X)
which proves the statement. (b)(c) Let F = A + KC, then:

X > (1  )AXA(cid:48) + F XF (cid:48) + Q + KRK(cid:48)

is equivalent to

where we used the Schur complement decomposition and the fact that X  (1  )AXA(cid:48) 
F XF (cid:48) + Q + KRK(cid:48)  Q > 0. Using one more time the Schur complement decomposition
on the rst element of the matrix we obtain

F
X1



F (cid:48)

 X  (1  )AXA(cid:48) 


X

F (cid:48)
1  A(cid:48)





F
X1
0

 =

 > 0,
 > 0.



1  A
0
X1

DRAFT

11

This is equivalent to

 =

=

 

 X1 0 0

I 0

0

 > 0

0

0 I



X1F
X1
0



1  X1A

0
X1

0

0

0 I

I 0

 X1 0 0







X1

F (cid:48)X1
1  A(cid:48)X1

 > 0.
 > 0.

Let us consider the change of variable Y = X1 > 0 and Z = X1K, in which case the
previous LMI is equivalent to:





1  Y A

(Y, Z) =

Y

(Y A + ZC)

(A(cid:48)Y + C(cid:48)Z(cid:48))


1  A(cid:48)Y

Y

0

0

Y

Since (Y, K) = (Y, K), then Y can be restricted to Y  I, which completes the theorem.

Combining theorems 3 and 5 we immediately have the following corollary

Corollary 1. The upper bound  is given by the solution of the following optimization problem,

 = argmin(Y, Z) > 0,

0  Y  I.

This is a quasi-convex optimization problem in the variables (, Y, Z) and the solution can

be obtained by iterating LMI feasibility problems and using bisection for the variable .

The lower bound S for the mean covariance matrix can be easily obtained via standard
Lyapunov Equation solvers. The upper bound V can be found by iterating the MARE or by
solving a semidenite programming (SDP) problem as shown in the following.

Theorem 6. If  > , then the matrix V = g(V ) is given by:

(a) V = limt Vt; Vt+1 = gVt where V0  0

DRAFT

(b)

argmaxV

subject to

T race(V )

 AV A(cid:48)  V





AV C(cid:48)
CV A(cid:48) CV C(cid:48) + R

12

  0,

V  0

Proof:

(a) It follows directly from Theorem 1.

(b) It can be obtained by using the Schur complement decomposition on the equation V 
g(V ). Clearly the solution V = g( V ) belongs to the feasible set of the optimization problem.
We now show that the solution of the optimization problem is the xed point of the MARE.
Suppose it is not, i.e., V solves the optimization problem but V (cid:54)= g( V ). Since V is a feasible
V . However, this implies that T race( V ) <
point of the optimization problem, then V < g( V ) =
V ), which contradicts the hypothesis of optimality of matrix V . Therefore V = g( V )
T race(

and this concludes the theorem.

IV. SPECIAL CASES AND EXAMPLES

In this section we present some special cases in which upper and lower bounds on the critical
value c coincide and give some examples. From Theorem 1, it follows that if there exists a K
such that F is the zero matrix, then the convergence condition of the MARE is for  > c =
1  1/2, where  = maxi |i|, and i are the eigenvalues of A.

 C is invertible. In this case a choice of K = AC1 makes F = 0. Note that the scalar
case also falls under this category. Figure (1) shows a plot of the steady state of the upper

and lower bounds versus  in the scalar case. The discrete time LTI system used in this
simulation has A = 1.25, C = 1, with vt and wt having zero mean and variance R = 2.5
and Q = 1, respectively. For this system we have c = 0.36. The transition clearly appears
in the gure, where we see that the steady state value of both upper and lower bound tends

to innity as  approaches c. The dashed line shows the lower bound, the solid line the
upper bound, and the dash-dot line shows the asymptote.

 A has a single unstable eigenvalue. In this case, regardless of the dimension of C (and

as long as the pair (A, C) is detectable), we can use Kalman decomposition to bring to

zero the unstable part of F and thereby obtain tight bounds. Figure (2) shows a plot for

DRAFT

13

Fig. 2. Example of transition to instability in the scalar case. The dashed line shows the asymptotic value of the lower bound
( S), the solid line the asymptotic value of the upper bound ( V ), and the dash-dot line shows the asymptote (c).

 1.25 1

0

.9

, C =

0

7

(cid:179)

(cid:180)

1 0 2

the system A =

0

0 .60

with vt and wt having zero mean and variance R = 2.5 and Q = 20  I3x3, respectively.
This time, the asymptotic value for trace of upper and lower bound is plotted versus .

Once again c = 0.36.

In general F cannot always be made zero and we have shown that while a lower bound on

c can be written in closed form, an upper bound on c is the result of a LMI. Figure (4) shows
an example where upper and lower bounds have different convergence conditions. The system

 1.25

, C =

(cid:179)

0

(cid:180)

used for this simulation is A =
with vt and wt having zero mean and variance R = 2.5 and Q = 20  I2x2, respectively.

1 1

1.1

1

Finally, in Figure (5) we report results of another experiment, plotting the state estimation error

for the scalar system used above at two similar values of , one being below and one above the
critical value. We note a dramatic change in the error at c  0.36. The gure on the left shows

DRAFT

00.10.20.30.40.50.60.70.80.910102030405060708090100S, VSpecial case: C is invertibleVSc 14

Fig. 3. Example of transition to instability with a single unstable eigenvalue in the MIMO case. The dashed line shows the
asymptotic value of the trace of lower bound ( S), the solid line the asymptotic value of trace of the upper bound ( V ), and the
dash-dot line shows the asymptote (c).

Fig. 4. Transition to instability in the general case, with arbitrary A and C. In this case lower and upper bounds do not have

the same asymptote.

DRAFT

00.10.20.30.40.50.60.70.80.9100.511.522.533.544.55x 106Special case: one unstable eigenvalueTr(V)Tr(S)Tr(S), Tr(V)c 00.10.20.30.40.50.60.70.80.91051015x 104General caseTr(V)Tr(S)Tr(S), Tr(V)  15

Fig. 5. Estimation error for  below (left) and above (right) the critical value

the estimation error with  = 0.3. The gure on the right shows the estimation error for the same

system evolution with  = 0.4. In the rst case the estimation error grows dramatically, making

it practically useless for control purposes. In the second case, a small increase in  reduces the

estimation error by approximately three orders of magnitude.

V. STATIC VERSUS DYNAMIC KALMAN GAIN

In this section we compare the performance of ltering with static and dynamic gain for

a scalar discrete system. For the static estimator we follow the jump linear system approach

of [17]. The scalar static estimator case has been also worked out in [26].

Consider the dynamic state estimator

t + tK d

t (yt  yt)
t+1 = Axd
xd
t = APtC(cid:48)(CPtC(cid:48) + R)1
K d
Pt+1 = APtA(cid:48) + Q  tAPtC(cid:48)(CPtC(cid:48) + R)1CPtA(cid:48)

(24)

DRAFT

01002003004005003210123x 1050100200300400500100080060040020002004006008001000tkEstimation Error:  = 0.15tk Estimation Error:  = 0.1where the Kalman gain K d
t

is time-varying. Also consider the static state estimator

xs
t+1 = Axd

t + tKs(yt  yt)

16

(25)

where the estimator gain Ks is constant. If no data arrives, i.e. t = 0, both estimators simply
propagate the state estimate of the previous time-step.

The performance of the dynamic state estimator (24) has been analyzed in the previous

sections. The performance of static state estimator (25), instead, can be readily obtained using
=
t+1, we obtain the dynamics

jump linear system theory [15] [17]. To do so, let us consider the estimator error es
xt+1  xs
of the estimation error:

t+1. Substituting Equations (1) for xt+1 and (25) for xs

t+1

t+1 = (A  tKsC)es
es

t + vt + tKswt.

(26)

Using the same notation of Chapter 6 in Nilsson [17], where he considers the general system:

zk+1 = (rk)zk + (rk)ek,

the system (26) can be seen as jump linear system switching between two states rk  {1, 2}
given by:

(1) = A  KsC

(1) = [1 Ks]

(2) = A

(2) = [1 0],

k] = Re, the transition probability matrix Q and the steady

where the noise covariance E[eke(cid:48)
state probability distribution  are given by:

 Q 0

0 R

 Q =

  1  

 1  

Re =

(cid:105)

 1  

.

  =
(cid:181)

1  1
A2

(cid:104)

(cid:182)

1 (cid:161)

1
1  KsC

A

(cid:162)2

Following the methodology proposed in Nilsson [17] is possible to show that the system above
is mean square stable, i.e. limt E[(es

t ] = 0 if and only if the transition probability is

t )(cid:48)es

 < s =

.

(27)

If the system is mean square stable, the steady state error covariance P s = limt E[es
given by:

P s =

1  (A  KsC)2  (1  )A2 .

Q + K 2

s R

t )(cid:48)] is

t (es

(28)

DRAFT

Calculations to obtain Equations (27) and (28) are tedious but straightforward, therefore they

are omitted.

17

It is immediately evident that the critical transition probability s of the estimator (25) using
a static gain is always greater then the critical transition probability c of the estimator (24)
which adopts a dynamic gain, in fact

1 (cid:161)

(cid:162)2

A

1
1  KsC
and the two probabilities are equal only when Ks = A
C .

s = c

A natural choice for the static estimator gain Ks is the steady state Kalman gain KSS of the
closed loop system (r = 1), which is always different from A
C . For the scalar system considered
in the previous section, where A = 1.5, C = 1, Q = 1, R = 2.5, this is given by KSS = 0.70,
C = 1.25. In the special case
while the gain for largest mean square stability range is Ks = A
when the arrival probability is known, another natural choice for the estimator gain K is obtained
by substituting the error covariance solution of P = g( P ) into the equation for the Kalman
lter gain K = A P C(cid:48)(C P C(cid:48) + R)1. For example, assuming  = 0.6, then P = 7.32 and
K = 0.93. Figure 6 shows all of these cases, comparing them with the upper bound on the
state error covariance V of the dynamic estimator (24) that can be computed as indicated in
Theorem 6. The steady state error covariance of the static predictor for the three different gains
is always greater then our upper bound V . This is not surprising, since the dynamic estimator is
optimal over all possible estimators as shown in Section II. Note that the static predictor with

static gain K (designed for  = 0.6) achieves the same state error covariance predicted by our
upper bound for the optimal dynamic lter when  = 0.6. However, the empirical error state

covariance is on average better then the static lter, as shown in Figure 7. This is to be expected,

since the solution of MARE gives only an upper bound of the true expected state covariance of

the time-varying lter. Moreover, it is worth stressing that if the arrival probability is different

from the one used to design the static gain, the performance of the static lter will degrade

considerably, while the time-varying lter will still perform optimally and does not require

knowledge of . From this example, it seems that the upper bound for the dynamic estimator
V gives en estimate of the minimum steady state covariance that can be achieved with a static
estimator for any given arrival probability if the static gain Ks is chosen optimally. Then the
MARE could be used to nd the minimum steady state covariance and then the corresponding

DRAFT

18

Fig. 6. Error covariance bound V for dynamic predictor obtained from our theory and steady state error covariance for three
natural static predictors obtained from JLS theory.

steady state modied Kalman gain, thus providing an useful tool for optimal static estimator

design. Future work will explore this possibility.

VI. CONCLUSIONS

In this paper we have presented an analysis of Kalman ltering in the setting of intermittent

observations. We have shown how the expected estimation error covariance depends on the

tradeoff between loss probability and the system dynamics. Such a result is useful to the system

designer who must assess the relationship between the dynamics of the system whose state is

to be estimated and the reliability of the communication channel through which that system is

measured.

Our motivating application is a distributed sensor network that collects observations and sends

them to one or more central units that are responsible for estimation and control. For example,

in a pursuit evasion game in which mobile pursuers perform their control actions based on the

current estimate of the positions of both pursuers and evaders, the sensing capability of each

pursuer is generally limited, and an embedded sensor network is essential for providing a larger

DRAFT

00.10.20.30.40.50.60.70.80.9102468101214161820State Error Covariance PVKK=A/CKSS19

Fig. 7.

Empirical state error covariance of our time-varying lter and the linear mimimum mean square error estimator

(LMMSEE) [16] obtained by using the optimal static kalman gain K. The curves are obtained by averaging 10000 Monte

Carlo simulations for t = 1, . . . , 300, with the values of the input noise (vt, wt) and the arrival sequence t generated randomly.

Both lters were compared under the same conditions.

overall view of the terrain. The results that we have presented here can aid the designer of the

sensor network in the choice of the number and disposition of the sensors.

This application also suggests a number of interesting directions for further work. For example,

although we have assumed independent Bernoulli probabilities for the observation events, in the

sensor network there will generally be temporal and spatial sources of variability that lead to

correlations among these events. While it is possible to compute posterior state estimates in such

a setting, it would be of interest to see if a priori bounds of the kind that we have obtained here

can be obtained in this case. Similarly, in many situations there may be correlations between

the states and the observation events; for example, such correlations will arise in the pursuit

evasion game when the evaders move near the boundaries of the sensor network. Finally, the

sensor network setting also suggests the use of smoothing algorithms in addition to the ltering

algorithms that have been our focus here. In particular, we may be willing to tolerate a small

amount of additional delay to wait for the arrival of a sensor measurement, if that measurement

is expected to provide a signicant reduction in uncertainty. Thus we would expect that the

DRAFT

05010015020025030044.555.566.577.588.59TimeEmpirical state error covarince   (r.m.s.)2timevarying filterLMMSE filter (K)20

tradeoff that we have studied here between loss probability and the system dynamics should

also be modulated in interesting ways by the delay due to smoothing.

We also remark that the assumption of modelling the arrival of observations as a bernoulli

i.i.d. process can be clearly improved upon. For example, one can imagine situations where some

of the sensing is done locally and therefore measurements are available at all sampling times,

while measurements taken at distant locations are available at irregular intervals. This would

translate in different dropping rates for different channels. We have focused to providing a basic

result upon which more sophisticated models can be built and analyzed.

VII. ACKNOWLEDGEMENT

The authors are grateful to the anonymous reviewer for the comments that helped improving

the quality of the manuscript.

VIII. APPENDIX A

In order to give complete proofs of our main theorems, we need to prove some preliminary

lemmas. The rst one shows some useful properties of the MARE.

Lemma 1. Let the operator

(K, X) = (1  )(AXA(cid:48) + Q) + (F XF (cid:48) + V )
(29)
V = Q + KRK(cid:48). Assume X  S = {S  Rnn|S  0}, R > 0, Q  0,

where F = A + KC,
and (A, Q 1

2 ) is controllable. Then the following facts are true:

1, g(X) = (KX, X)

(a) With KX = AXC(cid:48) (CXC(cid:48) + R)
(b) g(X) = minK (K, X)  (K, X)K
(c) If X  Y , then g(X)  g(Y )
(d) If 1  2 then g1(X)  g2(X)
(e) If   [0, 1], then g(X + (1  )Y )  g(X) + (1  )g(Y )
(f) g(X)  (1  )AXA(cid:48) + Q
(g) If X  g( X), then X > 0
(h) If X is a random variable, then (1  )AE[X]A(cid:48) + Q  E[g(X)]  g(E[X])

DRAFT

21

Proof:

(a) Dene FX = A + KXC, and observe that

FXXC(cid:48) + KXR = (A + KXC)XC(cid:48) + KXR = AXC(cid:48) + KX(CXC(cid:48) + R) = 0.

Next, we have

g(X) = (1  )(AXA(cid:48) + Q) + (AXA(cid:48) + Q  AXC(cid:48) (CXC(cid:48) + R)

1 CXA(cid:48))

= (1  )(AXA(cid:48) + Q) + (AXA(cid:48) + Q + KXCXA(cid:48))
= (1  )(AXA(cid:48) + Q) + (FXXA(cid:48) + Q)
= (1  )(AXA(cid:48) + Q) + (FXXA(cid:48) + Q) + (FXXC(cid:48) + KXR)K(cid:48)

= (KX, X)

(b) Let (K, X) = (A + KC)X(A + KC)(cid:48) + KRK(cid:48) + Q. Note that

argminK(K, X) = argminKF XF (cid:48) + V = argminK(X, K).

Since X, R  0, (K, X) is quadratic and convex in the variable K, therefore the minimizer
can be found by solving (K,X)

K = 0, which gives:

2(A + KC)XC(cid:48) + 2KR = 0 = K = AXC(cid:48) (CXC(cid:48) + R)

1 .

Since the minimizer corresponds to KX dened above, the fact follows from fact (1)

(c) Note that (K, X) is afne in X. Suppose X  Y . Then

g(X) = (KX, X)  (KY , X)  (KY , Y ) = g(Y ).

This completes the proof.

(d) Note that AXC(cid:48)(CXC(cid:48) + R)1CXA  0. Then

g1(X) = AXA(cid:48) + Q  1 AXC(cid:48)(CXC(cid:48) + R)1CXA

 AXA(cid:48) + Q  2 AXC(cid:48)(CXC(cid:48) + R)1CXA = g2(X)

(e) Let Z = X + (1  )Y where   [0, 1]. Then we have

g(Z) = (KZ, Z)

= (A + KZ C)X(A + KZ C)(cid:48) + (1  )(A + KZ C)Y (A + KZ C)(cid:48)+

+( + 1  )(KZ R K(cid:48)

Z + Q)
= (KZ, X) + (1  )(KZ, Y )
 (KX, X) + (1  )(KY , Y )
= g(X) + (1  )g(Y ).

(30)

DRAFT

22

(f) Note that FXXF (cid:48)

X  0 and KRK(cid:48)  0 for all K and X. Then
g1(X) = (KX, X) = (1  )(AXA(cid:48) + Q) + (FXXF (cid:48)

X + KXRK(cid:48)

X + Q)

 (1  )(AXA(cid:48) + Q) + Q = (1  )AXA(cid:48) + Q.

(g) From fact (f) follows that X  g1( X)  (1  )A XA(cid:48) + Q. Let X such that X =
(1  )A XA(cid:48) + Q. Such X must clearly exist. Therefore X  X  (1  )A( X  X)A(cid:48)  0.
1  A.
Moreover the matrix X solves the Lyapunov Equation X = A X A(cid:48) + Q where A =
Since ( A, Q 1

2 ) is detectable, it follows that X > 0 and so X > 0, which proves the fact.



(h) Using fact (f) and linearity of expectation we have

E[g(X)]  E[(1  )AXA(cid:48) + Q] = (1  )AE[X]A(cid:48) + Q,

fact (e) implies that the operator g() is concave, therefore by Jensens Inequality we have
E[g(X)]  g(E[X]).

Lemma 2. Let Xt+1 = h(Xt) and Yt+1 = h(Yt). If h(X) is a monotonically increasing function
then:

X1  X0  Xt+1  Xt, t  0
X1  X0  Xt+1  Xt, t  0
t  0
X0  Y0  Xt  Yt,

Proof: This lemma can be readily proved by induction. It is true for t = 0, since X1  X0
by denition. Now assume that Xt+1  Xt, then Xt+2 = h(Xt+1)  h(Xt+1) = Xt+1 because
of monotonicity of h(). The proof for the other two cases is analogous.

It is important to note that while in the scalar case X  R either h(X)  X or h(X)  X;
in the matrix case X  Rnn, it is not generally true that either h(X)  X or h(X)  X.
This is the source of the major technical difculty for the proof of convergence of sequences in
higher dimensions. In this case convergence of a sequence {Xt}
other sequences, {Yt}
these two sequences converge to the same point.

is obtained by nding two
that bound Xt, i.e., Yt  Xt  Zt,t, and then by showing that

0 ,{Zt}

0

0

The next two Lemmas show that when the MARE has a solution P , this solution is also
stable, i.e., every sequence based on the difference Riccati equation Pt+1 = g(Pt) converges to
P for all initial positive semidenite conditions P  0.

DRAFT

Lemma 3. Dene the linear operator

L(Y ) = (1  )(AY A(cid:48)) + (F Y F (cid:48))

Suppose there exists Y > 0 such that Y > L(Y ).

23

(a) For all W  0,

(b) Let U  0 and consider the linear system

kLk(W ) = 0

lim

Yk+1 = L(Yk) + U initialized at Y0.

Then, the sequence Yk is bounded.
Proof: (a) First observe that 0  L(Y ) for all 0  Y . Also, X  Y implies L(X)  L(Y ).

Choose 0  r < 1 such that L(Y ) < rY . Choose 0  m such that W  mY . Then,

0  Lk(W )  mLk(Y ) < mrkY

The assertion follows when we take the limit r  , on noticing that 0  r < 1.

(b) The solution of the linear iteration is

Yk = Lk(Y0) +

Lt(U )

(cid:33)

Y

t=0

k1(cid:88)
k1(cid:88)
(cid:182)

t=0
mU
1  r
mU
1  r

(cid:182)

Y

Y

(cid:195)
(cid:181)
(cid:181)







mY0rk +

mY0 +

mY0rk +

mU rt

proving the claim.

Lemma 4. Consider the operator (K, X) dened in Equation (29). Suppose there exists a

matrix K and a positive denite matrix P such that

P > 0 and P > (K, P ).

Then, for any P0, the sequence Pt = gt
P0 such that

(P0) is bounded, i.e. there exists MP0  0 dependent of

Pt  M for all

t.

DRAFT

24

Proof: First dene the matrices F = A + KC and consider the linear operator

L(Y ) = (1  )(AY A(cid:48)) + (F Y F

(cid:48)

)

Observe that

P > (K, P ) = L(P ) + Q + KRK

(cid:48)  L(P ).

Thus, L meets the condition of Lemma 3. Finally, using fact (b) in Lemma 1 we have

Pt+1 = g(Pt)  (K, Pt) = LPt + Q + KRK

(cid:48)

= L(Pt) + U.

Since U = KRK

(cid:48)

+ Q  0, using Lemma 3, we conclude that the sequence Pt is bounded.

We are now ready to give proofs for Theorems 1-4.

A. Proof of Theorem 1

(a) We rst show that the modied Riccati difference equation initialized at Q0 = 0 converges.

Let Qk = gk

(0). Note that 0 = Q0  Q1. It follows from Lemma 1(c) that

Q1 = g(Q0)  g(Q1) = Q2.

A simple inductive argument establishes that

0 = Q0  Q1  Q2    MQ0.

Here, we have used Lemma 4 to bound the trajectory. We now have a monotone non-decreasing

sequence of matrices bounded above. It is a simple matter to show that the sequence converges,

i.e.

Also, we see that P is a xed point of the modied Riccati iteration:

lim
k Qk = P .

P = g(P ),

which establishes that it is a positive semi-denite solution of the MARE.

Next, we show that the Riccati iteration initialized at R0  P also converges, and to the same

limit P . First dene the matrices

K = AP C(cid:48)(cid:161)

CP C(cid:48) + R

(cid:162)1

, F = A + KC

DRAFT

25

and consider the linear operator

L(Y ) = (1  )(AY A(cid:48)) + (F Y F

(cid:48)

).

Observe that

P = g(P ) = L(P ) + Q + KRK

(cid:48)

> L(P ).

Thus, L meets the condition of Lemma 3. Consequently, for all Y  0,

Now suppose R0  P . Then,

Lk(Y ) = 0.

lim
k

R1 = g(R0)  g(P ) = P .

A simple inductive argument establishes that

Rk  P for all k.

Observe that

0  (Rk+1  P ) = g(Rk)  g(P )

= (KRk, Rk)  (KP , P )
 (KP , Rk)  (KP , P )
= (1  )A(Rk  P )A(cid:48) + FP (Rk  P )F (cid:48)
= L(Rk  P ).

P

Then, 0  limk(Rk+1  P )  0, proving the claim.

We now establish that the Riccati iteration converges to P for all initial conditions P0  0.
Dene Q0 = 0 and R0 = P0 + P . Consider three Riccati iterations, initialized at Q0, P0, and
R0. Note that

Q0  P0  R0.

It then follows from Lemma 2 that

Qk  Pk  Rk

for all k.

DRAFT

26

We have already established that the Riccati equations Pk and Rk converge to P . As a result,
we have

k Pk  lim

k Qk  lim

P = lim

k Rk = P ,

proving the claim.

(b) Finally, we establish that the MARE has a unique positive semi-denite solution. To this
end, consider P = g( P ) and the Riccati iteration initialized at P0 = P . This yields the constant
sequence

P , P ,

However, we have shown that every Riccati iteration converges to P . Thus P = P .

B. Proof of Theorem 2

First we note that the two cases expressed by the theorem are indeed possible. If  = 1 the

modied Riccati difference equation reduces to the standard Riccati difference equation, which

is known to converge to a xed point, under the theorems hypotheses. Hence, the covariance
matrix is always bounded in this case, for any initial condition P0  0. If  = 0 then we reduce
to open loop prediction, and if the matrix A is unstable, then the covariance matrix diverges
for some initial condition P0  0. Next, we show the existence of a single point of transition
between the two cases. Fix a 0 < 1  1 such that E1[Pt] is bounded for any initial condition
P0  0. Then, for any 2  1 E2[Pt] is also bounded for all P0  0. In fact we have

E1[Pt+1] = E1[APtA(cid:48) + Q  t+1APtC(cid:48)(CPtC(cid:48) + R)1CPtA]

= E[APtA(cid:48) + Q  1APtC(cid:48)(CPtC(cid:48) + R)1CPtA]
= E[g1(Pt)]
 E[g2(Pt)]
= E2[Pt+1],

where we exploited fact (d) of Lemma 1 to write the above inequality . We can now choose

c = {inf  :  >   E[Pt]is bounded, for all P0  0},

completing the proof.

DRAFT

27

C. Proof of Theorem 3



Dene the Lyapunov operator m(X) = AX A(cid:48)+Q where A =

2 ) is control-
2 ) is controllable. Therefore, it is well known that S = m( S) has a unique strictly
1   maxi |i(A)| < 1,
2 . If maxi |i( A)|  1 it is also a well known fact that there
2 ) is

lable, also ( A, Q 1
positive denite solution S > 0 if and only if maxi |i( A)| < 1, i.e.
from which follows  = 1  1
is no positive semidenite xed point to the Lyapunov equation S = m( S), since ( A, Q 1
controllable.

1  A. If (A, Q 1



Let us consider the difference equation St+1 = m(St), S0 = 0. It is clear that S0 = 0 
Q = S1. Since the operator m() is monotonic increasing, by Lemma 2 it follows that the
sequence {St}
is monotonically increasing, i.e. St+1  St for all t. If  <  this sequence
does not converge to a nite matrix S, otherwise by continuity of the operator m we would
have S = m( S), which is not possible. Since it is easy to show that a monotonically increasing
sequence St that does not converge is also unbounded, then we have

0

Let us consider now the mean covariance matrix E[Pt] initialized at E[P0]  0. Clearly

0 = S0  E[P0]. Moreover it is also true

t St = .

lim

St  E[Pt] = St+1 = (1  )AStA(cid:48) + Q  (1  )AE[Pt]A(cid:48) + Q  E[g(Pt)] = E[Pt+1],

where we used fact (h) from Lemma 1. By induction, it is easy to show that

St  E[Pt] t, E[P0]  0 = lim

t E[Pt]  lim

t St = .

This implies that for any initial condition E[Pt] is unbounded for any  < , therefore   c,
which proves the rst part of the Theorem.

Now consider the sequence Vt+1 = g(Vt), V0 = E[P0]  0. Clearly

E[Pt]  Vt = E[Pt+1] = E[g(Pt)]  g(E[Pt])  [g(Vt)] = Vt+1,

where we used facts (c) and (h) from Lemma 1. Then a simple induction argument shows
that Vt  E[Pt] for all t. Let us consider the case  > , therefore there exists X such that
X  g( X). By Lemma 1(g) X > 0, therefore all hypotheses of Lemma 3 are satised, which
implies that

E[Pt]  Vt  MV0 t.

This shows that c   and concludes the proof of the Theorem.

DRAFT

28

D. Proof of Theorem 4

Let consider the sequences St+1 = (1  )AStA(cid:48) + Q, S0 = 0 and Vt+1 = g(Vt), V0 =

E[P0]  0. Using the same induction arguments in Theorem 3 it is easy to show that

St  E[Pt]  Vt t.

From Theorem 1 follows that limt Vt = V , where V = gV . As shown before the sequence St
is monotonically increasing. Also it is bounded since St  Vt  M. Therefore limt St = S,
and by continuity S = (1  )A SA(cid:48) + Q, which is a Lyapunov equation. Since
1  A is
stable and (A, Q 1
2 ) is controllable, then the solution of the Lyapunov equation is strictly positive
denite, i.e. S > 0. Adding all the results together we get



0 < S = lim

t Vt = V ,

t St  lim

t E[Pt]  lim

which concludes the proof.

DRAFT

29

